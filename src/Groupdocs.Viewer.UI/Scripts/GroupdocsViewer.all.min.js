JsInject={Container:function(){this.serviceEntries=[];this.disposables=[]}};JsInject.Container.prototype.Resolve=function(a,c,b,d,e,f,g,h,i,j){return this.ResolveInternal(a,!0,c,b,d,e,f,g,h,i,j)};JsInject.Container.prototype.TryResolve=function(a,c,b,d,e,f,g,h,i,j){return this.ResolveInternal(a,!1,c,b,d,e,f,g,h,i,j)};JsInject.Container.prototype.RegisterInternal=function(a,c,b,d){if(this.RegisteredInternal(a))throw"Factory with name '"+a+"' alredy registered";this.serviceEntries[a]={factory:c,scope:b,owner:d,instance:null}};JsInject.Container.prototype.Dispose=function(){for(var a in this.disposables)this.disposables[a].Dispose()};JsInject.Container.prototype.ResolveInternal=function(a,k,b,c,d,e,f,g,h,i,j){if(!this.RegisteredInternal(a))if(k)throw"Factory with name '"+a+"' is not registered";else return null;a=this.serviceEntries[a];if(a.scope==="container"){if(a.instance===null)a.instance=this.CreateInstanceInternal(a.factory,a.owner,b,c,d,e,f,g,h,i,j);return a.instance}return this.CreateInstanceInternal(a.factory,a.owner,b,c,d,e,f,g,h,i,j)};JsInject.Container.prototype.CreateInstanceInternal=function(a,c,b,d,e,f,g,h,i,j,k){a=a(this,b,d,e,f,g,h,i,j,k);c==="container"&&typeof a.Dispose==="function"&&this.disposables.push(a);return a};JsInject.Container.prototype.RegisteredInternal=function(a){return this.serviceEntries[a]!==void 0};JsInject.Registration=function(a,b){this.name=a;this.factory=b;this.scope="none";this.owner="consumer"};JsInject.Registration.prototype.Reused=function(){this.scope="container";this.Owned();return this};JsInject.Registration.prototype.Owned=function(){this.owner="container";return this};JsInject.ContainerBuilder=function(){this.registrations=[]};JsInject.ContainerBuilder.prototype.Register=function(b,c){var a=new JsInject.Registration(b,c);this.registrations.push(a);return a};JsInject.ContainerBuilder.prototype.Create=function(){var b=new JsInject.Container,c;for(c in this.registrations){var a=this.registrations[c];b.RegisterInternal(a.name,a.factory,a.scope,a.owner)}return b};JsInject.Container.prototype.Register=function(a,c,b){a=new JsInject.Registration(a,c);b&&a.Reused();this.RegisterInternal(a.name,a.factory,a.scope,a.owner)};(function(){var a,h,t=this,y="Index out of range";if(typeof ProvideCustomRxRootObject=="undefined")h=t.Rx={};else h=ProvideCustomRxRootObject();var u=function(){},z=function(){return(new Date).getTime()},A=function(a,b){return a===b},x=function(a){return a},n=function(a){return{Dispose:a}},o={Dispose:u};h.Disposable={Create:n,Empty:o};var H=h.BooleanDisposable=function(){var a=false;this.GetIsDisposed=function(){return a};this.Dispose=function(){a=true}},S=function(a){var b=false;a.a++;this.Dispose=function(){var b=false;if(!a.b)if(!this.c){this.c=true;a.a--;if(a.a==0&&a.d){a.b=true;b=true}}b&&a.e.Dispose()}},T=h.RefCountDisposable=function(a){this.d=false;this.b=false;this.e=a;this.a=0;this.Dispose=function(){var a=false;if(!this.b)if(!this.d){this.d=true;if(this.a==0){this.b=true;a=true}}a&&this.e.Dispose()};this.GetDisposable=function(){return this.b?o:new S(this)}},d=h.CompositeDisposable=function(){for(var a=new r,c=0;c<arguments.length;c++)a.Add(arguments[c]);var b=false;this.GetCount=function(){return a.GetCount()};this.Add=function(c){if(!b)a.Add(c);else c.Dispose()};this.Remove=function(c,d){if(!b){var e=a.Remove(c);!d&e&&c.Dispose()}};this.Dispose=function(){if(!b){b=true;this.Clear()}};this.Clear=function(){for(var b=0;b<a.GetCount();b++)a.GetItem(b).Dispose();a.Clear()}},e=h.MutableDisposable=function(){var c=false,b;this.Get=function(){return b},this.Replace=function(d){if(c&&d!==a)d.Dispose();else{b!==a&&b.Dispose();b=d}};this.Dispose=function(){if(!c){c=true;b!==a&&b.Dispose()}}},J=function(b){for(var c=[],a=0;a<b.length;a++)c.push(b[a]);return c},r=h.List=function(d){var c=[],b=0,e=d!==a?d:A;this.Add=function(a){c[b]=a;b++};this.RemoveAt=function(a){if(a<0||a>=b)throw y;if(a==0){c.shift();b--}else{c.splice(a,1);b--}};this.IndexOf=function(d){for(var a=0;a<b;a++)if(e(d,c[a]))return a;return-1};this.Remove=function(b){var a=this.IndexOf(b);if(a==-1)return false;this.RemoveAt(a);return true};this.Clear=function(){c=[];b=0};this.GetCount=function(){return b};this.GetItem=function(a){if(a<0||a>=b)throw y;return c[a]};this.SetItem=function(a,d){if(a<0||a>=b)throw y;c[a]=d};this.ToArray=function(){for(var b=[],a=0;a<this.GetCount();a++)b.push(this.GetItem(a));return b}},k=function(a){if(a===null)a=A;this.f=a;var b=4;this.g=new Array(b);this.h=0};k.prototype.i=function(a,b){return this.f(this.g[a],this.g[b])<0};k.prototype.j=function(a){if(a>=this.h||a<0)return;var b=a-1>>1;if(b<0||b==a)return;if(this.i(a,b)){var c=this.g[a];this.g[a]=this.g[b];this.g[b]=c;this.j(b)}};k.prototype.k=function(b){if(b===a)b=0;var d=2*b+1,e=2*b+2,c=b;if(d<this.h&&this.i(d,c))c=d;if(e<this.h&&this.i(e,c))c=e;if(c!=b){var f=this.g[b];this.g[b]=this.g[c];this.g[c]=f;this.k(c)}};k.prototype.GetCount=function(){return this.h};k.prototype.Peek=function(){if(this.h==0)throw"Heap is empty.";return this.g[0]};k.prototype.Dequeue=function(){var a=this.Peek();this.g[0]=this.g[--this.h];delete this.g[this.h];this.k();return a};k.prototype.Enqueue=function(b){var a=this.h++;this.g[a]=b;this.j(a)};var s=h.Scheduler=function(a,b,c){this.Schedule=a;this.ScheduleWithTime=b;this.Now=c;this.ScheduleRecursive=function(e){var c=this,a=new d,b;b=function(){e(function(){var e=false,f=false,d;d=c.Schedule(function(){b();if(e)a.Remove(d);else f=true});if(!f){a.Add(d);e=true}})};a.Add(c.Schedule(b));return a};this.ScheduleRecursiveWithTime=function(e,f){var c=this,a=new d,b;b=function(){e(function(g){var e=false,f=false,d;d=c.ScheduleWithTime(function(){b();if(e)a.Remove(d);else f=true},g);if(!f){a.Add(d);e=true}})};a.Add(c.ScheduleWithTime(b,f));return a}},W=h.VirtualScheduler=function(b,c,d,e){var a=new s(function(a){return this.ScheduleWithTime(a,0)},function(a,b){return this.ScheduleVirtual(a,e(b))},function(){return d(this.l)});a.ScheduleVirtual=function(e,f){var a=new H,g=c(this.l,f),b=function(){!a.IsDisposed&&e()},d=new L(b,g);this.m.Enqueue(d);return a};a.Run=function(){while(this.m.GetCount()>0){var a=this.m.Dequeue();this.l=a.n;a.o()}};a.RunTo=function(b){while(this.m.GetCount()>0&&this.f(this.m.Peek().n,b)<=0){var a=this.m.Dequeue();this.l=a.n;a.o()}};a.GetTicks=function(){return this.l};a.l=0;a.m=new k(function(a,c){return b(a.n,c.n)});a.f=b;return a},ob=h.TestScheduler=function(){return new W(function(a,b){return a-b},function(a,b){return a+b},function(a){return new Date(a)},function(a){return a<=0?1:a})},j=new s(function(a){return this.ScheduleWithTime(a,0)},function(d,e){var f=this.Now()+e,b=new L(d,f);if(this.m===a){var c=new K;try{this.m.Enqueue(b);c.p()}finally{c.q()}}else this.m.Enqueue(b);return b.r()},z);j.s=function(b){if(this.m===a){var c=new K;try{b();c.p()}finally{c.q()}}else b()};s.CurrentThread=j;var K=function(){j.m=new k(function(a,b){try{return a.n-b.n}catch(c){}});this.q=function(){j.m=a};this.p=function(){while(j.m.GetCount()>0){var a=j.m.Dequeue();if(!a.t()){while(a.n-j.Now()>0);!a.t()&&a.o()}}}},Z=0,L=function(a,b){this.u=Z++;this.o=a;this.n=b;this.v=new H;this.t=function(){return this.v.GetIsDisposed()};this.r=function(){return this.v}},f=new s(function(a){a();return o},function(a,b){while(this.Now<b);a()},z);s.Immediate=f;var i=new s(function(a){var b=t.setTimeout(a,0);return n(function(){t.clearTimeout(b)})},function(a,b){var c=t.setTimeout(a,b);return n(function(){t.clearTimeout(c)})},z);s.Timeout=i;var g=h.Observer=function(b,c,d){this.OnNext=b===a?u:b;this.OnError=c===a?function(a){throw a;}:c;this.OnCompleted=d===a?u:d;this.AsObserver=function(){var a=this;return new g(function(b){a.OnNext(b)},function(b){a.OnError(b)},function(){a.OnCompleted()})}},ib=g.Create=function(a,b,c){return new g(a,b,c)},c=h.Observable=function(a){this.w=a},b=c.CreateWithDisposable=function(a){return new c(a)},E=c.Create=function(a){return b(function(b){return n(a(b))})},F=function(){return this.Select(function(a){return a.Value})};c.prototype={Subscribe:function(a,c,d){var b;if(arguments.length==0||arguments.length>1||typeof a=="function")b=new g(a,c,d);else b=a;return this.x(b)},x:function(c){var a=false,b=new e,f=this;j.s(function(){var d=new g(function(b){!a&&c.OnNext(b)},function(d){if(!a){a=true;b.Dispose();c.OnError(d)}},function(){if(!a){a=true;b.Dispose();c.OnCompleted()}});b.Replace(f.w(d))});return new d(b,n(function(){a=true}))},Select:function(a){var c=this;return b(function(b){var d=0;return c.Subscribe(new g(function(e){var c;try{c=a(e,d++)}catch(f){b.OnError(f);return}b.OnNext(c)},function(a){b.OnError(a)},function(){b.OnCompleted()}))})},Let:function(c,f){if(f===a)return c(this);var g=this;return b(function(a){var h=f(),i;try{i=c(h)}catch(l){return I(l).Subscribe(a)}var j=new e,k=new e,b=new d(k,j);j.Replace(i.Subscribe(function(b){a.OnNext(b)},function(c){a.OnError(c);b.Dispose()},function(){a.OnCompleted();b.Dispose()}));k.Replace(g.Subscribe(h));return b})},MergeObservable:function(){var a=this;return b(function(c){var f=false,b=new d,g=new e;b.Add(g);g.Replace(a.Subscribe(function(d){var a=new e;b.Add(a);a.Replace(d.Subscribe(function(a){c.OnNext(a)},function(a){c.OnError(a)},function(){b.Remove(a);b.GetCount()==1&&f&&c.OnCompleted()}))},function(a){c.OnError(a)},function(){f=true;b.GetCount()==1&&c.OnCompleted()}));return b})},y:function(b,c){var a=J(c);a.unshift(this);return b(a)},Concat:function(){return this.y(G,arguments)},Merge:function(){return this.y(Q,arguments)},Catch:function(){return this.y(V,arguments)},OnErrorResumeNext:function(){return this.y(Y,arguments)},Zip:function(e,c){var f=this;return b(function(b){var m=false,h=[],i=[],j=false,k=false,g=new d,l=function(c){g.Dispose();h=a;i=a;b.OnError(c)};g.Add(f.Subscribe(function(a){if(k){b.OnCompleted();return}if(i.length>0){var e=i.shift(),d;try{d=c(a,e)}catch(f){g.Dispose();b.OnError(f);return}b.OnNext(d)}else h.push(a)},l,function(){if(k){b.OnCompleted();return}j=true}));g.Add(e.Subscribe(function(a){if(j){b.OnCompleted();return}if(h.length>0){var e=h.shift(),d;try{d=c(e,a)}catch(f){g.Dispose();b.OnError(f);return}b.OnNext(d)}else i.push(a)},l,function(){if(j){b.OnCompleted();return}k=true}));return g})},CombineLatest:function(c,a){var e=this;return b(function(b){var n=false,j=false,k=false,l,m,g=false,h=false,f=new d,i=function(a){f.Dispose();b.OnError(a)};f.Add(e.Subscribe(function(c){if(h){b.OnCompleted();return}if(k){var d;try{d=a(c,m)}catch(e){f.Dispose();b.OnError(e);return}b.OnNext(d)}l=c;j=true},i,function(){if(h){b.OnCompleted();return}g=true}));f.Add(c.Subscribe(function(c){if(g){b.OnCompleted();return}if(j){var d;try{d=a(l,c)}catch(e){f.Dispose();b.OnError(e);return}b.OnNext(d)}m=c;k=true},i,function(){if(g){b.OnCompleted();return}h=true}))})},Switch:function(){var c=this;return b(function(f){var g=false,b=new e,h=new e;h.Replace(c.Subscribe(function(d){if(!g){var c=new e;c.Replace(d.Subscribe(function(a){f.OnNext(a)},function(a){h.Dispose();b.Dispose();f.OnError(a)},function(){b.Replace(a);g&&f.OnCompleted()}));b.Replace(c)}},function(a){b.Dispose();f.OnError(a)},function(){g=true;b.Get()===a&&f.OnCompleted()}));return new d(h,b)})},TakeUntil:function(a){var c=this;return b(function(e){var b=new d;b.Add(a.Subscribe(function(){e.OnCompleted();b.Dispose()},function(a){e.OnError(a)},function(){}));b.Add(c.Subscribe(e));return b})},SkipUntil:function(a){var c=this;return b(function(b){var e=true,f=new d;f.Add(a.Subscribe(function(){e=false},function(a){b.OnError(a)},u));f.Add(c.Subscribe(new g(function(a){!e&&b.OnNext(a)},function(a){b.OnError(a)},function(){!e&&b.OnCompleted()})));return f})},Scan1:function(a){var b=this;return q(function(){var c,d=false;return b.Select(function(b){if(d)c=a(c,b);else{c=b;d=true}return c})})},Scan:function(b,a){var c=this;return q(function(){var d,e=false;return c.Select(function(c){if(e)d=a(d,c);else{d=a(b,c);e=true}return d})})},Scan0:function(a,c){var d=this;return b(function(b){var e=a,f=true;return d.Subscribe(function(a){if(f){f=false;b.OnNext(e)}try{e=c(e,a)}catch(d){b.OnError(d);return}b.OnNext(e)},function(a){f&&b.OnNext(e);b.OnError(a)},function(){f&&b.OnNext(e);b.OnCompleted()})})},Finally:function(a){var b=this;return E(function(c){var d=b.Subscribe(c);return function(){try{d.Dispose();a()}catch(b){a();throw b;}}})},Do:function(d,e,f){var c;if(arguments.length==0||arguments.length>1||typeof d=="function")c=new g(d,e!==a?e:u,f);else c=d;var h=this;return b(function(b){return h.Subscribe(new g(function(a){try{c.OnNext(a)}catch(d){b.OnError(d);return}b.OnNext(a)},function(d){if(e!==a)try{c.OnError(d)}catch(f){b.OnError(f);return}b.OnError(d)},function(){if(f!==a)try{c.OnCompleted()}catch(d){b.OnError(d);return}b.OnCompleted()}))})},Where:function(a){var c=this;return b(function(b){var d=0;return c.Subscribe(new g(function(c){var e=false;try{e=a(c,d++)}catch(f){b.OnError(f);return}e&&b.OnNext(c)},function(a){b.OnError(a)},function(){b.OnCompleted()}))})},Take:function(d,c){if(c===a)c=f;var e=this;return b(function(a){if(d<=0){e.Subscribe().Dispose();return B(c).Subscribe(a)}var b=d;return e.Subscribe(new g(function(c){if(b-->0){a.OnNext(c);b==0&&a.OnCompleted()}},function(b){a.OnError(b)},function(){a.OnCompleted()}))})},GroupBy:function(c,f,g){if(c===a)c=x;if(f===a)f=x;if(g===a)g=function(a){return a.toString()};var h=this;return b(function(j){var i={},k=new e,l=new T(k);k.Replace(h.Subscribe(function(r){var h;try{h=c(r)}catch(s){for(var n in i)i[n].OnError(s);j.OnError(s);return}var o=false,e;try{var k=g(h);if(i[k]===a){e=new m;i[k]=e;o=true}else e=i[k]}catch(s){for(var n in i)i[n].OnError(s);j.OnError(s);return}if(o){var p=b(function(a){return new d(l.GetDisposable(),e.Subscribe(a))});p.Key=h;j.OnNext(p)}var q;try{q=f(r)}catch(s){for(var n in i)i[n].OnError(s);j.OnError(s);return}e.OnNext(q)},function(a){for(var b in i)i[b].OnError(a);j.OnError(a)},function(){for(var a in i)i[a].OnCompleted();j.OnCompleted()}));return l})},TakeWhile:function(a){var c=this;return b(function(b){var d=true;return c.Subscribe(new g(function(c){if(d){try{d=a(c)}catch(e){b.OnError(e);return}if(d)b.OnNext(c);else b.OnCompleted()}},function(a){b.OnError(a)},function(){b.OnCompleted()}))})},SkipWhile:function(a){var c=this;return b(function(b){var d=false;return c.Subscribe(new g(function(c){if(!d)try{d=!a(c)}catch(e){b.OnError(e);return}d&&b.OnNext(c)},function(a){b.OnError(a)},function(){b.OnCompleted()}))})},Skip:function(a){var c=this;return b(function(b){var d=a;return c.Subscribe(new g(function(a){d--<=0&&b.OnNext(a)},function(a){b.OnError(a)},function(){b.OnCompleted()}))})},SelectMany:function(a){return this.Select(a).MergeObservable()},TimeInterval:function(b){if(b===a)b=f;var c=this;return q(function(){var a=b.Now();return c.Select(function(d){var c=b.Now(),e=c-a;a=c;return{Interval:e,Value:d}})})},RemoveInterval:F,Timestamp:function(b){if(b===a)b=f;return this.Select(function(a){return{Timestamp:b.Now(),Value:a}})},RemoveTimestamp:F,Materialize:function(){var a=this;return b(function(b){return a.Subscribe(new g(function(a){b.OnNext(new l("N",a))},function(a){b.OnNext(new l("E",a));b.OnCompleted()},function(){b.OnNext(new l("C"));b.OnCompleted()}))})},Dematerialize:function(){return this.SelectMany(function(a){return a})},AsObservable:function(){var a=this;return b(function(b){return a.Subscribe(b)})},Delay:function(f,c){if(c===a)c=i;var g=this;return b(function(j){var b=[],h=false,i=new e,k=g.Materialize().Timestamp().Subscribe(function(d){if(d.Value.Kind=="E"){j.OnError(d.Value.Value);b=[];h&&i.Dispose();return}b.push({Timestamp:c.Now()+f,Value:d.Value});if(!h){i.Replace(c.ScheduleRecursiveWithTime(function(e){var d;do{d=a;if(b.length>0&&b[0].Timestamp<=c.Now())d=b.shift().Value;d!==a&&d.Accept(j)}while(d!==a);if(b.length>0){e(Math.max(0,b[0].Timestamp-c.Now()));h=true}else h=false},f));h=true}});return new d(k,i)})},Throttle:function(f,c){if(c===a)c=i;var g=this;return b(function(h){var j,a=false,i=new e,b=0,k=g.Subscribe(function(d){a=true;j=d;b++;var e=b;i.Replace(c.ScheduleWithTime(function(){a&&b==e&&h.OnNext(j);a=false},f))},function(c){i.Dispose();h.OnError(c);a=false;b++},function(){i.Dispose();a&&h.OnNext(j);h.OnCompleted();a=false;b++});return new d(k,i)})},Timeout:function(g,f,c){if(c===a)c=i;if(f===a)f=I("Timeout",c);var h=this;return b(function(i){var j=new e,k=new e,b=0,l=b,a=false;k.Replace(c.ScheduleWithTime(function(){a=b==l;a&&j.Replace(f.Subscribe(i))},g));j.Replace(h.Subscribe(function(e){var d=0;if(!a){b++;d=b;i.OnNext(e);k.Replace(c.ScheduleWithTime(function(){a=b==d;a&&j.Replace(f.Subscribe(i))},g))}},function(c){if(!a){b++;i.OnError(c)}},function(){if(!a){b++;i.OnCompleted()}}));return new d(j,k)})},Sample:function(e,c){if(c===a)c=i;var f=this;return b(function(a){var g=false,h,i=false,b=new d;b.Add(ab(e,c).Subscribe(function(){if(g){a.OnNext(h);g=false}i&&a.OnCompleted()},function(b){a.OnError(b)},function(){a.OnCompleted()}));b.Add(f.Subscribe(function(a){g=true;h=a},function(c){a.OnError(c);b.Dispose()},function(){i=true}));return b})},Repeat:function(c,g){var h=this;if(g===a)g=f;if(c===a)c=-1;return b(function(a){var b=c,f=new e,i=new d(f),j=function(c){f.Replace(h.Subscribe(function(b){a.OnNext(b)},function(b){a.OnError(b)},function(){if(b>0){b--;if(b==0){a.OnCompleted();return}}c()}))};i.Add(g.ScheduleRecursive(j));return i})},Retry:function(c,g){var h=this;if(g===a)g=f;if(c===a)c=-1;return b(function(a){var b=c,f=new e,i=new d(f),j=function(c){f.Replace(h.Subscribe(function(b){a.OnNext(b)},function(d){if(b>0){b--;if(b==0){a.OnError(d);return}}c()},function(){a.OnCompleted()}))};i.Add(g.ScheduleRecursive(j));return i})},BufferWithTime:function(f,e,c){if(c===a)c=i;if(e===a)e=f;var g=this;return b(function(b){var a=new r,k=c.Now(),l=function(){for(var c=[],b=0;b<a.GetCount();b++){var d=a.GetItem(b);d.Timestamp-k>=0&&c.push(d.Value)}return c},h=new d,i=function(a){b.OnError(a)},j=function(){b.OnNext(l());b.OnCompleted()};h.Add(g.Subscribe(function(b){a.Add({Value:b,Timestamp:c.Now()})},i,j));h.Add(C(f,e,c).Subscribe(function(){var g=l(),d=c.Now()+e-f;while(a.GetCount()>0&&a.GetItem(0).Timestamp-d<=0)a.RemoveAt(0);b.OnNext(g);k=d},i,j));return h})},BufferWithTimeOrCount:function(f,g,c){if(c===a)c=i;var h=this;return b(function(j){var b=0,a=new r,k=function(){j.OnNext(a.ToArray());a.Clear();b++},l=new e,i;i=function(a){var d=c.ScheduleWithTime(function(){var c=false,d=0;if(a==b){k();d=b;c=true}c&&i(d)},f);l.Replace(d)};i(b);var m=h.Subscribe(function(e){var c=false,d=0;a.Add(e);if(a.GetCount()==g){k();d=b;c=true}c&&i(d)},function(b){j.OnError(b);a.Clear()},function(){j.OnNext(a.ToArray());b++;j.OnCompleted();a.Clear()});return new d(m,l)})},BufferWithCount:function(d,c){if(c===a)c=d;var e=this;return b(function(b){var a=[],f=0;return e.Subscribe(function(j){if(f==0)a.push(j);else f--;var g=a.length;if(g==d){var h=a;a=[];for(var i=Math.min(c,g),e=i;e<g;e++)a.push(h[e]);f=Math.max(0,c-d);b.OnNext(h)}},function(a){b.OnError(a)},function(){a.length>0&&b.OnNext(a);b.OnCompleted()})})},StartWith:function(c,e){if(!(c instanceof Array))c=[c];if(e===a)e=f;var g=this;return b(function(f){var a=new d,b=0;a.Add(e.ScheduleRecursive(function(d){if(b<c.length){f.OnNext(c[b]);b++;d()}else a.Add(g.Subscribe(f))}));return a})},DistinctUntilChanged:function(c,d){if(c===a)c=x;if(d===a)d=A;var e=this;return b(function(a){var f,b=false;return e.Subscribe(function(g){var e;try{e=c(g)}catch(i){a.OnError(i);return}var h=false;if(b)try{h=d(f,e)}catch(i){a.OnError(i);return}if(!b||!h){b=true;f=e;a.OnNext(g)}},function(b){a.OnError(b)},function(){a.OnCompleted()})})},Publish:function(c){if(c===a)return new p(this,new m);var e=this;return b(function(){var a=new p(e,new m);return new d(c(a).Subscribe(g),a.Connect())})},Prune:function(e,c){if(c===a)c=f;if(e===a)return new p(this,new v(c));var h=this;return b(function(){var a=new p(h,new v(c));return new d(e(a).Subscribe(g),a.Connect())})},Replay:function(e,f,h,c){if(c===a)c=j;if(e===a)return new p(this,new w(f,h,c));var i=this;return b(function(){var a=new p(i,new w(f,h,c));return new d(e(a).Subscribe(g),a.Connect())})},SkipLast:function(a){var c=this;return b(function(b){var d=[];return c.Subscribe(function(c){d.push(c);d.length>a&&b.OnNext(d.shift())},function(a){b.OnError(a)},function(){b.OnCompleted()})})},TakeLast:function(a){var c=this;return b(function(d){var b=[];return c.Subscribe(function(c){b.push(c);b.length>a&&b.shift()},function(a){d.OnError(a)},function(){while(b.length>0)d.OnNext(b.shift());d.OnCompleted()})})}};var Q=c.Merge=function(c,b){if(b===a)b=f;return R(c,b).MergeObservable()},G=c.Concat=function(g,c){if(c===a)c=f;return b(function(a){var f=new e,b=0,h=c.ScheduleRecursive(function(d){if(b<g.length){var h=g[b];b++;var c=new e;f.Replace(c);c.Replace(h.Subscribe(function(b){a.OnNext(b)},function(b){a.OnError(b)},d))}else a.OnCompleted()});return new d(f,h)})},R=c.FromArray=function(d,c){if(c===a)c=f;return b(function(a){var b=0;return c.ScheduleRecursive(function(c){if(b<d.length){a.OnNext(d[b++]);c()}else a.OnCompleted()})})},jb=c.Return=function(d,c){if(c===a)c=f;return b(function(a){return c.Schedule(function(){a.OnNext(d);a.OnCompleted()})})},I=c.Throw=function(d,c){if(c===a)c=f;return b(function(a){return c.Schedule(function(){a.OnError(d)})})},U=c.Never=function(){return b(function(){return o})},B=c.Empty=function(c){if(c===a)c=f;return b(function(a){return c.Schedule(function(){a.OnCompleted()})})},q=c.Defer=function(a){return b(function(b){var c;try{c=a()}catch(d){b.OnError(d);return o}return c.Subscribe(b)})},V=c.Catch=function(g,c){if(c===a)c=f;return b(function(a){var f=new e,b=0,h=c.ScheduleRecursive(function(d){var h=g[b];b++;var c=new e;f.Replace(c);c.Replace(h.Subscribe(function(b){a.OnNext(b)},function(c){if(b<g.length)d();else a.OnError(c)},function(){a.OnCompleted()}))});return new d(f,h)})},kb=c.Using=function(c,e){return b(function(g){var h,b=o;try{var f=c();if(f!==a)b=f;h=e(f)}catch(i){return new d(Throw(i).Subscribe(g),b)}return new d(h.Subscribe(g),b)})},lb=c.Range=function(c,d,b){if(b===a)b=f;var e=c+d-1;return X(c,function(a){return a<=e},function(a){return a+1},x,b)},mb=c.Repeat=function(g,c,d){if(d===a)d=f;if(c===a)c=-1;var e=c;return b(function(a){return d.ScheduleRecursive(function(b){a.OnNext(g);if(e>0){e--;if(e==0){a.OnCompleted();return}}b()})})},X=c.Generate=function(d,e,g,h,c){if(c===a)c=f;return b(function(b){var a=d,f=true;return c.ScheduleRecursive(function(i){var c=false,d;try{if(f)f=false;else a=g(a);c=e(a);if(c)d=h(a)}catch(j){b.OnError(j);return}if(c){b.OnNext(d);i()}else b.OnCompleted()})})},nb=c.GenerateWithTime=function(d,e,f,g,h,c){if(c===a)c=i;return new b(function(i){var a=d,l=true,b=false,j,k;return c.ScheduleRecursiveWithTime(function(c){b&&i.OnNext(j);try{if(l)l=false;else a=f(a);b=e(a);if(b){j=g(a);k=h(a)}}catch(d){i.OnError(d);return}if(b)c(k);else i.OnCompleted()},0)})},Y=c.OnErrorResumeNext=function(g,c){if(c===a)c=f;return b(function(b){var f=new e,a=0,h=c.ScheduleRecursive(function(c){if(a<g.length){var h=g[a];a++;var d=new e;f.Replace(d);d.Replace(h.Subscribe(function(a){b.OnNext(a)},c,c))}else b.OnCompleted()});return new d(f,h)})},pb=c.Amb=function(){var a=arguments;return b(function(f){var c=new d,b=new e;b.Replace(c);for(var j=false,h=0;h<a.length;h++){var l=a[h],i=new e,k=new g(function(a){if(!j){c.Remove(this.z,true);c.Dispose();b.Replace(this.z);j=true}f.OnNext(a)},function(a){f.OnError(a);b.Dispose()},function(){f.OnCompleted();b.Dispose()});k.z=i;i.Replace(l.Subscribe(k));c.Add(i)}return b})},qb=c.ForkJoin=function(){var c=arguments;return b(function(b){for(var e=[],g=[],f=[],i=new d,h=0;h<c.length;h++)(function(d){i.Add(c[d].Subscribe(function(a){e[d]=true;f[d]=a},function(a){b.OnError(a)},function(){if(!e[d]){b.OnCompleted();f=a;e=a;return}g[d]=true;for(var i=true,h=0;h<c.length;h++)if(!g[h])i=false;if(i){b.OnNext(f);b.OnCompleted();f=a;g=a;e=a}}))})(h);return i})},ab=c.Interval=function(a,b){return C(a,a,b)},M=function(a){return Math.max(0,a)},C=c.Timer=function(e,f,d){if(d===a)d=i;if(e===a)return U();if(e instanceof Date)return q(function(){return c.Timer(e-new Date,f,d)});var g=M(e);if(f===a)return b(function(a){return d.ScheduleWithTime(function(){a.OnNext(0);a.OnCompleted()},g)});var h=M(f);return b(function(a){var b=0;return d.ScheduleRecursiveWithTime(function(c){a.OnNext(b++);c(h)},g)})},N=c.While=function(a,c){return b(function(b){var g=new e,h=new d(g);h.Add(f.ScheduleRecursive(function(e){var d;try{d=a()}catch(f){b.OnError(f);return}if(d)g.Replace(c.Subscribe(function(a){b.OnNext(a)},function(a){b.OnError(a)},function(){e()}));else b.OnCompleted()}));return h})},bb=c.If=function(c,d,b){if(b===a)b=B();return q(function(){return c()?d:b})},cb=c.DoWhile=function(a,b){return G([a,N(b,a)])},db=c.Case=function(d,e,b,c){if(c===a)c=f;if(b===a)b=B(c);return q(function(){var c=e[d()];if(c===a)c=b;return c})},eb=c.For=function(a,c){return b(function(b){var e=new d,g=0;e.Add(f.ScheduleRecursive(function(f){if(g<a.length){var d;try{d=c(a[g])}catch(h){b.OnError(h);return}e.Add(d.Subscribe(function(a){b.OnNext(a)},function(a){b.OnError(a)},function(){g++;f()}))}else b.OnCompleted()}));return e})},fb=c.Let=function(a,b){return q(function(){return b(a)})},l=h.Notification=function(a,b){this.Kind=a;this.Value=b;this.toString=function(){return this.Kind+": "+this.Value};this.Accept=function(a){switch(this.Kind){case"N":a.OnNext(this.Value);break;case"E":a.OnError(this.Value);break;case"C":a.OnCompleted()}return o};this.w=function(b){var c=this.Accept(b);a=="N"&&b.OnCompleted();return c}};l.prototype=new c;var m=h.Subject=function(){var a=new r,b=false;this.OnNext=function(e){if(!b)for(var d=a.ToArray(),c=0;c<d.length;c++){var f=d[c];f.OnNext(e)}};this.OnError=function(e){if(!b){for(var d=a.ToArray(),c=0;c<d.length;c++){var f=d[c];f.OnError(e)}b=true;a.Clear()}};this.OnCompleted=function(){if(!b){for(var d=a.ToArray(),c=0;c<d.length;c++){var e=d[c];e.OnCompleted()}b=true;a.Clear()}};this.w=function(c){if(!b){a.Add(c);return n(function(){a.Remove(c)})}else return o}};m.prototype=new c;for(var D in g.prototype)m.prototype[D]=g.prototype[D];var v=h.AsyncSubject=function(e){var b=new r,c,d=false;if(e===a)e=f;this.OnNext=function(a){if(!d)c=new l("N",a)};this.OnError=function(f){if(!d){c=new l("E",f);for(var g=b.ToArray(),e=0;e<g.length;e++){var h=g[e];h!==a&&h.OnError(f)}d=true;b.Clear()}};this.OnCompleted=function(){if(!d){if(c===a)c=new l("C");for(var f=b.ToArray(),e=0;e<f.length;e++){var g=f[e];g!==a&&c.w(g)}d=true;b.Clear()}};this.w=function(a){if(!d){b.Add(a);return n(function(){b.Remove(a)})}else return e.Schedule(function(){c.w(a)})}};v.prototype=new m;var gb=h.BehaviorSubject=function(b,c){var a=new w(1,-1,c);a.OnNext(b);return a},w=h.ReplaySubject=function(h,i,e){var c=new r,b=new r,f=false;if(e===a)e=j;var k=i>0,g=function(c,a){b.Add({Value:new l(c,a),Timestamp:e.Now()})};this.A=function(){if(h!==a)while(b.GetCount()>h)b.RemoveAt(0);if(k)while(b.GetCount()>0&&e.Now()-b.GetItem(0).Timestamp>i)b.RemoveAt(0)};this.OnNext=function(d){if(!f){for(var b=c.ToArray(),a=0;a<b.length;a++){var e=b[a];e.OnNext(d)}g("N",d)}};this.OnError=function(d){if(!f){for(var b=c.ToArray(),a=0;a<b.length;a++){var e=b[a];e.OnError(d)}f=true;c.Clear();g("E",d)}};this.OnCompleted=function(){if(!f){for(var b=c.ToArray(),a=0;a<b.length;a++){var d=b[a];d.OnCompleted()}f=true;c.Clear();g("C")}};this.w=function(f){var a=new O(this,f),g=new d(a),h=this;g.Add(e.Schedule(function(){if(!a.B){h.A();for(var d=0;d<b.GetCount();d++)b.GetItem(d).Value.Accept(f);c.Add(f);a.C=true}}));return g};this.D=function(a){c.Remove(a)}};w.prototype=new m;var O=function(a,b){this.E=a;this.F=b;this.C=false;this.B=false;this.Dispose=function(){this.C&&this.E.D(this.F);this.B=true}},P=c.ToAsync=function(c,b){if(b===a)b=i;return function(){var a=new v(b),d=function(){var b;try{b=c.apply(this,arguments)}catch(d){a.OnError(d);return}a.OnNext(b);a.OnCompleted()},e=this,f=J(arguments);b.Schedule(function(){d.apply(e,f)});return a}},hb=c.Start=function(c,d,b,e){if(b===a)b=[];return P(c,e).apply(d,b)},p=h.ConnectableObservable=function(c,b){if(b===a)b=new m;this.E=b;this.G=c;this.H=false;this.Connect=function(){var a,e=false;if(!this.H){this.H=true;var b=this;a=new d(n(function(){b.H=false}));this.I=a;a.Add(c.Subscribe(this.E))}return this.I};this.w=function(a){return this.E.Subscribe(a)};this.RefCount=function(){var a=0,b=this,c;return E(function(e){var d=false;a++;d=a==1;var f=b.Subscribe(e);if(d)c=b.Connect();return function(){f.Dispose();a--;a==0&&c.Dispose()}})}};p.prototype=new c})();(function(){var c=jQuery,a=c.fn,h=this,e;if(typeof ProvideCustomRxRootObject=="undefined")e=h.Rx;else e=ProvideCustomRxRootObject();var g=e.Observable,b=e.AsyncSubject,f=g.Create,i=e.Disposable.Empty;a.toObservable=function(a,c){var b=this;return f(function(e){var d=function(a){e.OnNext(a)};b.bind(a,c,d);return function(){b.unbind(a,d)}})};a.toLiveObservable=function(a,c){var b=this;return f(function(e){var d=function(a){e.OnNext(a)};b.live(a,c,d);return function(){b.die(a,d)}})};a.hideAsObservable=function(c){var a=new b;this.hide(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.showAsObservable=function(c){var a=new b;this.show(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.animateAsObservable=function(c,d,e){var a=new b;this.animate(c,d,e,function(){a.OnNext(this);a.OnCompleted()});return a};a.fadeInAsObservable=function(c){var a=new b;this.fadeIn(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.fadeToAsObservable=function(c,d){var a=new b;this.fadeTo(c,d,function(){a.OnNext(this);a.OnCompleted()});return a};a.fadeOutAsObservable=function(c){var a=new b;this.fadeOut(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.slideDownAsObservable=function(c){var a=new b;this.slideDown(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.slideUpAsObservable=function(c){var a=new b;this.slideUp(c,function(){a.OnNext(this);a.OnCompleted()});return a};a.slideToggleAsObservable=function(c){var a=new b;this.slideToggle(c,function(){a.OnNext(this);a.OnCompleted()});return a};var d=c.ajaxAsObservable=function(e){var a={};for(var f in e)a[f]=e[f];var d=new b;a.success=function(c,b,a){d.OnNext({data:c,textStatus:b,xmlHttpRequest:a});d.OnCompleted()};a.error=function(a,c,b){d.OnError({xmlHttpRequest:a,textStatus:c,errorThrown:b})};c.ajax(a);return d};c.getJSONAsObservable=function(b,a){return d({url:b,dataType:"json",data:a})};c.getScriptAsObservable=function(b,a){return d({url:b,dataType:"script",data:a})};c.postAsObservable=function(b,a){return d({url:b,type:"POST",data:a})};a.loadAsObservable=function(e,d){var a=new b,c=function(d,b,c){if(b==="error")a.OnError({response:d,status:b,xmlHttpRequest:c});else{a.OnNext({response:d,status:b,xmlHttpRequest:c});a.OnCompleted()}};this.load(e,d,c);return a};c.getScriptAsObservable=function(a){return d({url:a,dataType:"script"})};c.postAsObservable=function(c,a,b){return d({url:c,dataType:b,data:a,type:"POST"})}})();(function(){var a=jQuery.event.special,b="D"+ +new Date,c="D"+(+new Date+1);a.scrollstart={setup:function(){var c,d=function(d){var b=this,e=arguments;if(c)clearTimeout(c);else{d.type="scrollstart";$(b).trigger("scrollstart")}c=setTimeout(function(){c=null},a.scrollstop.latency)};jQuery(this).bind("scroll",d).data(b,d)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(b))}};a.scrollstop={latency:300,setup:function(){var b,d=function(d){var c=this,e=arguments;b&&clearTimeout(b);b=setTimeout(function(){b=null;d.type="scrollstop";$(c).trigger("scrollstop")},a.scrollstop.latency)};jQuery(this).bind("scroll",d).data(c,d)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(c))}}})();(function(){"use strict";if(!window.groupdocs)window.groupdocs={};window.groupdocs.stringExtensions={format:function(c){var b=c,a=arguments.length;while(--a)b=b.replace(new RegExp("\\{"+(a-1)+"\\}","gm"),arguments[a]);return b},trim:function(b,a){var c=new RegExp("^["+a+"]+|["+a+"]+$","g");return b.replace(c,"")},trimStart:function(a,b){var c=new RegExp("^["+b+"]+","g");return a.replace(c,"")},trimEnd:function(a,b){var c=new RegExp("["+b+"]+$","g");return a.replace(c,"")},getAccentInsensitiveRegexFromString:function(f){for(var b=[["A","ÀÁÂÃÄÅÆ"],["C","Ç"],["E","ÈÉÊËÆ"],["I","ÌÍÎÏ"],["N","Ñ"],["O","ÒÓÔÕÖØ"],["S","ß"],["U","ÙÚÛÜ"],["Y","Ÿ"],["У","Ў"],["a","àáâãäåæ"],["c","ç"],["e","èéêëæ"],["i","ìíîï"],["n","ñ"],["o","òóôõöø"],["s","ß"],["u","ùúûü"],["y","ÿ"],["у","ў"]],c="",a=0;a<b.length;a++)c+=b[a][0];var d=new RegExp("["+c+"]","g");function e(c){return c.replace(d,function(d){var c=null;for(a=0;a<b.length;a++)if(b[a][0]==d){c=b[a][1];break}if(c===null)c="";return"["+d+c+"]"})}return e(f)},_padWithLeadingZeros:function(a){return(new Array(5-a.length)).join("0")+a},_unicodeCharEscape:function(a){return"\\u"+this._padWithLeadingZeros(a.toString(16))},unicodeEscape:function(a){var b=this;return a.split("").map(function(a){var c=a.charCodeAt(0);return c>127?b._unicodeCharEscape(c):a}).join("")}}})();(function(a){"use strict";if(!window.groupdocs)window.groupdocs={};window.groupdocs.getWidgetInstance=function(c,g,e){var b,d=this.data(c);if(d==undefined){b=a.extend({},g);b.element=this;b.widgetName=c;if(b.options==undefined)b.options=e;else{var f=a.extend({},b.options,e);b.options=f}b._create&&b._create();b._init&&b._init();this.data(c,b)}else b=d;return b};a.groupdocsWidget=function(b,c){a.fn[b]=function(a){var d=window.groupdocs.getWidgetInstance.call(this,b,c,a);return typeof a=="object"||typeof a=="undefined"?this:d[a].apply(d,Array.prototype.slice.call(arguments,1,arguments.length))}}})(jQuery);(function(a){"use strict";if(!window.groupdocs)window.groupdocs={};groupdocs.ServerExchange=function(b,c,a){this._init(b,c,a)};a.extend(groupdocs.ServerExchange.prototype,{_urlSuffix:"",_lastError:null,_service:null,_cacheTimeout:300,applicationPath:null,useJSONP:false,_useHttpHandlers:false,urlPrefix:"document-viewer",_init:function(d,b,c){this.applicationPath=d;this._useHttpHandlers=b;if(b)this._urlSuffix="Handler";if(a.browser.msie&&a.browser.version==8&&c)this.useJSONP=true},viewDocumentAsHtml:function(s,h,j,c,b,p,m,i,n,f,g,d,e,a,k,q,l,o){var r={path:s,useHtmlBasedEngine:true,preloadPagesCount:h,fileDisplayName:j,usePngImagesForHtmlBasedEngine:c,convertWordDocumentsCompletely:b,ignoreDocumentAbsence:f,supportPageRotation:g,supportListOfContentControls:d,supportListOfBookmarks:e,watermarkText:p,watermarkColor:m,watermarkPosition:i,watermarkWidth:n,embedImagesIntoHtmlForWordFiles:a,instanceIdToken:k,locale:q};this._runServiceAsync(this.applicationPath+this.urlPrefix+"/ViewDocument"+this._urlSuffix,r,l,o)},getDocumentPageHtml:function(i,f,e,a,b,g,c,d){var h={path:i,pageIndex:f,usePngImages:e,embedImagesIntoHtmlForWordFiles:a,instanceIdToken:b,locale:g};this._runServiceAsync(this.applicationPath+this.urlPrefix+"/GetDocumentPageHtml"+this._urlSuffix,h,c,d)},viewDocument:function(t,r,o,q,e,n,g,m,j,f,k,c,d,a,b,h,p,i,l){var s={path:t,width:r,quality:o,usePdf:q,preloadPagesCount:e,password:n,fileDisplayName:g,watermarkText:m,watermarkColor:j,watermarkPosition:f,watermarkWidth:k,ignoreDocumentAbsence:c,supportPageRotation:d,supportListOfContentControls:a,supportListOfBookmarks:b,instanceIdToken:h,locale:p};this._runServiceAsync(this.applicationPath+this.urlPrefix+"/ViewDocument"+this._urlSuffix,s,i,l)},getImageUrlsAsync:function(r,p,k,l,m,o,j,h,e,d,a,c,b,f,n,g,i){var q={path:r,width:p,firstPage:k,pageCount:l,quality:m,usePdf:o,watermarkText:j,watermarkColor:h,watermarkPosition:e,watermarkFontSize:d,ignoreDocumentAbsence:a,useHtmlBasedEngine:c,supportPageRotation:b,instanceIdToken:f,locale:n};return this._runServiceAsync(this.applicationPath+this.urlPrefix+"/GetImageUrls"+this._urlSuffix,q,g,i)},loadFileBrowserTreeData:function(l,e,h,i,g,j,d,f,a,b,c){var k={path:l,pageIndex:e,pageSize:h,orderBy:i,orderAsc:g,filter:j,fileTypes:d,extended:f,instanceIdToken:a};return this._runServiceAsync(this.applicationPath+this.urlPrefix+"/LoadFileBrowserTreeData"+this._urlSuffix,k,b,c)},getPrintableHtml:function(m,b,d,j,g,c,h,a,f,i,e,k){var l={path:m,useHtmlBasedEngine:b,displayName:d,watermarkText:j,watermarkColor:g,watermarkPosition:c,watermarkWidth:h,ignoreDocumentAbsence:a,instanceIdToken:e,locale:k};return this._runServiceAsync(this.applicationPath+this.urlPrefix+"/GetPrintableHtml"+this._urlSuffix,l,f,i)},reorderPage:function(g,e,d,a,b,c){var f={path:g,oldPosition:e,newPosition:d,instanceIdToken:a};return this._runServiceAsync(this.applicationPath+this.urlPrefix+"/ReorderPage"+this._urlSuffix,f,b,c)},rotatePage:function(g,e,c,a,b,d){var f={path:g,pageNumber:e,rotationAmount:c,instanceIdToken:a};return this._runServiceAsync(this.applicationPath+this.urlPrefix+"/RotatePage"+this._urlSuffix,f,b,d)},_runServiceSync:function(e,d){var a=null,b=false,c=function(c){b=true;a=c.data};this._runService(e,d,false,c,null);return a},_runServiceAsync:function(e,d,a,b,c){return this._runService(e,d,true,a,b,c)},_runService:function(j,f,i,g,d,h){var e=JSON.stringify(f),b;if(this.useJSONP)if(this._useHttpHandlers)b="data="+e.toString();else b=f;else b=e;var c=Container.Resolve("RequestObservable")({url:j,type:this.useJSONP?"GET":"POST",contentType:"application/json; charset=utf-8",dataType:this.useJSONP?"jsonp"+(h?" xml":""):null,data:b,async:i}),a=Container.Resolve("AsyncSubject");c.Finally=function(b){a.Subscribe(b)};c.Subscribe(function(b){if(b)if(b.data.success===false){var c={code:b.data.code,Reason:b.data?b.data.Reason:null};d&&d(c)}else this._successHandler(b,g);a.OnNext();a.OnCompleted()}.bind(this),function(b){this._errorHandler(b,d);a.OnNext();a.OnCompleted()}.bind(this));return c},_errorHandler:function(b,c){var a=null;if(b.xmlHttpRequest.readyState==0)if(b.xmlHttpRequest.status===0)a={Reason:"Can't connect to server"};else return;var d=b.xmlHttpRequest.status;if(!a)a={Reason:b.xmlHttpRequest.responseText};try{c&&c(a)}catch(e){}},_successHandler:function(a,b){if(b){if(a.xmlHttpRequest.responseText=="")a.data=null;b(a)}}})})(jQuery);(function(a){"use strict";groupdocs.ViewerEventBus=function(b){a.extend(this,b);this.init()};a.extend(groupdocs.ViewerEventBus.prototype,{docViewerWidget:null,documentComponentViewModel:null,navigationWidget:null,navigationViewModel:null,thumbnailsWidget:null,thumbnailsViewModel:null,zoomViewModel:null,init:function(){var h=null,g=null,e=null,l=null,j=null,t=null,m=null,c=null,i=null,d=null,f=null,k=null,o=null,q=null,r="onMenuClicked";if(this.thumbnails){e=this.thumbnails.thumbnails(this.thumbnailsOptions||{baseUrl:this.baseUrl,quality:this.quality,use_pdf:this.use_pdf});d=this.thumbnails.thumbnails("getViewModel")}else{e=this.thumbnailsCreator();d=this.thumbnailsViewModelCreator()}var p=0;if(this.thumbnails)p=d.getThumbnailsPanelWidth();if(this.docSpace){var s=a.extend({baseUrl:this.baseUrl,fileId:this.fileId,quality:this.quality,pageImageWidth:this.pageImageWidth,docViewerId:this.docViewerId,createHtml:this.createHtml,initialZoom:this.initialZoom,alwaysOnePageInRow:this.alwaysOnePageInRow,zoomToFitWidth:this.zoomToFitWidth,zoomToFitHeight:this.zoomToFitHeight,viewerLeft:p,viewerWidth:this.viewerWidth,viewerHeight:this.viewerHeight,preloadPagesCount:this.preloadPagesCount,selectionContent:this.selectionContent,usePageNumberInUrlHash:this.usePageNumberInUrlHash,pageContentType:this.pageContentType,useHtmlBasedEngine:this.useHtmlBasedEngine,imageHorizontalMargin:this.imageHorizontalMargin,imageVerticalMargin:this.imageVerticalMargin,searchPartialWords:this.searchPartialWords,variablePageSizeSupport:this.variablePageSizeSupport,textSelectionSynchronousCalculation:this.textSelectionSynchronousCalculation,minimumImageWidth:this.minimumImageWidth,fileDisplayName:this.fileDisplayName,preventTouchEventsBubbling:this.preventTouchEventsBubbling,watermarkText:this.watermarkText,instanceId:this.instanceId},this.viewerOptions);if(this.useHtmlBasedEngine){h=this.docSpace.groupdocsDocumentHtmlRendering(s);c=this.docSpace.groupdocsDocumentHtmlRendering("getViewModel")}else{h=this.docSpace.groupdocsDocumentImageRendering(s);c=this.docSpace.groupdocsDocumentImageRendering("getViewModel")}}else{h=this.docSpaceCreator();c=this.docSpaceViewModel()}var n=null,b=null;if(this.docSpacePageFlip){n=this.docSpacePageFlip.groupdocsDocumentImageRenderingPageFlip({baseUrl:this.baseUrl,fileId:this.fileId,quality:this.quality,supportTextSelection:this.supportTextSelection,pageImageWidth:this.pageImageWidth,docViewerId:this.docViewerId,createHtml:this.createHtml,initialZoom:this.initialZoom,alwaysOnePageInRow:this.alwaysOnePageInRow,zoomToFitWidth:this.zoomToFitWidth,zoomToFitHeight:this.zoomToFitHeight,viewerWidth:this.viewerWidth,viewerHeight:this.viewerHeight,selectionContent:this.selectionContent,minimumImageWidth:this.minimumImageWidth});b=this.docSpacePageFlip.groupdocsDocumentImageRenderingPageFlip("getViewModel")}if(this.navigation){g=this.navigation.navigation(this.navigationOptions);i=this.navigation.navigation("getViewModel")}if(this.search){j=this.search.search(a.extend(this.searchOptions,{viewerViewModel:c}));k=this.search.search("getViewModel")}if(this.zooming){l=this.zooming.zooming(this.zoomingOptions||{});f=this.zooming.zooming("getViewModel")}if(this.embedSource){t=this.embedSource.embedSource();o=this.embedSource.embedSource("getViewModel")}if(this.viewTypeMenu){m=this.viewTypeMenu;q=this.viewTypeViewModel}this.documentComponentViewModel=c;this.docViewerPageFlipViewModel=b;this.navigationViewModel=i;this.thumbnailsViewModel=d;this.zoomViewModel=f;this.searchViewModel=k;this.embedSourceViewModel=o;h.bind("getPagesCount",function(b,a){g&&i.setPagesCount(a)}.bind(this));h.bind("onDocumentloadingStarted",function(){e&&d.hideThumbnails()}.bind(this));h.bind("documentLoadFailed.groupdocs",function(){e&&d.showThumbnails(true)}.bind(this));h.bind("_onProcessPages",function(i,h,g,a,c,b,f){if(e)d.onProcessPages(h,g,a,c,b,f)}.bind(this));h.bind("onScrollDocView",function(b,a){e&&d.setThumbnailsScroll(a);g&&i.setPageIndex(a.pi);j&&k.scrollPositionChanged(a.position)}.bind(this));h.bind("documentPageSet.groupdocs",function(c,a){if(b)b.onDocumentPageSet(a);j&&k.documentPageSetHandler()});h.bind("onDocumentLoadComplete",function(e,d,a){b&&b._onDocumentLoaded(d,a);if(l)if(c.isScrollViewerVisible()){f.setFitWidthZoom(c.getFitWidthZoom());f.setFitHeightZoom(c.getFitHeightZoom());f.setZoomWithoutEvent(c.zoom())}else if(b){f.setFitWidthZoom(b.getFitWidthZoom());f.setFitHeightZoom(b.getFitHeightZoom());f.setZoomWithoutEvent(b.zoom())}j&&k.documentLoaded()}.bind(this));n&&n.bind("onPageTurned",function(b,a){g&&i.setPageIndex(a);e&&d.pageInd(a);c.pageIndex(a);c.setPageNumerInUrlHash(a)});j&&j.bind("onPerformSearch",function(g,f,e,d,a,b){c.performSearch(f,e,d,a,b)});if(g){g.bind("onUpNavigate",function(f,a){b&&b.setPage(a);c.setPage(a);if(e){d.setPageWithoutEvent(a);d.setThumbnailsScroll({pi:a,direction:"up"})}}.bind(this));g.bind("onDownNavigate",function(f,a){b&&b.setPage(a);c.setPage(a);if(e){d.setPageWithoutEvent(a);d.setThumbnailsScroll({pi:a,direction:"down"})}}.bind(this));g.bind("onSetNavigate",function(f,a){b&&b.setPage(a.pageIndex);c.setPage(a.pageIndex);if(e){d.setPageWithoutEvent(a.pageIndex);d.setThumbnailsScroll({pi:a.pageIndex,direction:a.direction,eventAlreadyRaised:true})}}.bind(this))}if(l){l.bind("onSetZoom",function(d,a){b&&b.setZoom(a);c.setZoom(a);j&&k.resetButtons()}.bind(this));l.bind(r,function(){m&&q.showDropDownMenu(false)})}if(e){e.bind("onSetThumbnails",function(d,a){c.setPage(a);b&&b.setPage(a);g&&i.setPageIndex(a)}.bind(this));e.bind("onSetThumbnailsScroll",function(b,a){g&&i.setPageIndex(a)}.bind(this));e.bind("onResizeThumbnails",function(d,a){c.resizeViewerElement(a);b&&b.resizeViewerElement(a)});e.bind("onPageReordered",function(d,b,a){c.onPageReordered(b,a)})}m&&m.bind(r,function(){f&&f.showDropDownMenu(false)})},thumbnailsCreator:function(){},thumbnailsViewModelCreator:function(){return{"set":function(){},setThumbnailsScroll:function(){},onProcessPages:function(){},getThumbnailsPanelWidth:function(){return 0}}}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("groupdocsViewer",{options:{enableViewerInit:true,supportTextSelection:true,resourcePrefix:"",useHtmlBasedEngine:true,showFolderBrowser:true,showPrint:true,showDownload:true,showThumbnails:true,openThumbnails:true,showPaging:true,showZoom:true,showSearch:true,showViewerStyleControl:true,enablePageFlipMode:false,embedImagesIntoHtmlForWordFiles:false,instanceIdToken:null,enableStandardErrorHandling:true},_create:function(){a.extend(this.options,{element:this.element,applicationPath:window.groupdocs.viewer.applicationPath,widgetInstance:this});this.options.bindingProvider=new window.groupdocs.bindingProvider;this._viewModel=this.getViewModel()},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new window.groupdocs.groupdocsViewerViewModel(this.options)},on:function(a,b){this.element.on(a,b)},off:function(a,b){this.element.off(a,b)},setWidth:function(a){this._viewModel.setWidth(a)},setHeight:function(a){this._viewModel.setHeight(a)},openNextPage:function(){this._viewModel.openNextPage()},openPreviousPage:function(){this._viewModel.openPreviousPage()},setPage:function(a){this._viewModel.setPage(a)},openFirstPage:function(){this._viewModel.openFirstPage()},openLastPage:function(){this._viewModel.openLastPage()},showFileBrowser:function(){this._viewModel.showFileBrowser()},setViewerMode:function(a){this._viewModel.setViewerMode(a)},zoomIn:function(){this._viewModel.zoomIn()},zoomOut:function(){this._viewModel.zoomOut()},setZoom:function(a){this._viewModel.setZoom(a)},downloadDocument:function(){this._viewModel.downloadDocument()},printDocument:function(){this._viewModel.printDocument()},searchForward:function(d,c,b,a){this._viewModel.searchForward(d,c,b,a)},searchBackward:function(d,c,b,a){this._viewModel.searchBackward(d,c,b,a)},clearSearchValue:function(){this._viewModel.clearSearchValue()},getDocumentPageCount:function(){return this._viewModel.getDocumentPageCount()},loadDocument:function(a){this._viewModel.loadDocument(a)},rotateCurrentPage:function(a){this._viewModel._rotatePage(a)},setLoadingState:function(a){this._viewModel.setLoadingState(a)},getContentControlDescriptions:function(){return this._viewModel.getContentControlDescriptions()},navigateToContentControl:function(a){this._viewModel.navigateToContentControl(a)},destroy:function(){this._viewModel.destroy()}});if(!window.groupdocs)window.groupdocs={};window.groupdocs.groupdocsViewerViewModel=function(b){a.extend(this,b);this._create(b)};a.extend(window.groupdocs.groupdocsViewerViewModel.prototype,{groupdocsViewerWrapper:null,browserIsInternetExplorer:false,resizeTimeoutId:null,viewModes:{ScrollMode:1,BookMode:2},viewMode:null,licElement:null,printImageElements:null,_create:function(a){this._model=new b(a);this._init(a)},_init:function(F){var c,e=this.element;this.viewerId=window.groupdocs.viewerId;var b=a.extend({hostUrl:this.applicationPath,docViewerId:"docViewer"+this.viewerId},F);this.printImageElements=[];window.groupdocs.viewerId++;var I=false;if(F.enableViewerInit){var f,A=false;if(a.browser.msie){this.browserIsInternetExplorer=true;if(a.browser.version==8||a.browser.version==9){I=true;if(a.browser.version==8)A=true}f=".grpdx input[type='text']::-ms-clear {display: none;}";a("<style>"+f+"</style>").appendTo("head")}var k="grpdx"+b.docViewerId,d=this,t="";if(d.browserIsInternetExplorer&&b.useHtmlBasedEngine){t=" ie";if(A)t+=" ie8"}var R="";if(!b.showHeader)R='style="display: none"';var jb={classWithNumber:k,headerStyle:R,browserIsIE8:A,supportPageRotation:b.supportPageRotation,browserDependentCssClass:t,docViewerId:b.docViewerId,showThumbnails:b.showThumbnails};this.bindingProvider.createHtml("initializationComponent",this.element,jb)}this.groupdocsViewerWrapper=c=e.find(".groupdocs_viewer_wrapper");var B=this.viewerHeader=c.find(".viewer_header"),m=this.viewerMainWrapper=c.find(".viewer_mainwrapper");if(!b.showHeader){B.height(0);m.css("top","0")}if(!F.enableViewerInit)return;if(b.filePath=="")b.openThumbnails=false;var K="#"+b.docViewerId,i=a(K),P=c.find("[name='search_wrapper']");if(b.useHtmlBasedEngine||!b.enablePageFlipMode){B.find("li[name='openDoublePageFlipViewMenuItem']").hide();if(!b.supportTextSelection){f="."+k+" .html_pages_container{-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}";a("<style>"+f+"</style>").appendTo("head");if(this.browserIsInternetExplorer)i.on("selectstart",function(a){a.preventDefault();return true})}b.supportPageReordering=false}var s,C;if(b.width)s=b.width;else s=e.width();c.width(s);if(b.height)C=b.height;else C=e.height();c.height(C);var p=null;if(!b.useHtmlBasedEngine){p=c.find("[name='selection-content']");if(p.length==0)p=a("<textarea readonly='readonly' rows='1' cols='1' name='selection-content'></textarea>'").appendTo(c)}var T=c.find("[name='jGDerror']");T.find(".modal_dialog_overlay").click(function(){T.hide()});var x=c.find(".navigation-bar"),z=c.find(".zoom_wrappper"),G=c.find(".doc_viewer_wrapper_page_flip"),v=this.fileOpenDialogWrapper=c.find(".fileOpenDialogWrapper");if(!b.supportTextSelection){var W=K+" .ui-selectable-helper {display: none;visibility: hidden}";a("<style>"+W+"</style>").appendTo("head")}var w;if(b.thumbnailsContainerWidth){var Z=203,V=150,U=187,M=this.getScrollbarWidth(),u=Math.round(b.thumbnailsContainerWidth),S=(Z-M)/(u-M);w=Math.round(V/S);var X=Math.round(U/S);f="div.thumbnailsContainer{width:"+u+"px}";f+="div.thumbnailsContainer ul li img{width:"+w+"px}";f+="div.thumbnailsContainer ul li{min-width:"+X+"px}";f+=".thumbs_btn_slide{left:"+(u+2)+"px}";a("<style>"+f+"</style>").appendTo("head")}f="";if(b.searchHighlightColor)f+="."+k+" .search_highlight_html, ."+k+" .search-highlight {background-color:"+b.searchHighlightColor+"; fill:"+b.searchHighlightColor+"}";if(b.currentSearchHighlightColor)f+=".grpdx."+k+" .current_search_highlight {background-color:"+b.currentSearchHighlightColor+"; fill:"+b.currentSearchHighlightColor+"}";if(b.useEmScaling)f+=".grpdx."+k+" .html_page_contents {transform-origin:initial}";f&&a("<style>"+f+"</style>").appendTo("head");function j(){d._localizeElements()}i.bind("onHtmlCreated",j);x.bind("onHtmlCreated",j);z.bind("onHtmlCreated",j);G.bind("onHtmlCreated",j);v.bind("onHtmlCreated",j);var hb={createHtml:true,viewerElement:i,useCaseSensitiveSearch:b.useCaseSensitiveSearch,searchForSeparateWords:b.searchForSeparateWords,treatPhrasesInDoubleQuotesAsExactPhrases:b.treatPhrasesInDoubleQuotesAsExactPhrases,useHtmlBasedEngine:b.useHtmlBasedEngine,searchIsVisible:b.showSearch,useRtl:b.useRtl,useAccentInsensitiveSearch:b.useAccentInsensitiveSearch,useVirtualScrolling:b.useVirtualScrolling},db={createHtml:true,thumbnailWidth:w,quality:100,useHtmlBasedEngine:b.useHtmlBasedEngine,useHtmlThumbnails:b.useHtmlThumbnails,useInnerThumbnails:b.useInnerThumbnails,supportPageReordering:b.supportPageReordering,ignoreDocumentAbsence:b.ignoreDocumentAbsence,supportPageRotation:b.supportPageRotation,openThumbnails:b.openThumbnails,instanceIdToken:b.instanceIdToken,locale:b.locale},E;if(b.showThumbnails)E=m;else E=null;var ib={watermarkText:b.watermarkText,watermarkColor:b.watermarkColor,watermarkPosition:b.watermarkPosition,watermarkWidth:b.watermarkWidth,preventTouchEventsBubbling:b.preventTouchEventsBubbling,searchForSeparateWords:b.searchForSeparateWords,treatPhrasesInDoubleQuotesAsExact:b.treatPhrasesInDoubleQuotesAsExact,usePngImagesForHtmlBasedEngine:b.usePngImagesForHtmlBasedEngine,alwaysOnePageInRow:b.showOnePageInRow||b.viewerStyle==window.groupdocs.OnePageInRow,onlyShrinkLargePages:b.onlyShrinkLargePages,loadAllPagesOnSearch:b.loadAllPagesOnSearch,useEmScaling:b.useEmScaling,convertWordDocumentsCompletely:b.convertWordDocumentsCompletely,ignoreDocumentAbsence:b.ignoreDocumentAbsence,usePdf:b.supportTextSelection,preloadPagesOnBrowserSide:b.preloadPagesOnBrowserSide,supportPageRotation:b.supportPageRotation,useAccentInsensitiveSearch:b.useAccentInsensitiveSearch,useRtl:b.useRtl,viewerLayout:b.viewerStyle,useVirtualScrolling:b.useVirtualScrolling,supportListOfContentControls:b.supportListOfContentControls,supportListOfBookmarks:b.supportListOfBookmarks,embedImagesIntoHtmlForWordFiles:b.embedImagesIntoHtmlForWordFiles,instanceIdToken:b.instanceIdToken,browserIsIE9OrLess:I,locale:b.locale},eb="onMenuClicked",D=c.find(".viewTypeMenu"),n={dropDownMenuIsVisible:this.bindingProvider.getObservable(false),dropDownMenuClicked:false,openScrollView:function(){d.setMultiplePagesInRowLayout()},openDoublePageFlipView:function(){d.openDoublePageFlipView()},openOnePageInRowView:function(){d.openOnePageInRowView()},openTwoPagesInRowView:function(){d.openTwoPagesInRowView()},openCoverThenTwoPagesInRowView:function(){d.openCoverThenTwoPagesInRowView()},showDropDownMenu:function(a){this.dropDownMenuIsVisible(a)},toggleDropDownMenu:function(b,a){this.dropDownMenuIsVisible(!this.dropDownMenuIsVisible());this.dropDownMenuClicked=true;D.trigger(eb);a.stopPropagation()}},Q=this.viewerAdapter=new groupdocs.ViewerEventBus({fileId:b.filePath,fileVersion:"0",quality:b.quality,supportTextSelection:b.supportTextSelection,docSpace:i,createHtml:true,initialZoom:b.initialZoom,viewerWidth:s,viewerHeight:m.height(),docViewerId:b.docViewerId,zoomToFitWidth:b.zoomToFitWidth,zoomToFitHeight:b.zoomToFitHeight,navigation:b.showPaging?x:null,navigationOptions:{createHtml:true},thumbnails:E,thumbnailsOptions:db,zooming:b.showZoom?z:null,zoomingOptions:{createHtml:true},search:b.showSearch?P:null,searchOptions:hb,preloadPagesCount:b.preloadPagesCount,docSpacePageFlip:b.useHtmlBasedEngine||!b.enablePageFlipMode||b.viewerStyle==this.viewModes.ScrollMode&&!b.showViewerStyleControl?null:G,usePageNumberInUrlHash:false,selectionContent:p,imageVerticalMargin:14,searchPartialWords:true,variablePageSizeSupport:true,textSelectionSynchronousCalculation:false,minimumImageWidth:b.minimumImageWidth,fileDisplayName:b.fileDisplayName,pageContentType:b.useHtmlBasedEngine?"html":"image",useHtmlBasedEngine:b.useHtmlBasedEngine,searchExactText:b.searchExactText,viewerOptions:ib,viewTypeMenu:D,viewTypeViewModel:n,instanceId:this.viewerId});if(b.showFolderBrowser){var Y={hostUrl:b.hostUrl,userId:b.userId,userKey:b.userKey,fileExplorer:c.find(".file_browser_content"),fileUploader:c.find(".file_browser_toolbar"),resourcePrefix:b.resourcePrefix,urlHashEnabled:false,instanceIdToken:b.instanceIdToken};v.groupdocsFileOpenDialog(Y);v.find(".popclose").click(function(){d._hideFileOpenDialog()})}j();var r=e.find(".thumbs_btn");b.useInnerThumbnails&&r.hide();function N(){b.showThumbnails&&b.thumbsImageBase64Encoded!=null&&r.css("background-image","url(data:image/png;base64,"+b.thumbsImageBase64Encoded+")").css("background-position","0 0")}N();r.click(function(){a(this).toggleClass("thumbs_btn_slide");e.find(".thumbnailsContainer").toggle();if(a.browser.msie){r.css("background-image","");N()}return false});c.find(".btnOpen").click(function(){d._showFileOpenDialog()});c.find("[name=rotateClockwise]").click(function(){d._rotatePage(90)});c.find("[name=rotateCounterClockwise]").click(function(){d._rotatePage(-90)});c.find(".file_browser_content").bind("fileSelected",function(b,a){d._hideFileOpenDialog();d.fileDisplayName=Q.documentComponentViewModel.fileDisplayName="";Q.documentComponentViewModel.loadDocument(a.guid)});b.showThumbnails&&b.openThumbnails&&e.find(".thumbs_btn").addClass("thumbs_btn_slide");this.bindingProvider.applyBindings(n,D);a("html").click(function(){d.viewerAdapter.zoomViewModel&&d.viewerAdapter.zoomViewModel.showDropDownMenu(false);n.showDropDownMenu(false)});if(b.backgroundColor){e.find(".groupdocs_viewer_wrapper").css("background-color",b.backgroundColor);B.css("background-color",b.backgroundColor);e.find(".new_head_input").css("background-color",b.backgroundColor);e.find(".new_head_tools_wrapper").css("background-color",b.backgroundColor).css("box-shadow","none");e.find(".thumbs_btn").css("background-color",b.backgroundColor)}e.find(".btnOpen").css("display",b.showFolderBrowser?"":"none");e.find(".navigation-bar").css("display",b.showPaging?"":"none");z.css("display",b.showZoom?"":"none");e.find(".btn_download").css("display",b.showDownload?"":"none");e.find(".print_button").css("display",b.showPrint?"":"none");e.find(".viewTypeMenu").css("display",b.showViewerStyleControl?"":"none");b.showPrint===false&&b.showDownload===false&&e.find("[name='printAndDownloadToolbar']").css("display","none");b.showSearch===false&&P.css("display","none");function O(e,d,f){for(var c=["-moz-","-webkit-",""],a=e+"{",b=0;b<c.length;b++)a+=c[b]+d+":"+f+";";a+="}";return a}var g="";if(b.toolbarButtonsBoxShadowStyle){var J="box-shadow",y=O(".grpdx .new_head_tools_btn",J,b.toolbarButtonsBoxShadowStyle);g+=y;if(b.toolbarButtonsBoxShadowHoverStyle){y=O(".grpdx .new_head_tools_btn:hover",J,b.toolbarButtonsBoxShadowHoverStyle);g+=y}}if(b.thumbnailsContainerBackgroundColor)g+=".grpdx div.thumbnailsContainer{background-color:"+b.thumbnailBackgroundColor+"}\r\n";if(b.toolbarBorderBottomColor)g+=".grpdx .viewer_header{border-bottom-color:"+b.toolbarBorderBottomColor+"}\r\n";if(b.thumbnailsContainerBorderRightColor)g+=".grpdx div.thumbnailsContainer{border-right-color:"+b.thumbnailsContainerBorderRightColor+"}\r\n";if(b.toolbarInputFieldBorderColor)g+=".grpdx .new_head_input{border-color:"+b.toolbarInputFieldBorderColor+"}\r\n";if(b.toolbarButtonBorderColor)g+=".grpdx .new_head_tools_btn{border-color:"+b.toolbarButtonBorderColor+"}\r\n";if(b.useInnerThumbnails)g+=".grpdx #"+b.docViewerId+"{display: inline-block}\r\n";a("<style>"+g+"</style>").appendTo("head");i.bind("onDocumentLoadComplete",function(b,a){d.documentLoadCompleteHandler(a,c,m)});i.bind("onDocumentLoaded",function(b,a){d.documentLoadedHandler(a,c,m)});i.bind("isDocumentSinglePaged.groupdocs",function(b,a){d.documentSinglePagedHandler(a,x)});if(b.viewerStyle==this.viewModes.BookMode)n.openDoublePageFlipView();else this.viewMode=this.viewModes.ScrollMode;var l=c.find("[name='jGDerror']"),H=l.find(".modal_dialog_content"),h=l.find(".modal_dialog_content_wrapper"),ab=l.find(".modal_dialog_header");l.removeClass("jerrorwrapper");var L=c.find(".viewer_mainwrapper"),kb=false;if(!window.jGDError)window.jGDError=[];window.jGDError[this.viewerId]=function(f){a(e).trigger("error.groupdocs",f);if(b.enableStandardErrorHandling){var m=c.find(".btn_download");m.unbind();m.bind({click:function(){d._downloadDocument();return false}});f=f.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");if(!f)f="Sorry, we're unable to perform your request right now. Please try again later.";l.css("height","auto");ab.text("Error");var g,i;if(f.substring(0,1)=="<"){H.html(f);var k=L.width(),j=L.height();if(k<100)g=k;else g=k-100;if(j<100)i=j;else i=j-100}else H.text(f);if(g!=undefined){h.css("margin-left",-g/2);h.width(g)}i!=undefined&&h.height(i);l.show();h.css("margin-left",-h.width()/2);h.css("margin-top",-h.height()/2)}};var q=this.groupdocsViewerWrapper.find("[name='messageDialog']"),gb=q.find("[name='minimizeButton']"),fb=q.find("[name='maximizeButton']");gb.click(function(){q.addClass("min")});fb.click(function(){q.removeClass("min")});var o=this.groupdocsViewerWrapper.find("[name='messageDialogPdf']"),cb=o.find("[name='minimizeButtonPdf']"),bb=o.find("[name='maximizeButtonPdf']");cb.click(function(){o.addClass("min")});bb.click(function(){o.removeClass("min")});this.resizeHandler()},documentLoadedHandler:function(h){this.printFrameLoaded=false;var e=a("body"),c="printFrame"+this.viewerId,b=e.children("div.groupdocsPrintFrame[name='"+c+"'],div.groupdocsPrintFrameDeactivated[name='"+c+"']");if(b.length==0){b=a("<div class='groupdocsPrintFrameDeactivated'></div>");b.attr("name",c);b.appendTo(e)}else b.empty();this.printImageElements.length=0;var d=h.pageCount;if(!h.lic&&d>3)d=3;for(var f,g=0;g<d;g++){f=a("<img/>").appendTo(b);this.printImageElements.push(f)}},documentLoadCompleteHandler:function(a,b){var e=this;this._setFitWidthAndHeightValues();this.downloadUrl=a.url;this.pdfDownloadUrl=a.pdfDownloadUrl;this.pdfPrintUrl=a.pdfPrintUrl;this.documentPath=a.path;var c=b.find(".btn_download"),d=b.find(".print_button");c.unbind();d.unbind();c.bind({click:function(){e._downloadDocument();return false}});d.bind({click:function(){e._printDocument();return false}})},documentSinglePagedHandler:function(b,a){if(this.showPaging)if(b)a.hide();else a.show()},_localizeElements:function(){var b=this;this.localizedStrings!=null&&b.element.find("[data-localize],[data-localize-ph],[data-localize-tooltip]").each(function(){var e=a(this),c=e.attr("data-localize"),d;if(c){d=b.localizedStrings[c];e.text(d)}else{c=e.attr("data-localize-ph");if(c){d=b.localizedStrings[c];e.attr("placeholder",d)}else{c=e.attr("data-localize-tooltip");if(c){d=b.localizedStrings[c];e.attr("data-tooltip",d)}}}})},getScrollbarWidth:function(){var c=null,d=a("<div/>").css("width","100px").css("height","100px").css("overflow","scroll").css("position","absolute").css("top","-9999px"),b=d[0];document.body.appendChild(b);c=b.offsetWidth-b.clientWidth;document.body.removeChild(b);return c},resizeHandler:function(){if(this.showHeader){var b=this.viewerHeader.outerHeight(true);if(b!=this.viewerMainWrapper.position().top){var d=b;this.viewerMainWrapper.css("top",d.toString()+"px");this.viewMode==this.viewModes.BookMode&&this.viewerAdapter.docViewerPageFlipViewModel.reInitSelectable()}}if(this.viewMode!=this.viewModes.BookMode){this.viewerAdapter.documentComponentViewModel.calculatePagePositions();this.viewerAdapter.documentComponentViewModel.reInitSelectable()}if(this.useInnerThumbnails){var a=0,c=this.viewerAdapter.thumbnailsViewModel;if(c)a=c.getThumbnailsPanelWidth();if(this.viewMode==this.viewModes.BookMode)this.viewerAdapter.docViewerPageFlipViewModel.resizeViewerElement(a);else this.viewerAdapter.documentComponentViewModel.resizeViewerElement(a)}else this.viewerAdapter.documentComponentViewModel.loadImagesForVisiblePages();this._setFitWidthAndHeightValues()},resizeHandlerWithDelay:function(){this.resizeTimeoutId&&clearTimeout(this.resizeTimeoutId);var a=this;this.resizeTimeoutId=window.setTimeout(function(){a.resizeHandler()},1e3)},setWidth:function(a){this.groupdocsViewerWrapper.width(a);this.resizeHandler();this.resizeHandlerWithDelay()},setHeight:function(a){this.groupdocsViewerWrapper.height(a);this.resizeHandler();this.resizeHandlerWithDelay()},_showFileOpenDialog:function(){var b=this;this.fileOpenDialogWrapper.addClass("in");this.fileOpenDialogWrapper.show();this.backdrop=a('<div class="modal-backdrop fade" />').appendTo(this.groupdocsViewerWrapper),this.backdrop.click(function(){b._hideFileOpenDialog()});this.backdrop.addClass("in")},_hideFileOpenDialog:function(){this.backdrop.removeClass("in");this.backdrop.remove();this.fileOpenDialogWrapper.hide()},_rotatePage:function(a){this.viewerAdapter.documentComponentViewModel.rotatePage(a)},openScrollView:function(){var b=this.groupdocsViewerWrapper.find(".doc_viewer"),a=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip");a.css("position","absolute");a.css("height","100%");a.hide();b.show();this.viewerAdapter.documentComponentViewModel.openCurrentPage();this.viewerAdapter.search&&this.viewerAdapter.searchViewModel.showControls()},setMultiplePagesInRowLayout:function(){this.openScrollView();this.viewerAdapter.documentComponentViewModel.setLayout(window.groupdocs.ScrollMode);this.viewerAdapter.documentComponentViewModel.reInitSelectable();this._setFitWidthAndHeightValues();this.viewMode=this.viewModes.ScrollMode},openDoublePageFlipView:function(){if(!this.useHtmlBasedEngine){var b=this.groupdocsViewerWrapper.find(".doc_viewer"),a=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip");a.css("display","inline-block");this.viewerAdapter.documentComponentViewModel.setLayout(window.groupdocs.BookMode);this.viewerAdapter.docViewerPageFlipViewModel.openCurrentPage();a.css("height","");a.css("top","");a.css("position","");b.hide();this.viewMode=this.viewModes.BookMode;this.resizeHandler();this.viewerAdapter.docViewerPageFlipViewModel.reInitSelectable();this._setFitWidthAndHeightValues(true);this.viewerAdapter.search&&this.viewerAdapter.searchViewModel.hideControls()}},openOnePageInRowView:function(){this.openScrollView();this.viewerAdapter.documentComponentViewModel.setLayout(window.groupdocs.OnePageInRow);this.viewerAdapter.documentComponentViewModel.reInitSelectable();!this.useHtmlBasedEngine&&this.viewerAdapter.documentComponentViewModel.openCurrentPage()},openTwoPagesInRowView:function(){this.openScrollView();this.viewerAdapter.documentComponentViewModel.setLayout(window.groupdocs.TwoPagesInRow);this.viewerAdapter.documentComponentViewModel.reInitSelectable();!this.useHtmlBasedEngine&&this.viewerAdapter.documentComponentViewModel.openCurrentPage()},openCoverThenTwoPagesInRowView:function(){this.openScrollView();this.viewerAdapter.documentComponentViewModel.setLayout(window.groupdocs.CoverThenTwoPagesInRow);this.viewerAdapter.documentComponentViewModel.reInitSelectable();!this.useHtmlBasedEngine&&this.viewerAdapter.documentComponentViewModel.openCurrentPage()},_downloadDocument:function(){this.element.trigger("downloadButtonClick.groupdocs");var b=this.downloadUrl;if(b==null){var c=this._model._portalService._urlSuffix||"";b=this.applicationPath+"/document-viewer/GetFile"+c+"?path="+this.filePath+"&getPdf=false&useHtmlBasedEngine=false&supportPageRotation=false"}if(this.downloadPdfFile&&typeof this.pdfDownloadUrl!=="undefined")b=this.pdfDownloadUrl;if(this.showDownloadErrorsInPopup)a.fileDownload(b,{failCallback:function(a){window.jGDError(a)},cookieName:self.jqueryFileDownloadCookieName,containerElement:this.groupdocsViewerWrapper});else window.location.href=b;return false},_printDocument:function(){if(this.usePdfPrinting){var l=this._getLocalizedString("Printing","Printing"),d=this._getLocalizedString("Printing","Printing");this._showMessageDialogPdf(l,d);var q=this,o=window.open(this.pdfPrintUrl);o.onload=function(){q._hideMessageDialogPdf()}}else{var r=navigator.userAgent.toLowerCase(),p=r.indexOf("android")>-1;p&&alert("You seem to use an Android device. Your browser does not support the JavaScript print function.");var h="";if(this.fileDisplayName)h=this.fileDisplayName;var b=this,m=this.useHtmlBasedEngine&&!this.useImageBasedPrinting,f=a("body"),e="printFrame"+this.viewerId,c=f.children("div.groupdocsPrintFrame[name='"+e+"'],div.groupdocsPrintFrameDeactivated[name='"+e+"']"),g=f.children("div.groupdocsPrintFrame,div.groupdocsPrintFrameDeactivated").not(c);g.removeClass("groupdocsPrintFrame");g.addClass("groupdocsPrintFrameDeactivated");c.removeClass("groupdocsPrintFrameDeactivated");c.addClass("groupdocsPrintFrame");var k=null,i=null,n=this.watermarkPosition,j=null;if(this.printWithWatermark){k=this.watermarkText;i=this.watermarkColor;j=this.watermarkWidth}if(c.length==0){c=a("<div class='groupdocsPrintFrame'></div>");c.attr("name",e);c.appendTo(f)}if(this.printFrameLoaded)window.print();else{var l=this._getLocalizedString("Getting a printable version of the document","GettingPrintableVersionOfDocument"),d=this._getLocalizedString("Printing","Printing");this._showMessageDialog(l,d,0);this._model.getPrintableHtml(this.documentPath,m,h,k,i,n,j,this.ignoreDocumentAbsence,this.instanceIdToken,function(l){b._hideMessageDialog();var k,g=l.length,h=b._getLocalizedString("Preparing the pages","PreparingPages");h+=": ";var f=0;b._showMessageDialog(h+f+"/"+g,d,0);for(var m=b.printImageElements.length,e=m;e<g;e++){var i;i=a("<img/>").appendTo(c);b.printImageElements.push(i)}for(e=0;e<b.printImageElements.length;e++){var j,n=function(){f++;b._updateMessageDialog(h+f+"/"+g,d,f/g*100);if(f>=g){b._hideMessageDialog();window.print();b.printFrameLoaded=true}};k=l[e];j=b.printImageElements[e];j.load(n).attr("src",k)}},function(){b._hideMessageDialog()},this.locale)}}return false},printFromIframe:function(a){a[0].contentWindow.focus();a[0].contentWindow.print()},_showMessageDialog:function(c,d,b){var a=this._updateMessageDialog(c,d,b);a.show()},_updateMessageDialog:function(i,j,d){var a=this.groupdocsViewerWrapper.find("[name='messageDialog']"),h=a.find(".modal_dialog_content p[name='message']");h.text(i);var c=a.find(".modal_dialog_header"),e=c.find("span[name='alwaysVisibleTitle']");e.text(j);var g=a.find(".progress");if(typeof d!="undefined"){var b=Math.round(d)+"%";g.css("width",b);var f=c.find("span[name='visibleWhenMinimizedTitle']");f.text(b)}return a},_hideMessageDialog:function(){var a=this.groupdocsViewerWrapper.find("[name='messageDialog']");a.hide()},_showMessageDialogPdf:function(b,c){var a=this._updateMessageDialogPdf(b,c);a.show()},_updateMessageDialogPdf:function(e,f){var a=this.groupdocsViewerWrapper.find("[name='messageDialogPdf']"),c=a.find(".modal_dialog_content p[name='message']");c.text(e);var d=a.find(".modal_dialog_header"),b=d.find("span[name='alwaysVisibleTitlePdf']");b.text(f);return a},_hideMessageDialogPdf:function(){var a=this.groupdocsViewerWrapper.find("[name='messageDialogPdf']");a.hide()},_getLocalizedString:function(d,c){var b=d;if(this.localizedStrings){var a=this.localizedStrings[c];if(a)b=a}return b},_setFitWidthAndHeightValues:function(e){if(this.viewerAdapter.zooming){var d,c,b,a;if(e){b=this.viewerAdapter.docViewerPageFlipViewModel.getFitWidthZoom();a=this.viewerAdapter.docViewerPageFlipViewModel.getFitHeightZoom()}else{d=this.groupdocsViewerWrapper.width();this.viewerAdapter.documentComponentViewModel.setContainerWidth(d);c=this.viewerMainWrapper.height();this.viewerAdapter.documentComponentViewModel.setContainerHeight(c);b=this.viewerAdapter.documentComponentViewModel.getFitWidthZoom();a=this.viewerAdapter.documentComponentViewModel.getFitHeightZoom()}this.viewerAdapter.zoomViewModel.setFitWidthZoom(b);this.viewerAdapter.zoomViewModel.setFitHeightZoom(a)}},openNextPage:function(){this.viewerAdapter.navigationViewModel.down()},openPreviousPage:function(){this.viewerAdapter.navigationViewModel.up()},setPage:function(a){this.viewerAdapter.navigationViewModel.selectPage(a)},openFirstPage:function(){this.viewerAdapter.navigationViewModel.openFirstPage()},openLastPage:function(){this.viewerAdapter.navigationViewModel.openLastPage()},showFileBrowser:function(){this._showFileOpenDialog()},setViewerMode:function(a){if(a==0)this.openScrollView();else this.openDoublePageFlipView()},zoomIn:function(){this.viewerAdapter.zoomViewModel.zoomIn()},zoomOut:function(){this.viewerAdapter.zoomViewModel.zoomOut()},setZoom:function(b){var a=b;switch(b){case window.groupdocs.FitWidth:a=this.viewerAdapter.zoomViewModel.getFitWidthZoomValue();break;case window.groupdocs.FitHeight:a=this.viewerAdapter.zoomViewModel.getFitHeightZoomValue()}this.viewerAdapter.zoomViewModel.setZoom({value:a})},downloadDocument:function(){this._downloadDocument()},printDocument:function(){this._printDocument()},searchForward:function(a,d,c,b){if(this.viewerAdapter.searchViewModel.searchValue()!=a)this.viewerAdapter.searchViewModel.searched=false;this.viewerAdapter.searchViewModel.searchValue(a);this.viewerAdapter.searchViewModel.findNext(d,c,b)},searchBackward:function(a,d,c,b){if(this.viewerAdapter.searchViewModel.searchValue()!=a)this.viewerAdapter.searchViewModel.searched=false;this.viewerAdapter.searchViewModel.searchValue(a);this.viewerAdapter.searchViewModel.findPrevious(d,c,b)},clearSearchValue:function(){this.viewerAdapter.searchViewModel.clearValue()},getDocumentPageCount:function(){return this.viewerAdapter.documentComponentViewModel.pageCount()},loadDocument:function(a){this.viewerAdapter.documentComponentViewModel.loadDocument(a)},setLoadingState:function(a){this.viewerAdapter.documentComponentViewModel.setLoadingState(a)},getContentControlDescriptions:function(){return this.viewerAdapter.documentComponentViewModel.getContentControlDescriptions()},navigateToContentControl:function(a){this.viewerAdapter.documentComponentViewModel.navigateToContentControl(a)},destroy:function(){var b=this.groupdocsViewerWrapper.find(".doc_viewer_wrapper_page_flip .pages_container_flip");b.length!=0&&b.turn("is")&&b.turn("destroy");this.groupdocsViewerWrapper.remove();a.Widget.prototype.destroy.call(this.widgetInstance)}});var b=function(b){a.extend(this,b);this._init()};a.extend(b.prototype,{_portalService:null,_init:function(){this._portalService=Container.Resolve("ServerExchange")},getPrintableHtml:function(j,b,d,i,f,c,g,a,e,k,h,l){this._portalService.getPrintableHtml(j,b,d,i,f,c,g,a,function(a){k.apply(this,[a.data])},function(a){h.apply(this,[a])},e,l)}});a.support.cors=true;if(!jQuery.browser){jQuery.browser={};(function(){jQuery.browser.msie=false;jQuery.browser.version=0;if(navigator.appName=="Microsoft Internet Explorer"){if(navigator.userAgent.match(/MSIE ([0-9]+)\./)){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}}else if(navigator.appName=="Netscape"){var b=navigator.userAgent,a=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(a.exec(b)!=null){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}}})()}window.groupdocs.ScrollMode=1;window.groupdocs.BookMode=2;window.groupdocs.OnePageInRow=3;window.groupdocs.TwoPagesInRow=4;window.groupdocs.CoverThenTwoPagesInRow=5;window.groupdocs.FitWidth=-1;window.groupdocs.FitHeight=-2;window.groupdocs.viewerId=1})(jQuery);(function(f){"use strict";if(!window.groupdocs)window.groupdocs={};if(!window.Container){window.Container=new JsInject.Container;Container.Register("Rx.Observable",function(){return Rx.Observable},true);Container.Register("RequestObservable",function(){return f.ajaxAsObservable},true);Container.Register("AsyncSubject",function(){return new Rx.AsyncSubject},false);var b=window.location.hostname+(window.location.port?":"+window.location.port:"");if(!window.groupdocs.viewer)window.groupdocs.viewer={};var a=window.groupdocs.viewer&&window.groupdocs.viewer.applicationPath;if(typeof a=="undefined"||a=="/"){a=window.location.protocol+"//"+b+"/";window.groupdocs.viewer.applicationPath=a}else{var d=a.indexOf("//");if(d==-1){var e=window.location.protocol+"//"+b+a;window.groupdocs.viewer.applicationPath=e}var c=d+2;if(a.indexOf(b,c)!=c)window.groupdocs.viewer.isWorkingCrossDomain=true}Container.Register("ServerExchange",function(){return new groupdocs.ServerExchange(window.groupdocs.viewer.applicationPath,window.groupdocs.viewer.useHttpHandlers,window.groupdocs.viewer.isWorkingCrossDomain)},true)}})(jQuery);(function(a){"use strict";if(!window.groupdocs)window.groupdocs={};window.groupdocs.bindingProvider=function(){this.create()};a.extend(window.groupdocs.bindingProvider.prototype,{areBindingsCreated:false,create:function(){if(!window.groupdocs.bindingProvider.prototype.areBindingsCreated){ko.bindingHandlers.sortableArray={init:function(e,c,f,d){var b=c();a(e).sortable({axis:"y",update:function(h,e){var f=e.item[0],c=ko.dataFor(f),g=b.indexOf(c),a=ko.utils.arrayIndexOf(e.item.parent().children(),f);e.item.remove();if(a>=0){b.remove(c);b.splice(a,0,c)}d.rootElement.trigger("onPageReordered",[g,a])}})}};if(!ko.bindingHandlers.searchText)ko.bindingHandlers.searchText={update:function(e,c,h,g,a){var d=a.$root,b=a.$data;if(!b.searched){var f=ko.utils.unwrapObservable(c());d.parseSearchParameters(e,f)}b.searched=false}};if(!ko.bindingHandlers.parsedHtml)ko.bindingHandlers.parsedHtml={init:function(h,g,e){var d=g(),f=a(h),c=f.html();if(ko.isWriteableObservable(d))d(c);else{var b=e();b._ko_property_writers&&b._ko_property_writers.parsedHtml&&b._ko_property_writers.parsedHtml(c)}},update:function(h,f,i,j,e){var c=ko.unwrap(f())||"",b=e.$data,d=a(h);d.empty();if(c){if(typeof b.currentValue=="undefined"||b.currentValue===null||b.currentValue!=c){var g=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");b.parsedHtmlElement=a(g);b.currentValue=c}d.append(b.parsedHtmlElement)}else{b.parsedHtmlElement=null;b.currentValue=null}}};window.groupdocs.bindingProvider.prototype.areBindingsCreated=true}},getValue:function(a){return a()},setValue:function(b,a,c){b[a](c)},getObservable:function(a){return ko.observable(a)},getObservableArray:function(a){return ko.observableArray(a)},getComputedObservable:function(a){return ko.computed(a)},createHtml:function(c,d,e){var b=this.componentHtml[c](e);if(b.element)return b;else a(b).appendTo(d)},applyBindings:function(a,b){ko.applyBindings(a,b.get(0))},componentHtml:{zooming:function(){return'<div class="left">    <a class="new_head_tools_btn h_t_i_zoomin" href="#" data-bind="click: zoomIn" data-tooltip="Zoom In" data-localize-tooltip="ZoomIn"> </a>    <a class="new_head_tools_btn h_t_i_zoomout" href="#" data-bind="click: zoomOut" data-tooltip="Zoom Out" data-localize-tooltip="ZoomOut"> </a>    <div class="new_head_tools_dropdown_wrapper">        <a class="new_head_tools_btn head_tool_dropdown_btn h_t_i_zoom" href="#" data-bind="click: toggleDropDownMenu" data-tooltip="Zoom Level" data-localize-tooltip="ZoomLevel">        </a>        <ul class="dropdown-menu head_tool_dropdown" style="display: none;" data-bind="style: {display: (dropDownMenuIsVisible() ? \'block\' : \'none\')}, foreach: zooms">            <li>                <a href="#" data-bind="text: name, event: { mousedown: function(item, e) { $parent.setZoom(item, e); } }, attr: {\'data-localize\': $data.localizationKey }"></a>            </li>        </ul>    </div></div>'},viewing:function(b){var c;if(b.supportPageRotation)c=" + ' translateY(' + (($root.isHtmlDocument() && $data.rotation() == 180) ? '100%' : '0') + ') ' + 'rotate(' + $data.rotation() + 'deg)' + ' translateX(' + (($data.rotation() == 180 || $data.rotation() == 270) ? '-100%' : '0') + ')' + ' translateY(' + (($data.rotation() == 90 || (!$root.isHtmlDocument() && $data.rotation() == 180)) ? '-100%' : '0') + ') '  ";else c="";var d="'-ms-transform': 'scale(' + $data.heightRatio() * $root.zoom() / 100.0 + ')' ";if(b.pageContentType=="html"&&a.browser.msie)if(a.browser.version==8)d="zoom: $data.heightRatio() * $root.zoom() / 100.0 ";else d+=c;d+=",";var e;if(b.watermarkText)e='<svg xmlns="http://www.w3.org/2000/svg" class="html_watermark" data-bind="attr:{width: $root.pageWidth() + $root.imageHorizontalMargin + \'px\', height: $root.pageWidth() * $data.prop() + \'px\', viewBox:\'0 0 100 \' + 100 * $data.prop()}" pointer-events="none"><text data-bind="text:$root.watermarkText, style:{fill:$root.intToColor($root.watermarkColor)}, attr:{transform:$root.watermarkTransform($data, $element), y:$root.watermarkPosition.indexOf(\'Top\') == -1 ? 100 * $data.prop() :\'10\'}" font-family="Verdana" font-size="10" x="0" y="0" ></text></svg>';else e="";var h='           <div class="html_page_contents"                 data-bind="'+(b.useVirtualScrolling?"parsedHtml":"html")+": htmlContent(), attr: { id:'"+b.docViewerId+"pageHtml-' + number }, searchText: searchText,                         css: {'page-image': !$root.useTabsForPages()},                         style: {                                  width: $root.rotatedWidth(), "+d+"                                 MozTransform: 'scale(' + $data.heightRatio() * $root.zoom() / 100.0  + ')' "+c+",                                  '-webkit-transform': 'scale(' + $data.heightRatio() * $root.zoom() / 100.0  + ')' "+c+'                               }">            </div>'+e,f=b.pageContentType=="html",g='class="pages_container '+(f?"html_pages_container":"")+'" data-bind="style: pagesContainerStyle()"',i='<div id="'+b.docViewerId+'PagesContainer" '+g+'><!-- ko foreach: { data: $root.useVirtualScrolling ? pages.slice(firstVisiblePageForVirtualMode(), lastVisiblePageForVirtualMode() + 1) : pages, afterRender: function(){$root.highlightSearch();} } --><div class="doc-page" data-bind="attr: {id: $root.pagePrefix + (($root.useVirtualScrolling ? $root.firstVisiblePageForVirtualMode() : 0) + $index() + 1)}, style: $root.pageElementStyle($index()), css: {cover_page: ($root.layout() == $root.Layouts.CoverThenTwoPagesInRow && ($root.useVirtualScrolling ? $root.firstVisiblePageForVirtualMode() : 0) + $index() == 0)}" >       <div class="viewer_loading_overlay" data-bind="visible: ($root.alwaysShowLoadingSpinner() || $root.inprogress() || !visible()), style: $root.loadingOverlayStyle($data)"" style="width: 850px; height: 1100px;position: absolute;left:0;top:0">           <div class="loading_overlay_message">               <span class="progresspin"></span>               <p data-localize="LoadingYourContent">Loading your content...</p>           </div>       </div>'+(f?h:'           <div class="highlight-pane"></div>           <div class="search-pane"></div>           <img class="page-image" src="'+b.emptyImageUrl+'" data-bind="attr: { id: \''+b.docViewerId+"' + '-img-' + ($index() + 1), src: (visible() ? url : $root.emptyImageUrl) },            style: { width: $parent.pageWidth() + 'px', height: $parent.pageWidth() * $data.prop() + 'px' }\"/>")+'   </div><!-- /ko --></div><div class="tab_control_wrapper" data-bind="visible: useTabsForPages && tabs().length > 0"><ul class="doc_viewer_tab_control" data-bind="foreach: tabs, visible: useTabsForPages && tabs().length > 0">   <li data-bind="css:{active:$index() == $root.activeTab()}">      <a href="#" data-bind="text:name, click: function(){$root.activateTab($index());}"></a>   </li></ul></div>';return i},initializationComponent:function(a){return'<div dir="ltr" class="groupdocs_viewer_wrapper grpdx '+a.classWithNumber+'"><div class="viewer_header header_sidescroll" '+a.headerStyle+'>   <div class="viewer_header_wrapper">      <a class="btnOpen new_head_tools_btn h_t_i_browser" data-tooltip="Open File" data-localize-tooltip="OpenFile"></a>      <div name="printAndDownloadToolbar" class="new_head_tools_wrapper left">          <a class="new_head_tools_btn h_t_i_download btn_download" data-tooltip="Download" data-localize-tooltip="Download"></a>          <a class="new_head_tools_btn h_t_i_print print_button" data-tooltip="Print" data-localize-tooltip="Print"></a>      </div>      <div class="navigation-bar left'+(a.browserIsIE8?" ie8":"")+'">      </div>      <div class="new_head_tools_wrapper zoom_wrappper">      </div>      <div class="new_head_tools_dropdown_wrapper viewTypeMenu">\t\t\t<a class="new_head_tools_btn head_tool_dropdown_btn h_t_i_singlepage" data-bind="click: toggleDropDownMenu" href="#" data-tooltip="View Mode" data-localize-tooltip="ViewMode"></a>\t\t\t<ul class="dropdown-menu head_tool_dropdown" style="display: none;" data-bind="style: {display: (dropDownMenuIsVisible() ? \'block\' : \'none\')}">\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openScrollView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_scroll"></span>\t\t\t\t\t\t<p data-localize="ScrollView">Scroll View</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li style="display: inline" name="openDoublePageFlipViewMenuItem">\t\t\t\t\t<a data-bind="click: openDoublePageFlipView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_double"></span>\t\t\t\t\t\t<p data-localize="BookMode">Double Page Flip</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openOnePageInRowView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_scroll"></span>\t\t\t\t\t\t<p data-localize="OnePageInRow">One Page in Row</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openTwoPagesInRowView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_double"></span>\t\t\t\t\t\t<p data-localize="TwoPagesInRow">Two Pages in Row</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t\t<li style="display: inline">\t\t\t\t\t<a data-bind="click: openCoverThenTwoPagesInRowView" href="#">\t\t\t\t\t\t<span class="h_t_d_i_double"></span>\t\t\t\t\t\t<p data-localize="CoverThenTwoPagesInRow">Cover then Two Pages in Row</p>\t\t\t\t\t</a>\t\t\t\t</li>\t\t\t</ul>\t\t</div>      <div name="search_wrapper" class="new_head_tools_wrapper" data-bind="visible:visible">      </div>'+(a.supportPageRotation?'<div class="new_head_tools_wrapper">      <a name="rotateClockwise" class="h_t_i_rotatecl new_head_tools_btn" data-tooltip="Rotate Clockwise" data-localize-tooltip="RotateClockwise"></a>      <a name="rotateCounterClockwise" class="h_t_i_rotatecon new_head_tools_btn" data-tooltip="Rotate Counter-Clockwise" data-localize-tooltip="RotateCounterClockwise"></a></div>':"")+'   </div></div><div class="fileOpenDialogWrapper" style="display: none"></div><div class="viewer_mainwrapper '+a.browserDependentCssClass+'">   <div id='+a.docViewerId+' class="doc_viewer" data-ng-scrollable data-bind="event: { scroll: function(item, e) { this.ScrollDocView(item, e); }, scrollstop: function(item, e) { this.ScrollDocViewEnd(item, e);e.returnValue = false;return true; } }">   </div>   <div class="doc_viewer_wrapper_page_flip" style="overflow: auto; top: -50000px; position: absolute;height: 100%">   </div>'+(a.showThumbnails?'   <a class="thumbs_btn" href="#"></a>':"")+'</div><div name="jGDerror" class="modal_dialog_wrapper jerrorwrapper">   <div class="modal_dialog_overlay">       &nbsp;   </div>   <div class="modal_dialog_content_wrapper">       <div class="modal_dialog_header">          Error       </div>       <div class="modal_dialog_content">       </div>   </div></div><div name="messageDialog" class="modal_dialog_content_wrapper modal_progressbar" style="display:none">   <a name="minimizeButton" class="icon_minimize" href="#">&ndash;</a>   <a name="maximizeButton" class="icon_maximize" href="#">+</a>   <div class="modal_dialog_header">      <span name="alwaysVisibleTitle">Printing </span>      <span name="visibleWhenMinimizedTitle" class="percent">0%</span>   </div>   <div class="modal_dialog_content">      <p name="message">Preparing page </p>      <div class="progressbar">      <div style="width: 50%" class="progress"></div></div>   </div></div><div name="messageDialogPdf" class="modal_dialog_content_wrapper modal_progressbar" style="display:none">   <a name="minimizeButtonPdf" class="icon_minimize" href="#">&ndash;</a>   <a name="maximizeButtonPdf" class="icon_maximize" href="#">+</a>   <div class="modal_dialog_header">      <span name="alwaysVisibleTitlePdf">Printing </span>   </div>   <div class="modal_dialog_content">      <p name="messagePdf">Preparing page </p>   </div></div></div>'},navigation:function(){return'<span class="new_head_tools_btn h_t_i_nav1" data-bind="click: function() { selectPage(1); }, css: {disabled: pageInd() <= 1}" data-tooltip="First Page" data-localize-tooltip="FirstPage"></span><span class="new_head_tools_btn h_t_i_nav2" data-bind="click: up, css: {disabled: pageInd() <= 1}" data-tooltip="Previous Page" data-localize-tooltip="PreviousPage"></span><input class="new_head_input" type="text" style="width: 17px;" data-bind="value: pageInd, valueUpdate: [\'afterkeydown\'], event: { keyup: onKeyPress }" /><p class="new_head_of" data-localize="Of">of</p><p class="new_head_of" data-bind="text: pageCount()"></p><span class="new_head_tools_btn h_t_i_nav3" data-bind="click: down, css: {disabled: pageInd() >= pageCount()}" data-tooltip="Next Page" data-localize-tooltip="NextPage"></span><span class="new_head_tools_btn h_t_i_nav4" data-bind="click: function() { selectPage(this.pageCount()); }, css: {disabled: pageInd() >= pageCount()}" data-tooltip="Last Page" data-localize-tooltip="LastPage"></span>'},search:function(){return'<input type="text" placeholder="Search" class="input_search" data-localize-ph="Search" data-bind="visible: visible, attr: {dir: useRtl ? \'rtl\' : \'ltr\'}, value: searchValue, valueUpdate: [\'afterkeydown\', \'propertychange\', \'input\'], event: { keypress: keyPressed, keydown: keyDown }"><span class="input_search_clear" data-bind="visible: visible, click: function(){$root.clearValue();}, clickBubble: false"></span><span class="new_head_tools_btn h_t_i_nav2" data-bind="visible: visible, click: findPreviousFromUI, css:{disabled:!previousEnabled()}" data-tooltip="Search Backward" data-localize-tooltip="SearchBackward"></span><span class="new_head_tools_btn h_t_i_nav3" data-bind="visible: visible, click: findNextFromUI, css:{disabled:!nextEnabled()}" data-tooltip="Search Forward" data-localize-tooltip="SearchForward"></span>'},fileBrowser:function(){return'<div class="modal_inner_wrapper"><div data-dismiss="modal" class="popclose"></div><div class="modal_header">   <h3 data-localize="OpenFile">Open File</h3></div><div class="modal_content"><div class="modal_input_wrap_left"><div class="file_browser_content"><div style="position: relative; display: inline-block; overflow: hidden;" class="file_browser_toolbar"><!-- ko with: isNotRootFolder --><a data-bind="click: function () { $parent.openParentFolder();}" data-localize="ParentFolder" class="small_button file_browser_upload_btn">Parent folder</a><!-- /ko --></div><div style="position: relative;"><div style="position: relative;"></div><div class="file_browser_sort"><a class="file_browser_sort_filename" data-bind="click: function() { setOrder(\'Name\');}" href="#"><h4 data-localize="FileName">File Name</h4><span data-bind="visible: orderBy() === \'Name\', css: {up: orderAsc(), down: !orderAsc()}" class="smallarrow"></span></a><a class="file_browser_sort_size" data-bind="click: function() { setOrder(\'Size\');}" href="#"><h4 data-localize="Size">Size</h4><span data-bind="visible: orderBy() === \'Size\', css: {up: orderAsc(), down: !orderAsc()}" class="smallarrow"></span></a><a class="file_browser_sort_modified" data-bind="click: function() { setOrder(\'ModifiedOn\');}" href="#"><h4 data-localize="Modified">Modified</h4><span data-bind="visible: orderBy() === \'ModifiedOn\', css: {up: orderAsc(), down: !orderAsc()}" class="smallarrow"></span></a></div><ul data-bind="foreach: folders" class="file_browser_folder_list"><li data-bind="attr: { id: \'explorer-entity-\' + id }, click: open"><div class="file_browser_listbox folderlist"><span class="listicons licon_folder"></span><p data-bind="text: name()" class="listname_file_browser foldername"></p></div></li></ul><ul data-bind="foreach: files" class="file_browser_file_list"><li data-bind="attr: { id: \'explorer-entity-\' + id }, click: open"><div class="file_browser_listbox filelist"><span data-bind="css: { \'licon_unkwn\': (docType() != \'words\' && docType() != \'pdf\' &&  docType() != \'slides\' &&docType() != \'cells\' && docType() != \'image\' && docType() != \'email\' && docType() != \'diagram\' && docType() != \'project\' && docType() != \'taggedimage\'), \'licon_word\': docType() == \'words\', \'licon_pdf\': docType() == \'pdf\', \'licon_ppt\': docType() == \'slides\', \'licon_xls\': docType() == \'cells\', \'licon_bmp\': (docType() == \'image\' || docType() == \'taggedimage\'), \'licon_outlook\': docType() == \'email\', \'licon_visio\': docType() == \'diagram\', \'licon_mpp\': docType() == \'project\' }" class="listicons"></span><p data-bind="text: name()" class="listname_file_browser filenameellipses"></p><p data-bind="text: (sizeInKb() + \'Kb\')" class="listfilesize listsmalltext"></p><p data-bind="text: modifiedOn()" class="listfilesize listsmalltext"></p></div></li></ul></div></div></div></div><div class="modal_footer"><div class="modal_btn_wrapper"></div></div></div>'},thumbnails:function(c){var e=c.element,b={},d;if(c.supportPageReordering)d="foreach: thumbnails, sortableArray: thumbnails";else d="foreach: thumbnails";b.element=a('<div class="thumbnailsContainer" data-bind="event: { scroll: function(e) { scrollThumbnailsPanel(e); } }, visible: openThumbnails"><ul class="vertical-list2 ui-selectable" data-bind="'+d+'"><li class="thumb-page ui-selectee" data-bind="style: {height: $data.wrapperHeight + \'px\'}, css: { \'ui-selected\': ($index() + 1) == $root.pageInd() }, click: function() { $root.selectPage($index() + 1); }">'+(c.useHtmlThumbnails?"<div class=\"thumbnail_wrapper\" data-bind=\"style: {width:$data.width() + 'px',height: $data.height() + 2 * $data.verticalPadding() + 'px'}\"><div class=\"html_page_contents\"data-bind=\"html: htmlContent, visible: visible(),attr: {id: $root.docViewerId + 'pageHtml-' + ($index() + 1) },style: { padding: $data.verticalPadding() + 'px 0', MozTransform: 'scale(' + $data.scale() + ')', '-webkit-transform': 'scale(' + $data.scale() + ')','-ms-transform': 'scale(' + $data.scale() + ')' }\"></div><div class=\"html_page_contents mouse_intercept_overlay\"></div>":'<div class="thumbnail_wrapper" data-bind="style: {height: $data.height() + 2 * $data.verticalPadding() + \'px\'}"><img class="ui-selectee thumb_image" src="'+c.emptyImageUrl+"\" data-bind=\"attr: {src: visible() ? url() : $root.emptyImageUrl}, style: {width: (visible() ? $data.width() : 0) + 'px', height: (visible() ? $data.height() : 0) + 'px', padding: $data.verticalPadding() + 'px 0', backgroundColor: $data.backgroundColor()}\" />")+'</div><span class="progresspin thumb_progress"></span></li></ul></div>');if(c.useInnerThumbnails){b.thumbnailPanelElement=a('<div class="thumbnail_panel"></div>');b.element.appendTo(b.thumbnailPanelElement);b.toggleThumbnailsButton=a('<div class="thumbnail_stripe"><a class="thumbnail_open" data-bind="click:function(){toggleThumbnails();}"></a></div>');b.toggleThumbnailsButton.appendTo(b.thumbnailPanelElement);b.thumbnailPanelElement.prependTo(e)}else b.element.appendTo(e);b.rootElement=e;return b}}})})(jQuery);var dateFormat=function(){var b=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,c=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,a=function(a,b){a=String(a);for(b=b||2;a.length<b;)a="0"+a;return a};return function(e,g,k){var i=dateFormat;arguments.length==1&&Object.prototype.toString.call(e)=="[object String]"&&!/\d/.test(e)&&(g=e,e=void 0);e=e?new Date(e):new Date;if(isNaN(e))throw SyntaxError("invalid date");g=String(i.masks[g]||g||i.masks["default"]);g.slice(0,4)=="UTC:"&&(g=g.slice(4),k=true);var f=k?"getUTC":"get",j=e[f+"Date"](),n=e[f+"Day"](),l=e[f+"Month"](),o=e[f+"FullYear"](),h=e[f+"Hours"](),p=e[f+"Minutes"](),q=e[f+"Seconds"](),f=e[f+"Milliseconds"](),m=k?0:e.getTimezoneOffset(),r={d:j,dd:a(j),ddd:i.i18n.dayNames[n],dddd:i.i18n.dayNames[n+7],m:l+1,mm:a(l+1),mmm:i.i18n.monthNames[l],mmmm:i.i18n.monthNames[l+12],yy:String(o).slice(2),yyyy:o,h:h%12||12,hh:a(h%12||12),H:h,HH:a(h),M:p,MM:a(p),s:q,ss:a(q),l:a(f,3),L:a(f>99?Math.round(f/10):f),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:k?"UTC":(String(e).match(c)||[""]).pop().replace(d,""),o:(m>0?"-":"+")+a(Math.floor(Math.abs(m)/60)*100+Math.abs(m)%60,4),S:(["th","st","nd","rd"])[j%10>3?0:(j%100-j%10!=10)*j%10]};return g.replace(b,function(a){return a in r?r[a]:a.slice(1,a.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:"Sun,Mon,Tue,Wed,Thu,Fri,Sat,Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),monthNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec,January,February,March,April,May,June,July,August,September,October,November,December".split(",")};Date.prototype.format=function(a,b){return dateFormat(this,a,b)};(function(a){"use strict";a.groupdocsWidget("groupdocsFileOpenDialog",{_viewModel:null,options:{autoOpen:true,url:"",uploadWebFiles:false,fileTypes:"doc,docx,docm,dot,dotx,dotm,rtf,odt,ott,pdf",resourcePrefix:""},_create:function(){this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this._createHtml();this.fileExplorer=this.element.find(".file_browser_content");this._viewModel=this.getViewModel()},_init:function(){},_createHtml:function(){var a=this.element;a.addClass("modal fade modal2 modal800px");this.bindingProvider.createHtml("fileBrowser",this.element,this.options);a.trigger("onHtmlCreated")},_createViewModel:function(){var e=this.options.hostUrl,d=this.options.userId,c=this.options.userKey,b=a(this.fileExplorer).groupdocsExplorer({userId:d,privateKey:c,pageSize:30,fileTypes:this.options.fileTypes,urlHashEnabled:this.options.urlHashEnabled,instanceIdToken:this.options.instanceIdToken});return new fileOpenDialogViewModel(this,b)},getViewModel:function(){if(!this._viewModel)this._viewModel=this._createViewModel();return this._viewModel},destroy:function(){a.Widget.prototype.destroy.call(this)}})})(jQuery);(function(a){"use strict";window.fileOpenDialogViewModel=function(a,b){this.fileOpenDialog=a;this.fileExplorer=b;this._init()};a.extend(fileOpenDialogViewModel.prototype,{_explorerViewModel:null,_init:function(){this.fileExplorer.bind("onNodeSelected",this._onExplorerNodeSelected.bind(this));this._explorerViewModel=a(this.fileExplorer).groupdocsExplorer("getViewModel")},_onExplorerNodeSelected:function(c,b){b.id>0&&b.type==="file"&&a(this.fileOpenDialog.fileExplorer).trigger("fileSelected",b)}})})(jQuery);(function(a,b){"use strict";a.groupdocsWidget("groupdocsExplorer",{_viewModel:null,_init:function(){this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this._viewModel=this.getViewModel();a(this._viewModel).bind("onNodeSelected",function(d,c,b){a(this.element).trigger("onNodeSelected",[c,b])}.bind(this));this.bindingProvider.applyBindings(this._viewModel,this.element)},_createViewModel:function(){return new window.groupdocs.explorerViewModel(this.options)},getViewModel:function(){if(!this._viewModel)this._viewModel=this._createViewModel();return this._viewModel},setFilter:function(a){this._viewModel.setFilter(a)},setOrder:function(a){this._viewModel.setFilter(a)}});window.groupdocs.explorerModel=function(b){a.extend(this.options,b);this._init()};a.extend(window.groupdocs.explorerModel.prototype,{_portalService:Container.Resolve("ServerExchange"),_path:"",_entitiesLoaded:0,_entitiesTotal:0,_filter:{name:"",types:null},options:{pageSize:30,extended:false},_order:null,_init:function(){this.bindingProvider=this.options.bindingProvider;this._order={by:"Name",asc:true}},_loadPage:function(b,c,d,a){this._portalService.loadFileBrowserTreeData(c,b?b:0,this.options.pageSize,this._order.by,this._order.asc,this._filter.name,this._filter.types,this.options.extended,this.options.instanceIdToken,function(b){if(b.textStatus==="success"){this._entitiesLoaded+=b.data.nodes.length;this._entitiesTotal=b.data.count;d.apply(this,[c,b.data.nodes])}else a.apply(this,[])}.bind(this),function(b){a.apply(this,[b])}.bind(this))},openFolder:function(c,b,a){this._path=c||"";this._entitiesLoaded=0;this._entitiesTotal=0;this._loadPage(0,this._path,b,a)},loadMore:function(b,a){if(this._entitiesLoaded>=this._entitiesTotal)return false;var c=Math.ceil(this._entitiesLoaded/this.options.pageSize);this._loadPage(c,this._path,b,a);return true},setFilter:function(a){this._filter.name=a.name;this._filter.types=a.types},setOrder:function(b,a){this._order.by=b;this._order.asc=a}});window.groupdocs.explorerViewModel=function(a){this._init(a)};a.extend(window.groupdocs.explorerViewModel.prototype,{_model:null,_filtering:false,_ordering:false,busy:null,path:null,entities:null,files:null,folders:null,_order:null,_init:function(a){this._model=this._createModel(a);this.bindingProvider=a.bindingProvider;this.busy=this.bindingProvider.getObservable(false);this.path=this.bindingProvider.getObservable("");this.entities=this.bindingProvider.getObservableArray();this.files=this.bindingProvider.getObservableArray();this.folders=this.bindingProvider.getObservableArray();this.path=this.bindingProvider.getObservable("");this.entities=this.bindingProvider.getObservableArray();this.files=this.bindingProvider.getObservableArray();this.folders=this.bindingProvider.getObservableArray();this._order={by:this.bindingProvider.getObservable("Name"),asc:this.bindingProvider.getObservable(true)};this._model.setOrder(this._order.by(),this._order.asc());var b=this;this.isNotRootFolder=this.bindingProvider.getComputedObservable(function(){return!(b.path()==="")});this.openFolder(a.startupPath)},_createModel:function(a){return new window.groupdocs.explorerModel(a)},_addRoot:function(){var a=this._createEntity("Home","folder");a.path="";this.entities.push(a);return a},_onEntitiesLoaded:function(f,g){var b=this;if(b._filtering||b._ordering||f!=b.path()){b.entities.removeAll();b.files.removeAll();b.folders.removeAll()}var c=[],e=[],d=[];a.each(g,function(){if(!this.extended){var a=this;b._extendEntity(a);c.push(a)}if(this.type=="file")e.push(this);else d.push(this)});b.entities(c);b.files(e);b.folders(d);b._filtering=false;b._ordering=false;b.path(f);b.busy(false)},_onNetworkError:function(a){this.busy(false);jerror(a.Reason||a)},_extendEntity:function(b){var c=this,d=b.supportedTypes?a.map(b.supportedTypes,function(a){return a.toUpperCase()}):[];a.extend(b,{extended:true,name:c.bindingProvider.getObservable(b.name),isNewVersion:false,sizeInKb:c.bindingProvider.getObservable(Math.round(b.size/1024)),docType:c.bindingProvider.getObservable(b&&b.docType?b.docType.toLowerCase():""),modifiedOn:function(){return isNaN(b.modifyTime)||b.modifyTime<0?"---":(new Date(b.modifyTime)).format("mmm dd, yyyy")},supportedTypes:c.bindingProvider.getObservableArray(d),thumbnail:c.bindingProvider.getObservable(b.thumbnail),selected:c.bindingProvider.getObservable(false),isVisible:c.bindingProvider.getObservable(true)});b.open=function(d){if(b.type==="file")a(c).trigger("onNodeSelected",[b,d]);else c.openFolder(b.path)}},_findEntity:function(c,d){for(var b=0;b<this.entities().length;b++){var a=this.entities()[b];if(a.name().toLowerCase()==c.toLowerCase()&&a.type==d)return a}return null},_findEntityAt:function(c,d){for(var b=0;b<this.entities().length;b++){var a=this.entities()[b];if(a.path().toLowerCase()==c.toLowerCase()&&a.type==d)return a}return null},_createEntity:function(c,f,e,d){var a={id:0,path:(this.path().trim("/")+"/"+(d?d:c)).trim("/"),name:c,type:f,docType:"undefined",time:(new Date).getTime(),modifyTime:(new Date).getTime(),url:b,isKnown:false,fileCount:0,folderCount:0,supportedTypes:[],selected:false,size:e};this._extendEntity(a);return a},_getPathLevel:function(a){return a&&a.length>0?a.length-a.replace(/\/+/g,"").length+1:0},getSelectedEntities:function(){return a.map(this.entities(),function(a){if(a.id&&a.selected())return a})},openFolder:function(a){if(this.busy())return;this.busy(true);this._model.openFolder(a,this._onEntitiesLoaded.bind(this),this._onNetworkError.bind(this))},openParentFolder:function(){var b=this.path().lastIndexOf("/"),a=this.path().substr(0,b>0?b:0);a!=this.path()&&this.openFolder(a)},loadMore:function(){!this.busy()&&this.busy(this._model.loadMore(this._onEntitiesLoaded.bind(this),this._onNetworkError.bind(this)));return this.busy()},entityExists:function(a,b){return this._findEntity(a,b)!=null},setFilter:function(a){this._filtering=true;this._model.setFilter(a);this.openFolder(this.path())},setOrder:function(a){this._ordering=true;if(this._order.by()==a){var b=!this._order.asc();this._order.asc(b)}else{this._order.asc(true);this._order.by(a)}this._model.setOrder(this._order.by(),this._order.asc());this.openFolder(this.path())},orderBy:function(){return this._order.by()},orderAsc:function(){return this._order.asc()},findEntity:function(a,b){return this._findEntity(a,b)}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("navigation",{_viewModel:null,_pageCount:0,_create:function(){this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;if(this.options.createHtml)this._createHtml();else this.options.createEmbeddedHtml&&this._createEmbeddedHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},_createViewModel:function(){var a={pageInd:this.bindingProvider.getObservable(0),pageCount:this.bindingProvider.getObservable(0)};a.up=function(){this.up()}.bind(this);a.down=function(){this.down()}.bind(this);a.selectPage=function(a){this.set(a)}.bind(this);a.onKeyPress=function(b,a){this.onKeyPress(a);return true}.bind(this);a.setPageIndex=function(a){this.setPageIndex(a)}.bind(this);a.openFirstPage=function(){this.set(1)}.bind(this);a.openLastPage=function(){this.set(this._viewModel.pageCount())}.bind(this);a.setPagesCount=function(a){this.setPagesCount(a)}.bind(this);return a},getViewModel:function(){if(!this._viewModel)this._viewModel=this._createViewModel();return this._viewModel},up:function(){var c=this._viewModel.pageInd(),d=this._viewModel.pageCount(),b;if(c<=0)b=1;else if(c>d)b=d;else b=c!=1?c-1:1;this._viewModel.pageInd(b);a(this.element).trigger("onUpNavigate",b)},down:function(){var b=this._viewModel.pageInd(),d=this._viewModel.pageCount(),c;if(b<=0)c=1;else if(b>d)c=d;else c=b!=d?parseInt(b)+1:b;this._viewModel.pageInd(c);a(this.element).trigger("onDownNavigate",c)},"set":function(e){var d=this._viewModel.pageInd(),b=this.setPageIndex(e),c="up";if(d>b)c="down";a(this.element).trigger("onSetNavigate",{pageIndex:b,direction:c})},setPageIndex:function(c){var a=Number(c),b=this._viewModel.pageCount();if(isNaN(a))a=1;else if(a<=0)a=1;else if(a>b)a=b;this._viewModel.pageInd(a);return a},openFirstPage:function(){this.selectPage(1)},openLastPage:function(){this.selectPage(this.pageCount())},onKeyPress:function(a){a.keyCode==13&&this.set(this._viewModel.pageInd())},setPagesCount:function(a){this._pageCount=a;this._viewModel.pageCount(a)},_createHtml:function(){var a=this.element;this.bindingProvider.createHtml("navigation",this.element,this.options);a.trigger("onHtmlCreated")}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("thumbnails",{_viewModel:null,options:{quality:null,supportPageRotation:false,emptyImageUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII="},_create:function(){this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.element=this.element;this.useHtmlThumbnails=this.options.useHtmlThumbnails;this.useHtmlBasedEngine=this.options.useHtmlBasedEngine;this.emptyImageUrl=this.options.emptyImageUrl;if(this.options.supportPageReordering)var a=this;this.options.createHtml&&this._createHtml();if(this.options.thumbnailWidth)this._thumbnailWidth=this.options.thumbnailWidth;this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.options.thumbnailPanelElement?this.options.thumbnailPanelElement:this.options.element)},_createViewModel:function(){return new window.groupdocs.thumbnailsViewModel(this.options)},getViewModel:function(){if(!this._viewModel)this._viewModel=this._createViewModel();return this._viewModel},_createHtml:function(){var a=this.bindingProvider.createHtml("thumbnails",this.element,this.options);this.options.element=a.element;this.options.thumbnailPanelElement=a.thumbnailPanelElement;this.options.toggleThumbnailsButton=a.toggleThumbnailsButton;this.options.rootElement=a.rootElement}});window.groupdocs.thumbnailsModel=function(a){this._create(a)};a.extend(window.groupdocs.thumbnailsModel.prototype,{_portalService:Container.Resolve("ServerExchange"),_create:function(a){this.options=a},retrieveImageUrls:function(c,b,f,e,a,d){this._portalService.getImageUrlsAsync(c,b,f,e,this.options.quality,false,null,null,null,null,this.options.ignoreDocumentAbsence,this.options.useHtmlBasedEngine,this.options.supportPageRotation,this.options.instanceIdToken,this.options.locale,function(b){a(b)}.bind(this),function(a){d(a)}.bind(this))}});window.groupdocs.thumbnailsViewModel=function(a){this._create(a)};a.extend(window.groupdocs.thumbnailsViewModel.prototype,{_pageCount:0,_documentPath:"",_heightWidthRatio:0,_thumbnailWidth:150,thumbnails:null,pageInd:null,pageCount:null,busy:null,_thumbnailHeight:null,useInnerThumbnails:false,openThumbnails:null,element:null,rootElement:null,thumbnailPanelElement:null,emptyImageUrl:null,scale:null,_create:function(a){this.options=a;this._init(a)},_init:function(a){this.bindingProvider=this.options.bindingProvider;this._model=new window.groupdocs.thumbnailsModel(a);this.thumbnails=this.bindingProvider.getObservableArray([]);this.pageInd=this.bindingProvider.getObservable(1);this.pageCount=this.bindingProvider.getObservable(0);this.busy=this.bindingProvider.getObservable(true);this._thumbnailHeight=this.bindingProvider.getObservable(201);this.useInnerThumbnails=a.useInnerThumbnails;this.openThumbnails=this.bindingProvider.getObservable(a.openThumbnails);this.element=a.element;this.rootElement=a.rootElement;this.thumbnailPanelElement=a.thumbnailPanelElement;this.emptyImageUrl=a.emptyImageUrl;if(this.useHtmlThumbnails)this.scale=this.bindingProvider.getObservable(0)},scrollThumbnailsPanel:function(a){this._onScrollThumbnailsPanel(a)},selectPage:function(a){this.set(a)},showThumbnails:function(c){for(var b,a=0;a<this.thumbnails().length;a++){b=this.thumbnails()[a];b.visible(c)}},hideThumbnails:function(){this.showThumbnails(false)},getThumbnailsPanelWidth:function(){var a=0;if(this.useInnerThumbnails)a=this.element.parent().width();return a},toggleThumbnails:function(){this.openThumbnails(!this.openThumbnails());if(this.useInnerThumbnails){var c=this.thumbnailPanelElement.children(".thumbnail_stripe").width(),b=parseInt(this.element.css("width")),d=1,a=c;if(this.openThumbnails())a+=b+d;this.rootElement.trigger("onResizeThumbnails",a)}},onProcessPages:function(c,B,u,x,o,y){this._documentPath=c.path?c.path:c.guid;this.pageCount(c.pageCount);var C=this._thumbnailWidth,w=false,f=null,h,i,e=null,z;if(c.documentDescription&&c.documentDescription.pages){w=true;f=c.documentDescription.pages;h=c.documentDescription.maxPageHeight;i=c.documentDescription.widthForMaxHeight;this._heightWidthRatio=parseFloat(h/i);e=h/i*this._thumbnailWidth;z=e/h/o;if(this.useHtmlThumbnails){this.getDocumentPageHtmlCallback=u;this.viewerViewModel=x;this.docViewerId=y;var v=this.element.width()}}for(var n=[],a,k,g,b,j,q=47,A=this.pageCount(),t,r,s,p,d=0;d<A;d++){a={number:d+1,busy:this.bindingProvider.getObservable(true),visible:this.bindingProvider.getObservable(false),url:this.bindingProvider.getObservable(this.emptyImageUrl)};if(d<f.length){t=f[d].w;r=f[d].h;var m=r/t,l=f[d].rotation;if(typeof l=="undefined")l=0;if(l%180!=0)m=1/m;g=this._thumbnailWidth;b=this._thumbnailWidth*m;if(b>e){s=e/b;b=e;g=this._thumbnailWidth*s}}else{g=this._thumbnailWidth;b=215}a.width=this.bindingProvider.getObservable(g);a.height=this.bindingProvider.getObservable(b);k=0;j="";if(b<q){k=((q-b)/2).toString();j="white"}a.verticalPadding=this.bindingProvider.getObservable(k);a.backgroundColor=this.bindingProvider.getObservable(j);a.wrapperHeight=e;a.scale=this.bindingProvider.getObservable(b/f[d].h/o);p=(v-g)/2;a.thumbLeftCoord=this.bindingProvider.getObservable(p);if(this.useHtmlThumbnails)a.htmlContent=B[d].htmlContent;n.push(a)}this.thumbnails(n);this.loadThumbnails()},loadThumbnails:function(){var a=Math.ceil(this.element.height()/parseInt(this._heightWidthRatio*150));this._countToShowOnThumbDiv=a;this._thumbsCountToShow=Number(a)+Math.ceil(Number(Number(a)/2));this.retrieveImageUrls(this.pageCount())},retrieveImageUrls:function(a){this._model.retrieveImageUrls(this._documentPath,this._thumbnailWidth,0,a,function(c){for(var b=0;b<a;b++)this.thumbnails()[b].url(c.data.image_urls[b]);this._onScrollThumbnailsPanel()}.bind(this),function(){for(var b=0;b<a;b++)this.makeThumbnailNotBusy(b)}.bind(this))},makeThumbnailNotBusy:function(b){var a=this.thumbnails()[b];a.busy(false)},_onScrollThumbnailsPanel:function(){for(var d=this.pageCount(),j=this._thumbnailWidth,b=this.element,c=b.children("ul").children("li.thumb-page:first").outerHeight(false),e=b.scrollTop(),i=b.height(),g=Math.floor(e/c),f=Math.floor((e+i)/c)+1,h=f<d-2?f+2:d,a=g;a<h;a++){this.useHtmlThumbnails&&this.getDocumentPageHtmlCallback.call(this.viewerViewModel,a);this.thumbnails()[a].visible(true)}},setThumbnailsScroll:function(f){var d=f.pi;if(this.pageInd()!=d){this.pageInd(d);!f.eventAlreadyRaised&&this.element.trigger("onSetThumbnailsScroll",d)}var e=this.element.offset().top,c=this.element.children("ul").children("li:nth-child("+this.pageInd()+")");if(c.length==0)return;var b=c.offset().top,h=b-a(window).height(),i=b+c.height()-e,g=this.element.scrollTop(),j=b-e;(h>0||i<0)&&this.element.scrollTop(g+j)},"set":function(b){this.pageInd(b);a(this.element).trigger("onSetThumbnails",b)},setPageWithoutEvent:function(a){this.pageInd(a)},setPagesCount:function(a){this._pageCount=a;this.pageCount(a)}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("zooming",{options:{zoomValues:[5,15,25,50,75,100,125,150,175,200,300,400,600]},_viewModel:null,_create:function(){this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.createHtml&&this._createHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},getViewModel:function(){if(this._viewModel)return this._viewModel;var b=a.extend({element:this.element},this.options),c=new window.groupdocs.zoomingViewModel(b);return c},_createHtml:function(){var a=this.element;this.bindingProvider.createHtml("zooming",this.element);a.trigger("onHtmlCreated")}});window.groupdocs.zoomingViewModel=function(b){a.extend(this,b);this._init(b)};a.extend(window.groupdocs.zoomingViewModel.prototype,{_model:null,zooms:null,_currentZoom:null,_currentZoomIndex:0,dropDownMenuIsVisible:null,dropDownMenuClicked:false,_init:function(c){this._currentZoom=this.bindingProvider.getObservable(100);this.zooms=this.bindingProvider.getObservableArray([]);this.dropDownMenuIsVisible=this.bindingProvider.getObservable(false);for(var a,b=c.zoomValues.length-1;b>=0;b--){a=c.zoomValues[b];this.zooms.push({name:a.toString()+"%",value:a});if(a==this._currentZoom())this._currentZoomIndex=this.zooms.length-1}this.setFitWidthZoom(100);this.setFitHeightZoom(100)},setFitWidthZoom:function(c){for(var e={name:"Fit Width",value:c,localizationKey:"FitWidth",fitWidth:true},d=false,b=this.zooms(),a=0;a<b.length;a++)if(b[a].fitWidth){b[a].value=c;d=true;break}!d&&this.zooms.push(e)},setFitHeightZoom:function(c){for(var e={name:"Fit Height",value:c,localizationKey:"FitHeight",fitHeight:true},d=false,a=this.zooms(),b=0;b<a.length;b++)if(a[b].fitHeight){a[b].value=c;d=true;break}!d&&a.push(e)},getZoom:function(){return this._currentZoom()},getFitWidthZoomValue:function(){for(var a,c=this.zooms(),b=0;b<c.length;b++){a=c[b];if(a.fitWidth)return a.value}},getFitHeightZoomValue:function(){for(var a,c=this.zooms(),b=0;b<c.length;b++){a=c[b];if(a.fitHeight)return a.value}},setZoom:function(c){var a=c.value,b=this._indexOfZoom(a);this._currentZoom(a);if(b>=0)this._currentZoomIndex=b;else this._currentZoomIndex=this._indexOfNearestZoom(a,false);this.element.trigger("onSetZoom",a);this.element.trigger("zoomSet.groupdocs",a)},setZoomWithoutEvent:function(b){var a=this._indexOfZoom(b);if(a>=0){this._currentZoom(b);this._currentZoomIndex=a}},zoomIn:function(){var b=false,a=this._currentZoomIndex,c=this.zooms();if(this._isFitToBounds()){a=this._indexOfNearestZoom(c[this._currentZoomIndex].value,true);b=a>=0}else if(this._currentZoomIndex>0){a=this._currentZoomIndex-1;b=true}if(b){this._currentZoomIndex=a;this._currentZoom(c[this._currentZoomIndex].value);this.element.trigger("onSetZoom",this._currentZoom());this.element.trigger("zoomSet.groupdocs",this._currentZoom())}},zoomOut:function(){var c=false,b=this._currentZoomIndex,a=this.zooms();if(this._isFitToBounds()){b=this._indexOfNearestZoom(a[this._currentZoomIndex].value,false);c=b>=0}else if(this._currentZoomIndex<a.length-1&&!(a[this._currentZoomIndex+1].fitWidth||a[this._currentZoomIndex+1].fitHeight)){b=this._currentZoomIndex+1;c=true}if(c){this._currentZoomIndex=b;this._currentZoom(a[this._currentZoomIndex].value);this.element.trigger("onSetZoom",this._currentZoom());this.element.trigger("zoomSet.groupdocs",this._currentZoom())}},_indexOfZoom:function(c){for(var b=this.zooms(),a=0;a<b.length;a++)if(b[a].value==c)return a;return-1},_indexOfNearestZoom:function(h,k){for(var i=this.zooms(),j=i.length-1,f=null,d=null,g=null,e=null,a,c,b=j;b>=0;b--){c=i[b];a=c.value;if(!c.fitWidth&&!c.fitHeight)if(a>h&&(f===null||a<f)){f=a;d=b}else if(a<h&&(g===null||a>g)){g=a;e=b}}return k?d===null?-1:d:e===null?-1:e},_isFitToBounds:function(){var a=this.zooms();return a[this._currentZoomIndex].fitWidth||a[this._currentZoomIndex].fitHeight},showDropDownMenu:function(a){this.dropDownMenuIsVisible(a)},toggleDropDownMenu:function(b,a){this.dropDownMenuIsVisible(!this.dropDownMenuIsVisible());this.dropDownMenuClicked=true;this.element.trigger("onMenuClicked");a&&a.stopPropagation()}})})(jQuery);(function(a,b){"use strict";a.groupdocsWidget("search",{_viewModel:null,options:{isCaseSensitive:false,searchForSeparateWords:false},_create:function(){a.extend(this.options,{element:this.element});this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.createHtml&&this._createHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},_init:function(){},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new c(this.options)},_createHtml:function(){this.bindingProvider.createHtml("search",this.element,this.options);var a=this.element;a.trigger("onHtmlCreated")}});var d=function(b){a.extend(this,b);this._init()};a.extend(d.prototype,{_init:function(){}});var c=function(b){a.extend(this,b);this._create(b)};a.extend(c.prototype,{searchValue:null,previousEnabled:null,nextEnabled:null,minAreaTopRelativeToBeginning:null,maxAreaTopRelativeToBeginning:null,searched:false,viewerIsScrolled:false,searchForward:false,closestArea:null,newHighlightedAreaLeftRelative:0,highlightAreas:null,sible:null,useHtmlBasedEngine:false,useCaseSensitiveSearch:false,useAccentInsensitiveSearch:false,viewerViewModel:null,pageNumberAttribute:"data-page-num",useRtl:false,searchPageAfterScrollingToIt:null,hitsOnAllPagesAreFound:false,_create:function(a){this._model=new d(a);this._init(a)},_init:function(){this.searchValue=this.bindingProvider.getObservable("");this.previousEnabled=this.bindingProvider.getObservable(true);this.nextEnabled=this.bindingProvider.getObservable(true);this.visible=this.bindingProvider.getObservable(this.searchIsVisible)},triggerSearchEvent:function(d,c,a,b){if(!this.searched){var e=this.searchValue();this.element.trigger("onPerformSearch",[e,d,c,a,b])}this.searched=true;return false},findClosestArea:function(f,I,G,F,ab,x){var V=this.searched;this.triggerSearchEvent(I,G,F,ab);var u=false,y=null,Z=null,X=null,r="current_search_highlight",j=null,fb,J,v,s,l,q;J=this.viewerViewModel.getVisiblePagesNumbers();v=J.start-1;s=J.end-1;if(this.useHtmlBasedEngine){if(this.useVirtualScrolling&&this.isWaitingForPageOpening&&x===b)return;this.isWaitingForPageOpening=false;if(this.highlightAreas==null||!this.hitsOnAllPagesAreFound||!V){this.highlightAreas=this.viewerElement.find(".search_highlight_html");this.hitsOnAllPagesAreFound=true;q=this.viewerViewModel.pageCount();for(var N=0;N<q;N++)if(!this.viewerViewModel.isPageVisible(N)){this.hitsOnAllPagesAreFound=false;break}this.hitsOnAllPagesAreFound&&this.sortHighlightedAreas()}if(this.useVirtualScrolling&&x!==b)this.highlightAreas=this.highlightAreas.filter("[data-page-num="+x+"]")}else if(this.highlightAreas==null||!V){this.highlightAreas=this.viewerElement.find(".search-pane > .search-highlight");this.sortHighlightedAreas()}var Q=this.highlightAreas;this.currentHighlightArea=this.highlightAreas.filter("."+r+",tspan[class*='"+r+"']");var d=null;if(this.currentHighlightArea.length>0){if(this.currentHighlightArea.is("[name*='search_highlight']")){j=this.currentHighlightArea.attr("name");this.currentHighlightArea=Q.filter("[name='"+j+"']")}u=true;y=this.currentHighlightArea.offset().left;Z=this.currentHighlightArea.offset().top;X=this.currentHighlightArea.height()}if(!this.pagesContainerElement)this.pagesContainerElement=this.viewerElement.find(".pages_container");var w=this.pagesContainerElement.offset().top,H=this.pagesContainerElement.offset().left,n,cb=this.viewerElement.scrollTop();n=Math.floor(this.getScrollTop(cb));var C=0,z=null,E,g,e=0,o=0,m=0;this.minAreaTopRelativeToBeginning=null;this.maxAreaTopRelativeToBeginning=null;this.minAreaLeftRelativeToBeginning=null;this.maxAreaLeftRelativeToBeginning=null;var M,L,A,K=true,c=this;if(this.useVirtualScrolling&&x!==b){this.sortHighlightedAreas();if(f)d=this.highlightAreas.first();else d=this.highlightAreas.last();o=d.offset().top-w;d=d.get(0)}else{var h;this.highlightAreas.each(function(k){if(u&&(!c.useHtmlBasedEngine||c.hitsOnAllPagesAreFound))if(this===c.currentHighlightArea.get(0)){var b;if(f){b=k+1;if(j!==null)for(;b<c.highlightAreas.length;b++)if(j!=a(c.highlightAreas.get(b)).attr("name"))break}else{b=k-1;if(j!==null)for(;b>=0;b--)if(j!=a(c.highlightAreas.get(b)).attr("name"))break}if(b>=c.highlightAreas.length)b=c.highlightAreas.length-1;else if(b<0)b=0;d=c.highlightAreas.get(b);h=a(d);E=h.offset().top;e=Math.floor(E-w);g=h.offset().left;m=g-H;o=e;c.minAreaTopRelativeToBeginning=a(c.highlightAreas.get(0)).offset().top;c.maxAreaTopRelativeToBeginning=a(c.highlightAreas.get(c.highlightAreas.length-1)).offset().top;return false}else return true;h=a(this);if(c.useHtmlBasedEngine&&u&&j==h.attr("name"))return;E=h.offset().top;e=Math.floor(E-w);g=h.offset().left;m=g-H;if(c.minAreaTopRelativeToBeginning==null||e==c.minAreaTopRelativeToBeginning&&m<c.minAreaLeftRelativeToBeginning)c.minAreaLeftRelativeToBeginning=m;if(c.maxAreaTopRelativeToBeginning==null||e==c.maxAreaTopRelativeToBeginning&&m>c.maxAreaLeftRelativeToBeginning)c.maxAreaLeftRelativeToBeginning=m;if(c.minAreaTopRelativeToBeginning==null||e<c.minAreaTopRelativeToBeginning){c.minAreaTopRelativeToBeginning=e;c.minAreaLeftRelativeToBeginning=m}if(c.maxAreaTopRelativeToBeginning==null||e>c.maxAreaTopRelativeToBeginning){c.maxAreaTopRelativeToBeginning=e;c.maxAreaLeftRelativeToBeginning=m}if(u){var l=Math.abs(e-n);if(l<1){A=Math.abs(g-y);if(A>=1&&(f&&g>y||!f&&g<y)&&(A<z||z===null)){d=h;z=A;o=e;K=false}}}if(z===null&&(f&&e>n||!f&&e<n)){var i=Math.abs(e-n);if(i>=1)if(i<C&&C-i>=1||K){d=h;C=i;o=e;K=false;if(f)M=g;else L=g}else if(Math.abs(i-C)<1){if(f&&g<M){M=g;d=h;o=e}if(!f&&g>L){L=g;d=h;o=e}}}})}var k,i;if(this.useHtmlBasedEngine&&this.useVirtualScrolling&&!d&&x===b){var R=this.viewerViewModel.pages(),S;if(f){l=this.viewerViewModel.lastVisiblePageForVirtualMode()+1;k=1}else{l=this.viewerViewModel.firstVisiblePageForVirtualMode()-1;k=-1}for(var t=l;f&&t<R.length||!f&&t>=0;t+=k){var W=R[t];if(W.parsedHtmlElement){S=W.parsedHtmlElement.find(".search_highlight_html");if(S.length>0){this.searchPageAfterScrollingToIt={searchForward:f,pageNumber:t};this.viewerViewModel.setPage(t+1);return}}}}var P=null,O=null;if(d){var B=a(d),p=parseInt(B.attr(this.pageNumberAttribute));q=p;if(p>s){l=s;k=1}else{l=v;k=-1}var T=true;if(this.useHtmlBasedEngine&&p!==null&&!(p>=v&&p<=s))for(i=l;i!=q;i+=k)if(!this.viewerViewModel.isPageVisible(i)){this.loadPagesOnOneLevel(i,f,I,G,F);T=false;break}if(T){if(B.is("[name*='search_highlight']")){j=B.attr("name");d=Q.filter("[name='"+j+"']")}else d=B;this.viewerElement[0].scrollTop=o;this.viewerIsScrolled=true;this.viewerElement.trigger("ScrollDocView",[null,{target:this.viewerElement[0]}]);this.viewerElement.trigger("ScrollDocViewEnd",[null,{target:this.viewerElement[0]}]);this.viewerIsScrolled=false;w=this.pagesContainerElement.offset().top;var D,U;if(this.currentHighlightArea.is("tspan")){D=this.currentHighlightArea.attr("class");U=D.replace(new RegExp("\\b"+r+"\\b"),"");this.currentHighlightArea.attr("class",U)}else this.currentHighlightArea.removeClass(r);if(d.is("tspan")){D=d.attr("class");d.attr("class",D+" "+r)}else d.addClass(r);var bb=d.offset().top,Y=bb-w;P=d.offset().left;O=P-H;n=Y}}else{if(f){k=1;l=s;q=this.viewerViewModel.pageCount()}else{k=-1;l=v;q=-1}if(this.useHtmlBasedEngine&&!(p>=v&&p<=s))for(i=l;i!=q;i+=k)if(!this.viewerViewModel.isPageVisible(i)){this.loadPagesOnOneLevel(i,f,I,G,F);break}}this.searchForward=f;if(!d&&u)d=this.currentHighlightArea;this.closestArea=d;this.newHighlightedAreaLeftRelative=O;var db=this.isPreviousEnabled(n);this.previousEnabled(db);var eb=this.isNextEnabled(n);this.nextEnabled(eb)},isPreviousEnabled:function(c){var a=this.getScrollTop(c);if(this.useHtmlBasedEngine)return!this.hitsOnAllPagesAreFound?true:!this.searched||this.nextElementExists(false);else{var b=this.minAreaTopRelativeToBeginning!=null&&(Math.floor(a)>Math.ceil(this.minAreaTopRelativeToBeginning)||Math.abs(a-this.minAreaTopRelativeToBeginning)<1&&this.newHighlightedAreaLeftRelative!==null&&this.newHighlightedAreaLeftRelative>this.minAreaLeftRelativeToBeginning);return!this.searched||b}},isNextEnabled:function(c){var a=this.getScrollTop(c);if(this.useHtmlBasedEngine)return!this.hitsOnAllPagesAreFound?true:!this.searched||this.nextElementExists(true);else{var b=this.maxAreaTopRelativeToBeginning!=null&&(Math.ceil(a)<Math.floor(this.maxAreaTopRelativeToBeginning)||Math.abs(a-this.maxAreaTopRelativeToBeginning)<1&&this.newHighlightedAreaLeftRelative!==null&&this.newHighlightedAreaLeftRelative<this.maxAreaLeftRelativeToBeginning);return!this.searched||b}},nextElementExists:function(d){var c=false,a=this.viewerElement.find(".current_search_highlight");if(a!=null&&a.attr("name")){var b=parseInt(a.attr("name").replace("search_highlight","")),e=d?b+1:b-1,f="search_highlight"+e.toString();if(!this.isExistsInHighlighted(f))c=true}return!c},isExistsInHighlighted:function(c){if(this.highlightAreas==null||this.highlightAreas.length<=0)return false;for(var b=false,a=0;a<this.highlightAreas.length;a++)if(this.highlightAreas[a].getAttribute("name")==c)b=true;return b},findPreviousFromUI:function(){this.findPrevious(this.isCaseSensitive,this.searchForSeparateWords,this.treatPhrasesInDoubleQuotesAsExactPhrases,this.useAccentInsensitiveSearch)},findNextFromUI:function(){this.findNext(this.isCaseSensitive,this.searchForSeparateWords,this.treatPhrasesInDoubleQuotesAsExactPhrases,this.useAccentInsensitiveSearch)},findPrevious:function(d,c,a,b){this.searchValue()!=""&&this.findClosestArea(false,d,c,a,b)},findNext:function(d,c,a,b){this.searchValue()!=""&&this.findClosestArea(true,d,c,a,b)},clearValue:function(){this.searchValue("");this.resetButtons();this.triggerSearchEvent()},resetButtons:function(){this.previousEnabled(true);this.nextEnabled(true);this.searched=false;this.highlightAreas=null},keyDown:function(b,a){(a.keyCode==8||a.keyCode==46)&&b.keyHandler(a.keyCode);return true},keyPressed:function(b,a){var c=a.which?a.which:a.keyCode;return b.keyHandler(c)},keyHandler:function(a){if(a===13){this.findNextFromUI();return false}this.previousEnabled(true);this.nextEnabled(true);this.searched=false;return true},scrollPositionChanged:function(a){if(this.searched&&!this.viewerIsScrolled){this.previousEnabled(this.isPreviousEnabled(a));this.nextEnabled(this.isNextEnabled(a))}},showControls:function(){this.visible(this.searchIsVisible)},hideControls:function(){this.visible(false)},documentLoaded:function(){this.resetButtons();this.searched&&this.element.trigger("onPerformSearch","")},loadPagesOnOneLevel:function(b,m,l,k,j){for(var i=this,d=[],c=this.viewerViewModel.getPageLocations(),f=this.viewerViewModel.pageWidth(),e=this.viewerViewModel.pages(),g=c[b].y+f*e[b].prop,a=b+1;a<c.length;a++)if(Math.abs(c[a].y+f*e[a].prop-g)<2)d.push(a);else break;for(a=b-1;a>=0;a--)if(Math.abs(c[a].y+f*e[a].prop-g)<2)d.push(a);else break;function h(){if(d.length==0)i.findClosestArea(m,l,k,j);else i.viewerViewModel.getDocumentPageHtml(d.pop(),h)}this.viewerViewModel.getDocumentPageHtml(b,h)},getScrollTop:function(b){var e=this.closestArea!=null,d,c;if(!this.pagesContainerElement)this.pagesContainerElement=this.viewerElement.find(".pages_container");var h=this.pagesContainerElement.offset().top,f=this.viewerElement.height(),i=b,g=b+f,a;if(e){d=this.closestArea.offset().top;c=this.closestArea.height();a=d-h;if(Math.ceil(a)+c>=i&&Math.floor(a)<=g)b=a}return b},documentPageSetHandler:function(){if(this.useVirtualScrolling&&this.searchPageAfterScrollingToIt){var a=this,b=this.searchPageAfterScrollingToIt.searchForward,c=this.searchPageAfterScrollingToIt.pageNumber;this.searchPageAfterScrollingToIt=null;this.isWaitingForPageOpening=true;window.setTimeout(function(){a.findClosestArea(b,a.isCaseSensitive,a.searchForSeparateWords,a.treatPhrasesInDoubleQuotesAsExactPhrases,a.useAccentInsensitiveSearch,c)},1e3)}},sortHighlightedAreas:function(){this.highlightAreas.sort(function(e,f){var c=a(f),b=a(e),d=Math.floor(b.offset().top)-Math.floor(c.offset().top);return Math.abs(d)>=1?d:b.offset().left-c.offset().left})}})})(jQuery);(function(a){"use strict";groupdocs.Point=function(a,b){this.x=a||0;this.y=b||0};a.extend(groupdocs.Point.prototype,{x:0,y:0,clone:function(){return new groupdocs.Point(this.x,this.y)},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}});groupdocs.Rect=function(b,d,c,e,a){this.set(b,d,c,e,a)};a.extend(groupdocs.Rect.prototype,{topLeft:null,bottomRight:null,clone:function(){return new groupdocs.Rect(this.topLeft.x,this.topLeft.y,this.bottomRight.x,this.bottomRight.y,false)},"set":function(b,d,c,e,a){if(!this.topLeft)this.topLeft=new groupdocs.Point;if(!this.bottomRight)this.bottomRight=new groupdocs.Point;this.topLeft.x=b;this.topLeft.y=d;this.bottomRight.x=c;this.bottomRight.y=e;return a?this.normalize():this},add:function(a){this.topLeft.x+=a.x;this.topLeft.y+=a.y;this.bottomRight.x+=a.x;this.bottomRight.y+=a.y;return this},subtract:function(a){this.topLeft.x-=a.x;this.topLeft.y-=a.y;this.bottomRight.x-=a.x;this.bottomRight.y-=a.y;return this},scale:function(a){this.topLeft.x*=a;this.topLeft.y*=a;this.bottomRight.x*=a;this.bottomRight.y*=a;return this},round:function(){this.topLeft=this.topLeft.round();this.bottomRight=this.bottomRight.round();return this},left:function(){return this.topLeft.x},top:function(){return this.topLeft.y},right:function(){return this.bottomRight.x},bottom:function(){return this.bottomRight.y},width:function(){return this.bottomRight.x-this.topLeft.x},height:function(){return this.bottomRight.y-this.topLeft.y},setLeft:function(a){this.topLeft.x=a},setTop:function(a){this.topLeft.y=a},setRight:function(a){this.bottomRight.x=a},setBottom:function(a){this.bottomRight.y=a},contains:function(a){return this.topLeft.x<=a.x&&a.x<=this.bottomRight.x&&this.topLeft.y<=a.y&&a.y<=this.bottomRight.y},includes:function(a){return this.contains(a.topLeft)&&this.contains(a.bottomRight)},intersects:function(a){return!(this.topLeft.x>a.bottomRight.x||this.bottomRight.x<a.topLeft.x||this.topLeft.y>a.bottomRight.y||this.bottomRight.y<a.topLeft.y)},normalize:function(){if(this.topLeft.x>this.bottomRight.x)this.bottomRight.x=([this.topLeft.x,this.topLeft.x=this.bottomRight.x])[0];if(this.topLeft.y>this.bottomRight.y)this.bottomRight.y=([this.topLeft.y,this.topLeft.y=this.bottomRight.y])[0];return this}})})(jQuery);(function(a){"use strict";if(!window.groupdocs)window.groupdocs={};window.groupdocs.JavaScriptDocumentDescriptionWrapper=function(b){this.options=a.extend(true,{},this.options,b);this.init()};a.extend(window.groupdocs.JavaScriptDocumentDescriptionWrapper.prototype,{documentDescription:null,options:{},init:function(){this.documentDescription=JSON.parse(this.options.documentDescription)},initWithOptions:function(a){this.options=a;this.init()},getPageCount:function(){return this.documentDescription.pages?this.documentDescription.pages.length:typeof this.documentDescription.pageCount!="undefined"?this.documentDescription.pageCount:0},getPageSize:function(){var b=this.documentDescription.widthForMaxHeight,a=this.documentDescription.maxPageHeight;if(typeof b==="undefined"||typeof a==="undefined")if(this.documentDescription.pages){var c=this.documentDescription.pages[0];b=c.w;a=c.h}else b=a=null;return{width:b,height:a}},getContentControls:function(){return this.documentDescription.contentControls},getBookmarks:function(){return this.documentDescription.bookmarks},getPages:function(h,a,d,f,k){if(!this.documentDescription.pages)return null;var g=[],m=0,b=this.documentDescription.pages.length;if(b>0&&a.length<b&&a.length<f-d+1)return null;var e=100,j=Math.ceil(b/e),l=h*this.documentDescription.widthForMaxHeight,n=0,c=function(u,i,g,o,r,w){for(var q=false,f=i*e;f<b&&f<(i+1)*e;f++){var h=this.documentDescription.pages[f],d;if(typeof o!=="undefined"){if(f<o)continue;if(f>r){q=true;break}d=a[f-o]}else d=a[f];var t=h.number;g=l/h.w;var k=h.rotation;if(typeof k=="undefined")k=0;var n=h.w,p=h.h;if(k%180!=0)g*=n/p;var x=this.getRows(h,t,g,m,d),v=d.x+n*g,s=d.y+p*g;switch(k){case 90:case 270:v=d.x+p*g;s=d.y+n*g}u.push({pageId:t,rows:x,rect:new groupdocs.Rect(d.x,d.y,v,s),originalWidth:n,rotation:h.rotation})}if(w)return q;i++;i<j&&!q&&window.setTimeout(function(){c(u,i,g,o,r)},10)}.bind(this);if(k||this.options.synchronousWork){for(var i=0;i<j;i++)if(c(g,i,h,d,f,true))break}else window.setTimeout(function(){c(g,n,h,d,f)},10);return g},getRows:function(c,o,b,l,d){var f=c.rotation,h=c.w,g=c.h,q=[];if(c.rows)for(var k=0;k<c.rows.length;k++){var a=c.rows[k],t=this.getWords(a,o,b,l,d,f,h,g),s=this.getChars(a,o,b,l,d,f,h,g),e=this.getRotatedtextCoordinates(f,h,g,a.l,a.t,a.w,a.h),i=e.left,j=e.top,n=e.width,m=e.height,u=i*b,v=j*b,p=u+d.x,r=v+d.y,x=n*b,w=m*b;q.push({text:a.s,words:t,chars:s,pageLocation:d,originalRect:new groupdocs.Rect(i,j,i+n,j+m),rect:new groupdocs.Rect(p,r,p+x,r+w)})}return q},getWords:function(e,y,d,x,i,p,r,q){var l=[],g=[],m=[],w=e.s.split(" ");g=a.map(e.c,function(a,b){if(b%2==0)return a;else m.push(a)});for(var b=0;b<g.length;b++){var c=this.getRotatedtextCoordinates(p,r,q,g[b],e.t,m[b],e.h),f=c.left,h=c.top,k=c.width,j=c.height,s=Math.round(f*d),t=Math.round(h*d),n=s+i.x,o=t+i.y,v=Math.round(k*d),u=Math.round(j*d);l.push({text:w[b],pageLocation:i,originalRect:new groupdocs.Rect(f,h,f+k,h+j),rect:new groupdocs.Rect(n,o,n+v,o+u)})}return l},getChars:function(a,A,f,z,k,r,t,s){var o=[],i=[],h=[],d=[],u=a.s.replace(/\s+/g,"");if(a.ch){for(var m=1,b=0;b<a.ch.length;b++){if(a.s.charAt(b+m)==" "){m++;d.push(true)}else b!=a.ch.length-1&&d.push(false);i.push(a.ch[b]);if(b<a.ch.length-1)h.push(a.ch[b+1]-a.ch[b]);else if(b==a.ch.length-1){d.push(true);h.push(a.w-a.ch[b])}}for(var c=0;c<i.length;c++){var e=this.getRotatedtextCoordinates(r,t,s,i[c],a.t,h[c],a.h),g=e.left,j=e.top,n=e.width,l=e.height,v=Math.round(g*f),w=Math.round(j*f),p=v+k.x,q=w+k.y,y=Math.round(n*f),x=Math.round(l*f);o.push({text:u.charAt(c),isLastWordChar:d[c],pageLocation:k,originalRect:new groupdocs.Rect(g,j,g+n,j+l),rect:new groupdocs.Rect(p,q,p+y,q+x)})}}return o},getRowCharacterCoordinates:function(b,c){return this.documentDescription.pages[b].rows[c].ch},reorderPage:function(b,c){var a=this.documentDescription.pages,d=a[b];a.splice(b,1);a.splice(c,0,d)},getRotatedtextCoordinates:function(k,j,i,g,h,b,a){var e=g,f=h,d=b,c=a;switch(k){case 90:e=i-h-a;f=g;d=a;c=b;break;case 180:e=j-g-b;f=i-h-a;d=b;c=a;break;case 270:e=h;f=j-g-b;d=a;c=b}return{left:e,top:f,width:d,height:c}}})})(jQuery);(function(a,b){"use strict";a.groupdocsWidget("groupdocsSelectable",{search:null,lasso:null,pages:[],searchProportions:1,highlightSearchPaneContainer:null,template:"<div id={0} class='highlight selection-highlight' style='top: {1}px; height: {2}px; width: {3}px; left: {4}px;'></div>",searchTemplate:"<div id={0} class='highlight search-highlight' style='top: {1}px; height: {2}px; width: {3}px; left: {4}px;'></div>",options:{appendTo:"body",txtarea:"",pdf2XmlWrapper:null,startNumbers:null,pagesCount:0,proportion:1,cancel:":input,option,.comment",bookLayout:false,docSpace:"",highlightColor:null},_initialized:false,_textSelectionByCharModeEnabled:false,_canvasOffset:null,_canvasScroll:null,_mouseStartPos:null,SelectionModes:{SelectText:0,SelectRectangle:1,SelectTextToStrikeout:2,ClickPoint:3,TrackMouseMovement:4,DoNothing:5},_mode:null,_lassoCssElement:null,parentElement:null,selectionCounter:0,_create:function(){this._initialized=false;this.initCanvasOffset();if(!this.options.initializeStorageOnly){this.dragged=false;if(this.options.preventTouchEventsBubbling){var b=function(a){a.preventBubble()};this.element.bind({touchstart:b,touchmove:b,touchend:b})}this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>");this.createEventHandlers();this.setMode(this.SelectionModes.SelectText);this.pagePrefix=this.options.pagePrefix}this.search=[]},createEventHandlers:function(){var b=this;a(document).keydown(function(d){if(d.keyCode==67&&d.ctrlKey){var c=a(document.activeElement),f=c.attr("id"),e=c.attr("name");if((f!==b.options.txtarea.attr("id")||e!==b.options.txtarea.attr("name"))&&(c.is("input")||c.is("textarea")))return;b.options.txtarea.focus().select()}});a(b.element).bind({click:function(a){return b.mouseClickHandler(a)}})},_init:function(){this._initialized=false;if(this.options.pdf2XmlWrapper==null)return;this.initStorage();this._initialized=false},destroy:function(){this._mouseDestroy();return this},initStorage:function(){if(this._initialized)return;this._initialized=true;this.pageLocations=this._getPageLocations();var a=this.pageLocations;if(this.options.pdf2XmlWrapper!=null)if(this.options.bookLayout)this.pages=this.options.pdf2XmlWrapper.getPages(this.options.proportion,a,this.options.startNumbers.start-1,this.options.startNumbers.end-1,this.options.useVirtualScrolling);else this.pages=this.options.pdf2XmlWrapper.getPages(this.options.proportion,a,0,this.options.pagesCount-1)},initCanvasOffset:function(){this.parentElement=this.options.docSpace.parent();var b=this.element.parent().offset(),c=b.left,a=b.top;if(this.options.bookLayout)a=this.parentElement.offset().top;this._canvasOffset=new groupdocs.Point(c,a)},_mouseInit:function(){var b=this;this.document=a(this.element.style?this.element.ownerDocument:this.element.document||this.element);this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(true===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){this._mouseMoved=false;this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var c=this,e=b.which===1,d=typeof this.options.cancel==="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:false;if(!e||d||!this._mouseCapture(b))return true;true===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return c._mouseMove(a)};this._mouseUpDelegate=function(a){return c._mouseUp(a)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return true},_mouseMove:function(b){if(this._mouseMoved)if(a.browser.msie&&(!document.documentMode||document.documentMode<9)&&!b.button)return this._mouseUp(b);else if(!b.which)return this._mouseUp(b);if(b.which||b.button)this._mouseMoved=true;if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==false;this._mouseStarted?this._mouseDrag(b):this._mouseUp(b);return!this._mouseStarted},_mouseUp:function(b){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",true);this._mouseStop(b)}return false},getPages:function(){this.initStorage();return this.pages},_getPageLocations:function(){var b=null;if(!this.options.bookLayout){b=a.map(this.options.pageLocations,function(a){return new groupdocs.Point(a.left,a.top())});return b}var c=this,e=this.options.docSpace.attr("id"),f=".page-image",d=this.element.find(f);if(this.options.bookLayout)d=d.filter("[id='"+e+"-img-"+this.options.startNumbers.start.toString()+"'],[id='"+e+"-img-"+this.options.startNumbers.end.toString()+"']");this._canvasScroll=this.getCanvasScroll();b=a.map(d,function(d){var b=a(d),e=b.offset().left-c._canvasOffset.x+c._canvasScroll.x,f=c.options.bookLayout?0:b.offset().top-c.element.offset().top;return new groupdocs.Point(e,f)});return b},getCanvasScroll:function(){return this.options.bookLayout?new groupdocs.Point(this.parentElement.scrollLeft(),this.parentElement.scrollTop()):new groupdocs.Point(this.element.parent().scrollLeft(),this.element.parent().scrollTop())},clearSelection:function(){this.element.find(".selection-highlight:not(.static)").remove()},clearSelectionOnPage:function(a){this.element.find("#"+this.pagePrefix+(a+1)+" > .highlight-pane > .selection-highlight:not(.static)").remove()},_mouseCapture:function(a){this._canvasScroll=this.getCanvasScroll();this._mouseStartPos=new groupdocs.Point(a.pageX-this._canvasOffset.x+this._canvasScroll.x,a.pageY-this._canvasOffset.y+this._canvasScroll.y);return this._mode!=this.SelectionModes.DoNothing&&this._findPageAt(this._mouseStartPos)!=null},_mouseStart:function(){this.setFocus();this.initStorage();this.clearSelection();if(this._mode==this.SelectionModes.DoNothing)return false;this.selectionCounter++;this._canvasScroll=this.getCanvasScroll();if(this.options.bookLayout)this._canvasScroll.y+=this.parentElement.parent().scrollTop();if(this.checkMouseIsInEdgeInBookMode(this._mouseStartPos.x,this._mouseStartPos.y))return false;this.element.append(this.helper);this.helper.css({left:this._mouseStartPos.x,top:this._mouseStartPos.y,width:0,height:0});this.options.txtarea.val("");this.lasso=new groupdocs.Rect},_mouseDrag:function(h){if(this._mode==this.SelectionModes.DoNothing||this.checkMouseIsInEdgeInBookMode(this._mouseStartPos.x,this._mouseStartPos.y))return false;var a=this._mouseStartPos.x,d=this._mouseStartPos.y,c=h.pageX-this._canvasOffset.x+this._canvasScroll.x,e=h.pageY-this._canvasOffset.y+this._canvasScroll.y,f=c,g=e;if(!this._findPageAt(new groupdocs.Point(f,g)))return false;this.dragged=true;if(a>c){var i=c;c=a;a=i}if(d>e){var i=e;e=d;d=i}this.lasso.set(a,d,c,e);this.helper.css({left:a,top:d,width:this.lasso.width(),height:this.lasso.height()});this.findSelectedPages(false,null,b,this.options.highlightColor);this.element.trigger("onMouseDrag",[{left:f,top:g}]);return false},_mouseStop:function(){if(this._mode==this.SelectionModes.DoNothing)return false;this.helper.remove();var l=this._findPageAt(this.lasso.topLeft)||this.pages[0];if(typeof l==="undefined")return false;var q,n=parseInt(l.pageId)-1,h=null;if(n<0)return false;if(this._mode==this.SelectionModes.SelectText){if(!this.dragged)return false;var o=this;this.dragged=false;var b=o._getDocumentHighlightRects();if(!b||b.length==0)return false;var g="",c=this.options.storeAnnotationCoordinatesRelativeToPages?this.convertRectToRelativeToPageUnscaledCoordinates(this.lasso):this.convertRectToAbsoluteCoordinates(this.lasso),m=c.top(),i=c.bottom();c=b[0].originalRect;var k=c.left(),j=c.right(),f=c.top(),e=c.bottom(),p=b[0].position,s=b[b.length-1].position+b[b.length-1].length-p;h=[];for(var d=0;d<b.length;d++){g+=b[d].text;g+=d>0&&(b[d-1].page!=b[d].page||b[d-1].row!=b[d].row)?"\r\n":" ";c=b[d].originalRect;h.push(c);k=Math.min(k,c.left());j=Math.max(j,c.right());f=Math.min(f,c.top());e=Math.max(e,c.bottom())}m=Math.min(f,m);i=Math.max(e,i);this.options.txtarea.val(a.trim(g))}return false},mouseClickHandler:function(){this.setFocus();return true},setFocus:function(){if(this.options.bookLayout)this.parentElement.focus();else this.options.docSpace.focus()},checkMouseIsInEdgeInBookMode:function(c,d){var f=this.element.width(),e=this.element.height(),b=100,a=100;return this.options.bookLayout&&(c>f-b&&d<a||c>f-b&&d>e-a||c<b&&d<a||c<b&&d>e-a)?true:false},convertRectToAbsoluteCoordinates:function(g,d){this.initStorage();var a=g.clone(),e=this.options.proportion,b=null;if(d)b=this._findPageNearby(d);else b=this._findPageNearby(a.topLeft);a.subtract(b.rect.topLeft);var f=parseInt(b.pageId)-1,c=f*this.options.pageHeight;c/=e;a.scale(1/e);a.add(new groupdocs.Point(0,c));return a},convertRectToScreenCoordinates:function(d){this.initStorage();var a=d.clone().scale(this.options.proportion);a.top()<0&&a.setTop(0);var b=this.options.pageHeight,c=Math.floor(a.top()/b);a.subtract(new groupdocs.Point(0,c*b));this.pages.length!=0&&a.add(this.pages[c].rect.topLeft);return a},convertRectToRelativeToPageUnscaledCoordinates:function(e,c){this.initStorage();var a=e.clone(),d=this.options.proportion,b=null;if(c)b=this._findPageNearby(c);else b=this._findPageNearby(a.topLeft);a.subtract(b.rect.topLeft);a.scale(1/d);return a},convertPageAndRectToScreenCoordinates:function(b,c){this.initStorage();var a=c.clone().scale(this.options.proportion);a.top()<0&&a.setTop(0);this.pages.length!=0&&a.add(this.pages[b].rect.topLeft);return a},setVisiblePagesNumbers:function(a){this.options.startNumbers=a},initHighlightSearchPaneContainer:function(){for(var a=this._getElementsByClassName("search-pane",document.getElementById(this.options.docSpace.attr("id")+"-pages-container")),c=a.length,b=c;b--;)if(a[b].children.length!=0)a[b].innerHTML="";this.highlightSearchPaneContainer=a},reInitPages:function(c,a,f,d,e,b){this._initialized=false;this.options.startNumbers=a;this.options.proportion=c;this.options.pageHeight=d;this.options.pageLocations=b;this.options.pagesCount=e;this.initCanvasOffset();this.initStorage()},changeSelectedRowsStyle:function(c){this.changeSearchStyle(c);var d=this.element.find(".highlight-pane .highlight"),b=c/this.options.proportion;this.options.proportion=c;a.each(d,function(){var c=a(this).position();a(this).css({top:c.top*b,left:c.left*b,width:a(this).width()*b,height:a(this).height()*b})})},performSearch:function(U,jb,H,E,O,C){var c,R=false;if(H)c=U;else c=U.toLowerCase();if(E&&O){var p=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");if(p.length>=2&&p[0]=='"'&&p[p.length-1]=='"'){E=false;c=p.substr(1,p.length-2);c=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");R=true}}this.search.length=0;this.initHighlightSearchPaneContainer();if(c=="")return-1;this.searchProportions=jb;var N=this.pages,kb=N.length,q=[],x=[],u=[],I,Z=0,t,P;if(C)P=new RegExp(window.groupdocs.stringExtensions.getAccentInsensitiveRegexFromString(c));for(var b,m=0;m<kb;m++){for(var fb=N[m].rows,lb=fb.length,mb=m+1,d,bb,v=0;v<lb;v++){var e=0,g=0,s=fb[v],r;if(H)r=s.text;else r=s.text.toLowerCase();if(E){u=this.getWords(c);if(C){for(var S=[],M=0;M<words.length;M++)S.push(new RegExp(window.groupdocs.stringExtensions.getAccentInsensitiveRegexFromString(u[M])));u=S}I=u.length;if(I==0)break;d=s.words;bb=d.length;for(var y,l=0;l<bb;l++)for(y=0;y<I;y++){var A=a.trim(u[y]),L=d[l].text;if(!H){A=A.toLowerCase();L=L.toLowerCase()}t=L.indexOf(A);if(t!=-1){for(var f=this.options.pdf2XmlWrapper.getRowCharacterCoordinates(m,v),i=d[l].originalRect.left(),w=0,h=0;h<f.length;h++){var F=f[h];if(Math.round(F)>=Math.round(i)){w=h;break}}var n=w+t;if(n<f.length)e=f[n];else e=i;if(e<i||e>K)e=i;j=n+A.length;if(j>=f.length)g=s.originalRect.right();else g=f[j];b=d[l].rect.clone();b.subtract(d[l].pageLocation);var B=this.options.proportion,db=e*B,cb=g*B;b.setLeft(db);b.setRight(cb);q.push(b);b=d[l].originalRect.clone();b.setLeft(e);b.setRight(g);x.push(b)}}}else{var gb=this.options.proportion*this.options.pdf2XmlWrapper.getPageSize().width,o;if(C)o=r.search(P);else o=r.indexOf(c);while(o!=-1){d=s.words;if(this.options.searchPartialWords){var Y=/\s/g,G=r.substring(0,o),ab=G.match(Y),X=c.match(Y),k=0,V=0;if(ab)k=ab.length;if(X)V=X.length;var z=k+V,f=this.options.pdf2XmlWrapper.getRowCharacterCoordinates(m,v),i=d[k].originalRect.left(),ib=d[z].originalRect.left(),K=d[z].originalRect.right(),eb=s.originalRect.right();t=G.length-G.lastIndexOf(" ")-1;for(var w=0,T=0,Q=false,h=0;h<f.length;h++){var F=f[h];if(!Q&&Math.round(F)>=Math.round(i)){w=h;Q=true}if(Math.round(F)>=Math.round(ib)){T=h;break}}var n=w+t;if(n<f.length)e=f[n];else e=i;if(e<i||e>K)e=i;var hb=c.lastIndexOf(" "),D=c.substring(hb+1,c.length),j;if(k==z)j=n+c.length;else j=T+D.length;var W=true;if(j<f.length){var J=d[z].text.toLowerCase();if(J.substring(J.length-D.length,J.length)==D)g=K;else{g=f[j];W=false}}else g=eb;if(g<e)g=eb;if(!O||!R||W){b=d[k].rect.clone();b.subtract(d[k].pageLocation);var B=gb/N[m].originalWidth,db=e*B,cb=g*B;b.setLeft(db);b.setRight(cb);q.push(b);b=d[k].originalRect.clone();b.setLeft(e);b.setRight(g);x.push(b)}o=r.indexOf(c,o+c.length)}}}}if(q.length>0){this.search.push({PageId:mb,pageWords:q.slice(0),pageWordsUnscaled:x.slice(0)});Z+=q.length;q.length=0;x.length=0}}this.highlightSearch(null,null);return Z},getWords:function(b){return a.map(b.split(" "),function(a){if(a!="")return a})},highlightSearch:function(g,h){if(!this.search)return;var f=this.search;this.initHighlightSearchPaneContainer();for(var e=0;e<f.length;e++){var d=f[e].PageId;if(g===null||h===null||d-1>=g&&d-1<=h)for(var c=f[e].pageWords,b=0;b<c.length;b++){var i=window.groupdocs.stringExtensions.format(this.searchTemplate,this.pagePrefix+d+"-search-highlight-"+b,c[b].top(),c[b].height(),c[b].width(),c[b].left());a("#"+this.pagePrefix+d+" div.search-pane").append(i)}}},changeSearchStyle:function(d){if(this.options.useVirtualScrolling||this.search.length==0)return;this.initHighlightSearchPaneContainer();for(var f=this.search,i=0,m=f.length,c=this.searchProportions,l=this.highlightSearchPaneContainer,e=0;e<m;e++){for(var h="",g=f[e].PageId,b=f[e].pageWords,k=b.length,a=0;a<k;a++){var q=Math.round(Math.round(b[a].width()/c)*d),n=Math.round(Math.round(b[a].height()/c)*d),p=Math.round(Math.round(b[a].top()/c)*d),o=Math.round((b[a].left()-i)/c*d+i),j=window.groupdocs.stringExtensions.format(this.searchTemplate,this.pagePrefix+g+"-search-highlight-"+a,p,n,q,o);h+=j}l[g-1].innerHTML=h}},recalculateSearchPositions:function(c){if(!this.options.useVirtualScrolling||this.search.length==0)return;this.initHighlightSearchPaneContainer();for(var h=this.search,l=h.length,d=0;d<l;d++)for(var g=h[d],b=g.pageWordsUnscaled,k=b.length,j,i,f,e,a=0;a<k;a++){e=Math.round(b[a].left()*c);j=Math.round(b[a].width()*c);f=Math.round(b[a].top()*c);i=Math.round(b[a].height()*c);g.pageWords[a].set(e,f,e+j,f+i)}},_getElementsByClassName:function(e,b){if(!b)b=document.getElementsByTagName("body")[0];for(var d=[],f=new RegExp("\\b"+e+"\\b"),c=b.getElementsByTagName("*"),a=0,g=c.length;a<g;a++)f.test(c[a].className)&&d.push(c[a]);return d},findSelectedPages:function(r,m,f,o,j){if(this._mode!=this.SelectionModes.SelectText&&this._mode!=this.SelectionModes.SelectTextToStrikeout)return;if(typeof f=="undefined")f=this.selectionCounter;var c=this._getDocumentHighlightRects(f);if(!c||c.length==0)return;for(var g=null,l=null,s="<div id='{0}' class='highlight selection-highlight' style='top: {1}px; height: {2}px;'></div>",e=0;e<c.length;e++){var d=c[e].bounds,h=c[e].page+1,t=c[e].row+1;if(g==null||l!=null&&l!=h){g=this.element.find("#"+this.pagePrefix+h+" div.highlight-pane");l=h}var n=this.pagePrefix+h+"-highlight-"+t+"-"+f,b=g.find("#"+n);if(b.length==0){var p=a(window.groupdocs.stringExtensions.format(s,n,d.top()+2,d.height()));g.append(p);b=p}if(m){var i=a._data(b.get(0),"events");(!i||!i.click)&&b.click(m)}if(j){var i=a._data(b.get(0),"events");(!i||!i.mouseover)&&b.hover(j.mouseenter,j.mouseleave)}if(r){b.addClass("static");o&&b.css("background-color",o)}b.css({left:d.left()-1,width:d.width(),height:d.height()});if(!this.options.bookLayout){var u=this.pages[c[e].page],k=u.rotation;if(typeof k=="undefined")k=0;var q=k%180>0;q&&b.css({top:d.top()})}}},_getDocumentHighlightRects:function(f){var b=this.pages;if(b.length==0)return null;for(var e=this,g=e.lasso,c=[],a=0;a<b.length;a++)if(b[a]&&g.intersects(b[a].rect)){var d=e._getPageHighlightRects(a,f);if(d&&d.length)c=c.concat(d)}return c},_getPageHighlightRects:function(g,i){for(var e=this.lasso,d=this.pages[g].rows,h=[],b=0;b<d.length;b++){if(!e.intersects(d[b].rect)){this.dragged&&a("#"+this.pagePrefix+(g+(this.options.bookLayout?this.options.startNumbers.start:1))+"-highlight-"+(b+1)+"-"+i+":not(.static)").remove();continue}var c=d[b].rect;if(e.left()<c.left()&&e.bottom()>c.bottom()||e.right()>c.right()&&e.top()<c.top()||e.bottom()>c.bottom()&&e.top()<c.top()){var k=new groupdocs.Rect(c.left(),c.top()+1,c.right(),c.bottom()-1);k.subtract(d[b].pageLocation);var f={bounds:k,originalRect:d[b].originalRect,text:"",page:g+(this.options.bookLayout?this.options.startNumbers.start-1:0),row:b,position:-1,length:0};h.push(f);if(!this.dragged){var j=d[b].words[d[b].words.length-1];f.text=d[b].text;f.position=d[b].words[0].position;f.length=j.position+j.text.length-f.position}}else{var f=this._getRowHighlightRect(g,b);if(f!=null)h.push(f);else this.dragged&&a("#"+this.pagePrefix+(g+(this.options.bookLayout?this.options.startNumbers.start:1))+"-highlight-"+(b+1)+"-"+i+":not(.static)").remove()}}return h},_getRowHighlightRect:function(w,x){var e=this.lasso,p=Math.min(e.top(),e.bottom()),l=Math.max(e.top(),e.bottom()),u=this.pages[w],k=u.rotation;if(typeof k=="undefined")k=0;for(var A=k%180>0,f=u.rows[x],r=f.rect.top(),o=f.rect.bottom(),c=this._textSelectionByCharModeEnabled&&f.chars?f.chars:f.words,B=r<p&&p<o&&l>=o&&!A,g=p<=r&&r<l&&l<o,n=g?-1:1,b=g?c.length-1:0;b<c.length&&b>=0&&!e.intersects(c[b].rect);b+=n)c[b].shown=false;if(b==c.length||b<0)return null;for(var a=c[b],s=0,q=0,t=a.rect.left(),v=a.rect.top(),j=a.originalRect.left(),m=a.originalRect.top(),i=0,h=0,d={bounds:null,text:"",page:w+(this.options.bookLayout?this.options.startNumbers.start-1:0),row:x,position:a.position,length:a.text.length};b<c.length&&b>=0&&(g||B||e.intersects(c[b].rect));b+=n){a=c[b];a.shown=true;if(!this.dragged)if(!this._textSelectionByCharModeEnabled)d.text+=a.text+" ";else if(this._textSelectionByCharModeEnabled)if(!a.isLastWordChar)d.text+=a.text;else d.text+=a.text+" ";t=Math.min(t,a.rect.left());v=Math.min(v,a.rect.top());s=Math.max(s,a.rect.right());q=Math.max(q,a.rect.bottom());j=Math.min(j,a.originalRect.left());m=Math.min(m,a.originalRect.top());i=Math.max(i,a.originalRect.right());h=Math.max(h,a.originalRect.bottom())}for(;b<c.length&&b>=0;b+=n)c[b].shown=false;var y=new groupdocs.Rect(t,v+1,s,q-1);y.subtract(u.rect.topLeft);d.bounds=y;var z=new groupdocs.Rect(j,m+1,i,h-1);d.originalRect=z;d.length=a.position+a.text.length;return d},_findPageAt:function(b){if(this.pages!=null)for(var a=0;a<this.pages.length;a++)if(this.pages[a].rect.contains(b))return this.pages[a];return null},_findPageNearby:function(b){for(var d=0,e=0,c=null,h=false,f=false,a=0;a<this.pages.length;a++)if(this.pages[a].rect.contains(b))return this.pages[a];else if(b.y>=this.pages[a].rect.top()&&b.y<=this.pages[a].rect.bottom()){var g=Math.abs(b.x-this.pages[a].rect.left());if(!h||g<d){d=g;h=true;c=a}}else if(b.x>=this.pages[a].rect.left()&&b.x<=this.pages[a].rect.right()){var i=Math.abs(b.y-this.pages[a].rect.top());if(!f||i<e){e=i;f=true;c=a}}return this.pages[c]},findPageAtVerticalPosition:function(b){for(var a=0;a<this.pages.length;a++)if(b>=this.pages[a].rect.top()&&b<=this.pages[a].rect.bottom()||b>=this.pages[a].rect.bottom()&&a+1>=this.pages.length||b>=this.pages[a].rect.bottom()&&b<=this.pages[a+1].rect.top())return this.pages[a];return null},setTextSelectionMode:function(a){this._textSelectionByCharModeEnabled=a},setMode:function(b){this._mode=b;if(b==this.SelectionModes.SelectText){if(this._lassoCssElement==null)this._lassoCssElement=a('<style type="text/css">.ui-selectable-helper { visibility: hidden; }</style>').appendTo("head")}else if(this._lassoCssElement){this._lassoCssElement.remove();this._lassoCssElement=null}},getMode:function(){return this._mode}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("groupdocsDocumentComponent",{_viewModel:null,options:{fileId:0},_create:function(){a.extend(this.options,{documentSpace:this.element});this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.createHtml&&this._createHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},_init:function(){},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new window.groupdocs.documentComponentViewModel(this.options)},_createHtml:function(){var a=this.element;this.bindingProvider.createHtml("viewing",this.element,this.options);a.trigger("onHtmlCreated")}});window.groupdocs.documentComponentModel=function(b){a.extend(this,b);this._init()};a.extend(window.groupdocs.documentComponentModel.prototype,{_init:function(){this._portalService=Container.Resolve("ServerExchange")},reorderPage:function(f,d,c,a,e,b){this._portalService.reorderPage(f,d,c,a,function(a){e.apply(this,[a.data])},function(a){b.apply(this,[a])})},rotatePage:function(f,e,c,a,b,d){this._portalService.rotatePage(f,e,c,a,function(a){b.apply(this,[a.data])},function(a){d.apply(this,[a])})}});window.groupdocs.documentComponentViewModel=function(b){a.extend(this,b);this._create(b)};a.extend(window.groupdocs.documentComponentViewModel.prototype,{Layouts:{ScrollMode:1,BookMode:2,OnePageInRow:3,TwoPagesInRow:4,CoverThenTwoPagesInRow:5},_model:null,pageImageWidth:0,defaultPageImageWidth:852,imageHorizontalMargin:34,pageWrapperHorizontalMargin:7,imageVerticalMargin:0,initialZoom:100,zoom:null,scale:null,scrollPosition:[0,0],inprogress:null,pages:null,pageIndex:null,pageWidth:null,pageHeight:null,pageCount:null,docType:null,fileId:null,_dvselectable:null,imageUrls:[],pagePrefix:"page-",documentName:null,unscaledPageHeight:null,pageLeft:null,preloadPagesCount:null,viewerLayout:1,changedUrlHash:false,hashPagePrefix:"page",scrollbarWidth:null,password:null,minimumImageWidth:null,fileDisplayName:null,hyperlinks:null,watermarkText:null,watermarkWidth:null,watermarkColor:null,watermarkLeft:null,watermarkTop:null,watermarkScreenWidth:null,searchText:null,htmlSearchHighlightClassName:"search_highlight_html",htmlSearchHighlightElement:"span",htmlSearchHighlightSvgElement:"tspan",currentWordCounter:0,matchedNods:null,searchMatches:null,matchedNodsCount:0,matchesCount:null,searchSeparatorsList:'\\-[\\]{}()*+?\\\\^|\\s.,:;+"/',usePngImagesForHtmlBasedEngine:false,loadAllPagesOnSearch:false,serverPages:null,convertWordDocumentsCompletely:false,ignoreDocumentAbsence:false,tabs:null,useTabsForPages:null,tabPanelHeight:30,supportPageRotation:false,fileType:null,activeTab:null,autoHeight:null,isHtmlDocument:null,rotatedWidth:null,alwaysShowLoadingSpinner:null,supportListOfContentControls:false,supportListOfBookmarks:false,isDocumentLoaded:false,options:{showHyperlinks:true},_create:function(a){this._model=new window.groupdocs.documentComponentModel(a);this._init(a)},_init:function(b){var e=this;if(this.viewerLeft!=0){this.viewerWidth-=this.viewerLeft;this.documentSpace.css("width",this.viewerWidth+"px")}var c=this.defaultPageImageWidth,d=1100;this.pageImageWidth=c;this.pages=this.bindingProvider.getObservableArray([]);this.scale=this.bindingProvider.getObservable(this.initialZoom/100);this.inprogress=this.bindingProvider.getObservable(false),this.pageLeft=this.bindingProvider.getObservable(0);this.pageIndex=this.bindingProvider.getObservable(1);this.pageWidth=this.bindingProvider.getObservable(c);this.pageHeight=this.bindingProvider.getObservable(d);this.pageCount=this.bindingProvider.getObservable(0);this.docType=this.bindingProvider.getObservable(-1);this.documentName=this.bindingProvider.getObservable("");this.password=this.bindingProvider.getObservable("");this.preloadPagesCount=b.preloadPagesCount;this.browserIsChrome=this.bindingProvider.getObservable(false);this.hyperlinks=this.bindingProvider.getObservableArray();this.autoHeight=this.bindingProvider.getObservable(false);this.alwaysShowLoadingSpinner=this.bindingProvider.getObservable(false);this.layout=this.bindingProvider.getObservable(this.viewerLayout);this.firstVisiblePageForVirtualMode=this.bindingProvider.getObservable(0);this.firstVisiblePageForVirtualMode.extend&&this.firstVisiblePageForVirtualMode.extend({rateLimit:{method:"notifyWhenChangesStop",timeout:400}});this.lastVisiblePageForVirtualMode=this.bindingProvider.getObservable(0);this.lastVisiblePageForVirtualMode.extend&&this.lastVisiblePageForVirtualMode.extend({rateLimit:{method:"notifyWhenChangesStop",timeout:400}});this.documentHeight=this.bindingProvider.getObservable(0);this.pagePrefix=this.docViewerId+"-page-";if(this.zoomToFitWidth)this.initialWidth=this.pageImageWidth=this.getFitWidth();this.zoom=this.bindingProvider.getObservable(this.initialZoom);this.documentHeight=this.bindingProvider.getObservable(0);this.options.showHyperlinks=b.showHyperlinks!=false;this.options.highlightColor=b.highlightColor;this.matchedNods=[];this.searchMatches=[];this.serverPages=[{w:this.initialWidth,h:100}];var a;a={number:1,visible:this.bindingProvider.getObservable(false),url:this.bindingProvider.getObservable(this.emptyImageUrl),htmlContent:this.bindingProvider.getObservable(""),searchText:this.bindingProvider.getObservable(null)};if(this.supportPageRotation)a.rotation=this.bindingProvider.getObservable(0);a.prop=this.bindingProvider.getObservable(1);a.heightRatio=this.bindingProvider.getObservable(1);a.left=0;a.top=this.getPageTop(0);this.pages.push(a);this.pagesContainerElement=this.documentSpace.find(".pages_container");this.contentControlsFromHtml=[];this.getScrollbarWidth();if(b.fileId)this.loadDocument();else a.visible(true)},loadDocument:function(){this.inprogress(true);this.triggerEvent("onDocumentloadingStarted")},_onError:function(b){this.inprogress(false);var a=window.jerror||window.jGDError&&window.jGDError[this.instanceId];a&&a(b.Reason||"The document couldn't be loaded...")},_onDocumentLoadFailed:function(a){this.inprogress(false);if(a.code=="Unauthorized")this.triggerEvent("onDocumentPasswordRequired");else{this._onError(a);this.triggerEvent("documentLoadFailed.groupdocs")}},_onDocumentLoadedBeforePdf2Xml:function(a){var d=this;function c(){d._onDocumentLoaded(a)}var b={documentDescription:a.documentDescription,callback:c,synchronousWork:this.textSelectionSynchronousCalculation};if(this._pdf2XmlWrapper)this._pdf2XmlWrapper.initWithOptions(b);else this._pdf2XmlWrapper=new groupdocs.JavaScriptDocumentDescriptionWrapper(b);this._onDocumentLoaded(a)},_onDocumentLoaded:function(a){this.isDocumentLoaded=true;a.pageCount=this._pdf2XmlWrapper.getPageCount();a.documentDescription=this._pdf2XmlWrapper.documentDescription;if(!a.imageUrls)a.imageUrls=a.image_urls;this.triggerEvent("onDocumentLoaded",a);var e=this;this.pageCount(a.pageCount);this.documentName(a.name);this.docType(a.doc_type);this.password(a.password);this.matchesCount=0;this.triggerEvent("getPagesCount",a.pageCount);if(this.supportListOfContentControls)this.contentControls=this._pdf2XmlWrapper.getContentControls();if(this.supportListOfBookmarks)this.bookmarks=this._pdf2XmlWrapper.getBookmarks();var c=this.initPagesAfterDocumentLoad(a);this.pages(c);this.calculatePagePositions();this.inprogress(false);var d=this.scale();this._dvselectable=this.pagesContainerElement;if(this.getSelectableInstance()==null)this.pagesContainerElement.groupdocsSelectable({txtarea:this.selectionContent,pdf2XmlWrapper:this._pdf2XmlWrapper,startNumbers:this.getVisiblePagesNumbers(),pagesCount:this.pageCount(),proportion:d,pageHeight:this.getPageHeight(),docSpace:this.documentSpace,pagePrefix:this.pagePrefix,searchPartialWords:this.searchPartialWords,initializeStorageOnly:this.useHtmlBasedEngine,preventTouchEventsBubbling:this.preventTouchEventsBubbling,highlightColor:this.options.highlightColor,useVirtualScrolling:this.useVirtualScrolling,pageLocations:this.pages()});else this.reInitSelectable();this.setPage(1);!this.zoomToFitHeight&&this.loadImagesForVisiblePages(true);this.adjustInitialZoom();if(this.preloadPagesOnBrowserSide){var b=this.preloadPagesCount;if(b===null||b>this.pageCount())b=this.pageCount();this.loadImagesForPages(1,b)}this.triggerEvent("onScrollDocView",{pi:1,direction:"up",position:0});this.triggerEvent("onDocumentLoadComplete",[a,this._pdf2XmlWrapper]);this.triggerEvent("documentLoadCompleted.groupdocs")},setContainerWidth:function(a){this.viewerWidth=a},setContainerHeight:function(a){this.viewerHeight=a},getFitWidth:function(){var a;if(this.viewerWidth)a=this.viewerWidth;else a=this.documentSpace.width();var b=this.getScrollbarWidth();return a-b-2*(this.imageHorizontalMargin+1)},getFitWidthZoom:function(){return this.getFitWidth()/this.initialWidth*100},getViewerHeight:function(){var a;if(this.viewerHeight)a=this.viewerHeight;else a=this.documentSpace.parent().height();return a},getFitHeightZoom:function(){var a=this.getViewerHeight();return(a-(this.imageVerticalMargin+2))/Math.round(this.initialWidth*this.heightWidthRatio)*100},getScrollbarWidth:function(){if(this.scrollbarWidth==null){var c=a("<div/>").css("width","100px").css("height","100px").css("overflow","scroll").css("position","absolute").css("top","-9999px"),b=c[0];document.body.appendChild(b);this.scrollbarWidth=b.offsetWidth-b.clientWidth;document.body.removeChild(b)}return this.scrollbarWidth},getPageHeight:function(){return this.unscaledPageHeight*this.scale()},ScrollDocView:function(v,t){var s=this.isSetCalled;this.isSetCalled=false;if(s)return;var c=null,u=this.documentSpace.height(),e=a(t.target).scrollTop();this.triggerEvent("onBeforeScrollDocView",{position:e});var j=this.getSelectableInstance();if(j==null)return null;j.initStorage();var r=j.pageLocations,d,o,p=this.pages(),h;h=this.getVisiblePagesNumbers();for(var q=this.documentSpace.height(),m=null,f=null,n,k,l,g,i,b=h.start-1;b<=h.end-1;b++){if(this.useVirtualScrolling)d=p[b].top();else d=r[b].y;i=p[b].prop()*this.pageWidth();o=Math.floor(d+i);n=Math.max(d,e);k=Math.min(o,e+q);l=k-n;g=l/i;if(f==null||g>f){f=g;m=b}}c=m+1;if(c!==null){this.pageIndex(c);this.triggerEvent("onScrollDocView",{pi:c,position:e});this.triggerEvent("documentScrolledToPage.groupdocs",[c])}},ScrollDocViewEnd:function(d,b){this.isSetCalled=false;this.scrollPosition=[a(b.target).scrollLeft(),a(b.target).scrollTop()];var c=this.loadImagesForVisiblePages();this._dvselectable&&a(this._dvselectable).groupdocsSelectable("setVisiblePagesNumbers",c);this.triggerEvent("onDocumentPageSet",[this.pageIndex()]);this.triggerEvent("documentScrolledToPage.groupdocs",[this.pageIndex()])},getVisiblePagesNumbers:function(){if(!this.isDocumentLoaded)return null;var g=null,h=null,c=this.documentSpace.scrollTop(),k,i=this.documentSpace.height(),l=this.getSelectableInstance();if(l==null&&!this.useVirtualScrolling)return null;var f=this.pages(),e,j;if(this.useVirtualScrolling||true)j=f.length;else{e=l.pageLocations;if(e.length!=f.length)return null;j=e.length}for(var b,d,a=0;a<j;a++){if(this.useVirtualScrolling||true)b=f[a].top();else b=e[a].y;k=f[a].prop()*this.pageWidth();d=b+k;if(b>=c&&b<=c+i||d>=c&&d<=c+i||b<=c&&d>=c+i)if(g===null)g=a+1;else h=a+1}if(h===null)h=g;return{start:g,end:h}},loadImagesForVisiblePages:function(d){var a=this.getVisiblePagesNumbers();if(a!=null){var b=a.start,c=a.end;if(b!==null&&c!==null){this.loadImagesForPages(b,c,d);if(this.useVirtualScrolling){this.firstVisiblePageForVirtualMode(a.start-1);this.lastVisiblePageForVirtualMode(a.end-1)}}}return a},loadImagesForPages:function(e,f,c){for(var d=this.pages(),b,a=e;a<=f;a++){b=d[a-1];this.loadImageForPage(a-1,b,c);b.visible(true)}},setPage:function(f){this.isSetCalled=true;var a=Number(f);if(isNaN(a)||a<1)a=1;this.pageIndex(a);var c;if(this.useVirtualScrolling)c=this.pages()[a-1].top();else{var b=this.getSelectableInstance();if(b!=null)if(b.pageLocations&&b.pageLocations.length>0){var e=b.pageLocations[a-1].y;c=e}}var d=this.documentSpace.scrollTop();this.documentSpace.scrollTop(c);if(this.documentSpace.scrollTop()==d)this.isSetCalled=false;this.triggerEvent("onDocViewScrollPositionSet",{position:c});var g=this.pages()[a-1];this.makePageVisible(a-1,g);this.triggerEvent("documentPageSet.groupdocs",a)},setZoom:function(a){this.zoom(a);this.loadPagesZoomed()},loadPagesZoomed:function(){var a=Math.round(this.initialWidth*this.zoom()/100),b=Math.round(a*this.heightWidthRatio),c=false;if(a!=this.pageWidth()||b!=this.pageHeight()){this.pageWidth(a);this.pageHeight(b);c=true}return c?a:null},getWords:function(f){var d="[^"+this.searchSeparatorsList+"]+",e=new RegExp(d,"g"),c=f.match(e),b;if(c==null)b=null;else b=a.map(c,function(a){if(a!="")return a});return b},reInitSelectable:function(){var b=this.getVisiblePagesNumbers(),a=this.getSelectableInstance();a!=null&&a.reInitPages(this.scale(),b,this.scrollPosition,this.getPageHeight(),this.pageCount(),this.pages())},reInitCanvasOffset:function(){var a=this.getSelectableInstance();a.initCanvasOffset()},openCurrentPage:function(){this.setPage(this.pageIndex())},isScrollViewerVisible:function(){return this.documentSpace.is(":visible")},getSelectableInstance:function(){if(this._dvselectable==null)return null;var a=this._dvselectable.data("groupdocsSelectable");return a},resizeViewerElement:function(a){var c=this.documentSpace.parent(),b=c.width();if(typeof a=="undefined")a=0;else this.viewerLeft=a;this.documentSpace.width(b-a);this.reInitSelectable();this.loadImagesForVisiblePages()},onPageReordered:function(b,a){this._model.reorderPage(this.fileId,b,a,this.instanceIdToken,function(){if(!this.useHtmlBasedEngine)for(var d=this.pages(),e,g=Math.min(b,a),f=Math.max(b,a),c=g;c<=f;c++){e=d[c].url();d[c].url(e+"#0");d[c].visible(true)}this._pdf2XmlWrapper&&this._pdf2XmlWrapper.reorderPage(b,a);this.reInitSelectable();this.loadImagesForVisiblePages()}.bind(this),function(a){this._onError(a)}.bind(this))},rotatePage:function(b){var a=this.pageIndex()-1;this._model.rotatePage(this.fileId,a,b,this.instanceIdToken,function(b){var c=this.pages()[a];this.applyPageRotationInBrowser(a,c,b.resultAngle);this.reflowPagesInChrome();this.setPage(a+1);this.loadImagesForVisiblePages(true)}.bind(this),function(a){this._onError(a)}.bind(this))},applyPageRotationInBrowser:function(i,a,f){if(!this.supportPageRotation)return;var h=a.rotation();if(h==0&&f==0)return;h!=f&&this.refreshPageContents(a);a.rotation(f);var c,b;if(this.calculatePageSize())return;var g=this._pdf2XmlWrapper.documentDescription.pages,d,e;if(g){d=this.getPageSize();e=g[i];e.rotation=f;c=e.w;b=e.h}else return;var k=a.rotation()%180;if(k>0){a.prop(c/b);this.setScaleRatioForPage(a,d.width,d.height,b,c)}else{a.prop(b/c);this.setScaleRatioForPage(a,d.width,d.height,c,b)}this.calculatePagePositions();this.reInitSelectable();var j=this.getSelectableInstance();j!=null&&j.clearSelectionOnPage(i);this.loadImagesForVisiblePages(true)},isPageVisible:function(a){return this.pages()[a].visible()},getPageLocations:function(){return this.getSelectableInstance().pageLocations},getPageSize:function(){return this._pdf2XmlWrapper.getPageSize()},adjustInitialZoom:function(){this.zoomToFitHeight&&this.setZoom(this.getFitHeightZoom())},intToColor:function(a){if(a===null)a=4294901760;else a>>>=0;var c=a&255,d=(a&65280)>>>8,e=(a&16711680)>>>16,b=((a&4278190080)>>>24)/255;return"rgba("+[e,d,c,b].join(",")+")"},addSuffixToImageUrl:function(d){var a=d.url(),c="?",b=a.indexOf("dummy=");if(b!=-1)a=a.substring(0,b-1);var e=a.indexOf("?");if(e!=-1)c="&";d.url(a+c+"dummy="+(new Date).getTime())},setLoadingState:function(a){this.inprogress(a)},pageElementStyle:function(c){var a={},d=this.pages();if(this.useVirtualScrolling){var e=this.firstVisiblePageForVirtualMode();c+=e;if(e<d.length)a.top=d[e].top()+"px"}else a.top="";if(this.layout()==this.Layouts.OnePageInRow){a.display="block";a.marginLeft="auto";a.marginRight="auto"}else{a.display="";a.marginLeft="";a.marginRight=""}var b=this.pageWidth();if(this.options.useEmScaling){a.width=this.serverPages[c].w*this.pointToPixelRatio/16+"em";a.height=this.serverPages[c].h*this.pointToPixelRatio/16+"em"}else{if(this.autoHeight()){a.height="auto";a.overflow="visible";return a}if(this.supportPageRotation&&this.useTabsForPages&&this.useTabsForPages()){var f=d[c];if(f.rotation()%180>0){a.width=b*f.prop();a.height=b}else{a.width=b;a.height=b*f.prop()}return a}else a.width=b+(this.useHtmlBasedEngine?this.imageHorizontalMargin:0)+"px";if(c<d.length)a.height=b*d[c].prop()+"px";a.overflow="hidden"}return a},pagesContainerStyle:function(){var a=this.layout();return{height:this.useVirtualScrolling?this.documentHeight()+"px":"auto",width:a==this.Layouts.TwoPagesInRow||a==this.Layouts.CoverThenTwoPagesInRow?(this.pageWidth()+this.pageWrapperHorizontalMargin)*2+"px":"auto"}},loadingOverlayStyle:function(a){return{display:this.alwaysShowLoadingSpinner()||this.inprogress()||!a.visible()?"block":"none",zIndex:this.inprogress()||!a.visible()?2:0,width:this.pageWidth()+"px",height:this.autoHeight()?"100%":this.pageWidth()*a.prop()+"px",backgroundColor:this.inprogress()||!a.visible()?"":"transparent"}},setLayout:function(a){this.layout(a);this.calculatePagePositions();this.loadImagesForVisiblePages()},calculatePagePositions:function(){for(var q=15,f=this.pageWrapperHorizontalMargin,i=this.pages(),j=this.pageWidth(),m=0,e,t,o,d,h,g=0,c,n=0,r=this.documentSpace.get(0).getBoundingClientRect(),p=r.width,b=this.layout(),u=0;u<=1;u++){d=f;h=0;switch(b){case this.Layouts.ScrollMode:var w=j+f,v=p-n;c=Math.floor(v/w);if(c==0)c=1;break;case this.Layouts.OnePageInRow:c=1;break;case this.Layouts.TwoPagesInRow:case this.Layouts.CoverThenTwoPagesInRow:c=2}for(var l,s,a=0;a<i.length;a++){e=i[a];t=e.prop();o=j*t;e.left=d;e.top(h);l=b!=this.Layouts.CoverThenTwoPagesInRow&&a%c==0||b==this.Layouts.CoverThenTwoPagesInRow&&(a==0||a%c==1);s=b==this.Layouts.OnePageInRow||b==this.Layouts.TwoPagesInRow&&a%c==1||b==this.Layouts.CoverThenTwoPagesInRow&&(a==0||a%c==0)||b==this.Layouts.ScrollMode&&a%c==c-1;if(l||!l&&o>g)g=o;m=h+g+q;if(s){h+=g+q;if(b!=this.Layouts.OnePageInRow)d=f}else if(b!=this.Layouts.OnePageInRow)d+=j+f}this.documentHeight(m);var k=false;if(b==this.Layouts.OnePageInRow||b==this.Layouts.ScrollMode){k=m>r.height;if(k)n=this.getScrollbarWidth()}if(b!=this.Layouts.ScrollMode||!k)break}if(b==this.Layouts.OnePageInRow){d=(p-j-n)/2;for(a=0;a<i.length;a++){e=i[a];e.left=d}}},getPageTop:function(a){return this.useVirtualScrolling?this.bindingProvider.getObservable(a):this.getAccessor(a)},getAccessor:function(b){var a=b;return function(b){if(typeof b=="undefined")return a;else a=b}},triggerEvent:function(b,a){this.documentSpace.trigger(b,a)},refreshPageContents:function(){},setScaleRatioForPage:function(){},calculatePageSize:function(){},reflowPagesInChrome:function(){},highlightSearch:function(){if(this.useVirtualScrolling){var a=this.getSelectableInstance();a&&a.highlightSearch(this.firstVisiblePageForVirtualMode(),this.lastVisiblePageForVirtualMode())}}})})(jQuery);(function(a,b){"use strict";a.groupdocsWidget("groupdocsDocumentHtmlRendering",{_viewModel:null,options:{showHyperlinks:true},_create:function(){a.extend(this.options,{documentSpace:this.element});this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.createHtml&&this._createHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},_init:function(){},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new window.groupdocs.documentHtmRenderingComponentViewModel(this.options)},_createHtml:function(){var a=this.element;this.bindingProvider.createHtml("viewing",this.element,this.options);a.trigger("onHtmlCreated")}});window.groupdocs.documentHtmRenderingComponentModel=function(b){a.extend(this,b);this._init()};a.extend(window.groupdocs.documentHtmRenderingComponentModel.prototype,window.groupdocs.documentComponentModel.prototype,{_init:function(){this._portalService=Container.Resolve("ServerExchange")},loadDocumentAsHtml:function(p,r,i,n,c,m,k,h,l,f,g,d,e,b,j,q,o,a){this._portalService.viewDocumentAsHtml(p,this.preloadPagesCount,i,n,c,m,k,h,l,f,g,d,e,b,j,q,function(b){if(b.data)o.apply(this,[b.data]);else a.apply(this)},function(b){a.apply(this,[b])},false)},getDocumentPageHtml:function(g,e,d,a,h,b,f,c){this._portalService.getDocumentPageHtml(g,e,d,a,b,h,function(a){f.apply(this,[a.data])},function(a){c.apply(this,[a])})}});window.groupdocs.documentHtmRenderingComponentViewModel=function(b){a.extend(this,b);this._create(b)};a.extend(window.groupdocs.documentHtmRenderingComponentViewModel.prototype,window.groupdocs.documentComponentViewModel.prototype,{imageHorizontalMargin:0,options:{showHyperlinks:true},_create:function(a){this._model=new window.groupdocs.documentHtmRenderingComponentModel(a);this._init(a)},_init:function(b){this.calculatePointToPixelRatio();var a=this;this.useTabsForPages=this.bindingProvider.getObservable(null);this.tabs=this.bindingProvider.getObservableArray([]);this.activeTab=this.bindingProvider.getObservable(0);this.isHtmlDocument=this.bindingProvider.getObservable(false);this.rotatedWidth=this.bindingProvider.getComputedObservable(function(){if(a.useTabsForPages()){var b=a.pageWidth();return b/a.zoom()*100+"px"}else return"auto"});window.groupdocs.documentComponentViewModel.prototype._init.call(this,b)},loadDocument:function(a){window.groupdocs.documentComponentViewModel.prototype.loadDocument.call(this,a);var b=1;this._model.loadDocumentAsHtml(a||this.fileId,b,this.fileDisplayName,this.usePngImagesForHtmlBasedEngine,this.convertWordDocumentsCompletely,this.watermarkText,this.watermarkColor,this.watermarkPosition,this.watermarkWidth,this.ignoreDocumentAbsence,this.supportPageRotation,this.supportListOfContentControls,this.supportListOfBookmarks,this.embedImagesIntoHtmlForWordFiles,this.instanceIdToken,this.locale,function(b){if(typeof a!=="undefined")this.fileId=a;this.pageWidth(this.pageImageWidth*(this.initialZoom/100));this._onDocumentLoadedBeforePdf2Xml(b)}.bind(this),function(a){this._onDocumentLoadFailed(a)}.bind(this))},getDocumentPageHtml:function(b,c){var a;if(this.useTabsForPages())a=this.tabs()[b];else a=this.pages()[b];if(!a.visible()&&!a.startedDownloadingPage){var d=this.preloadedPages&&this.preloadedPages.html[b];if(d){a.htmlContent(d);var e=this.preloadedPages.css[b];this.setPageHtml(a,b,d,e);c&&c.call();return}a.startedDownloadingPage=true;this._model.getDocumentPageHtml(this.fileId,b,this.usePngImagesForHtmlBasedEngine,this.embedImagesIntoHtmlForWordFiles,this.instanceIdToken,this.locale,function(d){this.setPageHtml(a,b,d.pageHtml,d.pageCss);c&&c.call()}.bind(this),function(b){a.startedDownloadingPage=false;this._onError(b)}.bind(this))}},setPageHtml:function(b,i,c,j){var d=j;if(!this.pageCssElement)this.pageCssElement=a([]);if(this.browserIsIE9OrLess){var h=this.pageCssElement.filter("style:first");d=h.html();h.remove();d+=j}var g=a("<style type='text/css'>"+d+"</style>");this.pageCssElement=this.pageCssElement.add(g);g.appendTo("head");var f=this.useTabsForPages();if(f||f===null)c=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");b.htmlContent(c);var e={text:this.searchText,isCaseSensitive:false,searchForSeparateWords:this.searchForSeparateWords,treatPhrasesInDoubleQuotesAsExact:this.treatPhrasesInDoubleQuotesAsExact,pageNumber:i};if(this.useVirtualScrolling){b.parsedHtmlElement=a(c);b.currentValue=c;this.parseSearchParameters(b.parsedHtmlElement.not("style")[0],e)}b.searchText(e);b.visible(true);b.startedDownloadingPage=false;this.markContentControls(i)},addPageCss:function(e){var b=e;if(!this.pageCssElement)this.pageCssElement=a([]);if(this.browserIsIE9OrLess){var d=this.pageCssElement.filter("style:first");b=d.html();d.remove();b+=e}var c=a("<style type='text/css'>"+b+"</style>");this.pageCssElement=this.pageCssElement.add(c);c.appendTo("head")},_onError:function(b){this.inprogress(false);var a=window.jerror||window.jGDError&&window.jGDError[this.instanceId];a&&a(b.Reason||"The document couldn't be loaded...")},initPagesAfterDocumentLoad:function(c){this.watermarkScreenWidth=null;this.zoom(100);this.fileType=c.fileType;this.urlForResourcesInHtml=c.urlForResourcesInHtml;var d=null,f=null,b,e,t,p;t=this.fileType=="Txt"||this.fileType=="Xml";this.isHtmlDocument(this.fileType=="Html"||this.fileType=="Htm"||t);var k=c.doc_type=="Cells"||this.isHtmlDocument();this.useTabsForPages(k);k|=c.doc_type=="Image";this.triggerEvent("isDocumentSinglePaged.groupdocs",k);this.alwaysShowLoadingSpinner(!k);var A=a.browser.webkit&&!!window.chrome,I=window.chrome,J=window.navigator.vendor,L=window.navigator.userAgent.indexOf("OPR")>-1;if(!!I&&J==="Google Inc."&&L==false)A=true;this.browserIsChrome(A);var m=c.pageCss[0];if(!m)m="";this.pageCssElement&&this.pageCssElement.remove();this.urlForImagesInHtml=c.urlForImagesInHtml;this.urlForFontsInHtml=c.urlForFontsInHtml;this.pageCssElement=a([]);this.preloadedPages={html:c.pageHtml,css:c.pageCss};var l=c.pageHtml[0],h=this.pages()[0];d=this._pdf2XmlWrapper.documentDescription.pages;this.autoHeight(this.useTabsForPages());var j;if(this.useTabsForPages()){this.pageCount(1);if(this.isHtmlDocument()){var u;if(t)u="<div class='text_document_wrapper'>"+l+"</div>";else{var v=this.getHtmlElementContents(l,"head");if(v){var q=this.getHtmlElements(v,"style"),s=this.getHtmlElementAttributes(v,"link");if(s!=null){var x=this;for(b=0;b<s.length;b++){j=a(s[b]);var N=j.attr("rel");if(N=="stylesheet"){var O=j.attr("href");a.get(O,function(c){var b=a("<style type='text/css'>"+c+"</style>");x.pageCssElement=x.pageCssElement.add(b);b.prependTo("head");x._calculatePageSizeFromDOM()})}}}if(q)for(b=0;b<q.length;b++){var M=q[b];m+=M}}u=this.getPageBodyContentsWithReplace(l)}var r=a(u);r.find("script").remove();r.addClass("html_document_wrapper");l=r[0].outerHTML;var H=".grpdx .ie .doc-page .html_page_contents > div {font-size:1em;}";m+=H}}else{f=this._pdf2XmlWrapper.getPageSize();h.prop(d[0].h/d[0].w);p=this.getScaleRatioForPage(f.width,f.height,d[0].w,d[0].h);h.heightRatio(p);this.documentSpace.css("background-color","inherit")}j=a("<style>"+m+"</style>");this.pageCssElement=this.pageCssElement.add(j);j.prependTo("head");var D=c.sharedCss;if(D){var B=a("<style>"+D+"</style>");this.pageCssElement=this.pageCssElement.add(B);B.appendTo("head")}this.calculatePointToPixelRatio();var F=this.documentSpace.find(".html_page_contents:first");h.htmlContent(l);h.visible(true);this.clearContentControls();this.markContentControls(0);this.tabs.removeAll();if(this.useTabsForPages()){var w=this._pdf2XmlWrapper.documentDescription.sheets;if(w)for(b=0;b<w.length;b++)this.tabs.push({name:w[b].name,visible:this.bindingProvider.getObservable(false),htmlContent:this.bindingProvider.getObservable(""),searchText:this.bindingProvider.getObservable(null)});this.activeTab(0);this.documentSpace.css("background-color","white");if(this.tabs().length>0)this.documentSpace.addClass("doc_viewer_tabs");else this.documentSpace.removeClass("doc_viewer_tabs")}var o=F.children("div,table,img"),i;if(this.useTabsForPages()){i=o.width();var z=o.height();h.prop(z/i);f={width:i,height:z};h.heightRatio(1)}if(this.supportPageRotation){if(d)e=d[0].rotation;else e=0;if(typeof e=="undefined")e=0;this.applyPageRotationInBrowser(0,h,e)}var E=f.width,G=false,y=o.children();if(y.length==1&&y.filter("img").length==1)G=true;if(this.isHtmlDocument()){i=this.getFitWidth();this.pageWidth(i)}else i=o.width();this.heightWidthRatio=parseFloat(f.Height/f.Width);(!this.useTabsForPages()||!this.supportPageRotation||h.rotation%180==0)&&this.pageWidth(E*this.pointToPixelRatio);this.pageHeight(Math.round(this.pageWidth()*this.heightWidthRatio));this.initialWidth=this.pageWidth();var K=this.pageCount(),n=[],g;this.serverPages=d=this._pdf2XmlWrapper.documentDescription.pages;g=this.pages()[0];n.push(g);var C;for(b=1;b<K;b++){p=this.getScaleRatioForPage(f.width,f.height,d[b].w,d[b].h);C=d[b].h/d[b].w;g={number:b+1,visible:this.bindingProvider.getObservable(false),htmlContent:this.bindingProvider.getObservable(""),prop:this.bindingProvider.getObservable(C),heightRatio:this.bindingProvider.getObservable(p),searchText:this.bindingProvider.getObservable(null)};if(this.supportPageRotation){e=this.serverPages[b].rotation;if(typeof e=="undefined")e=0;g.rotation=this.bindingProvider.getObservable(e);this.applyPageRotationInBrowser(b,g,e)}g.left=0;g.top=this.getPageTop(0);n.push(g)}if(k)c.pageCount=0;this.triggerEvent("_onProcessPages",[c,n,this.getDocumentPageHtml,this,this.pointToPixelRatio,this.docViewerId]);return n},ScrollDocView:function(a,b){!this.useTabsForPages()&&window.groupdocs.documentComponentViewModel.prototype.ScrollDocView.call(this,a,b)},ScrollDocViewEnd:function(a,b){!this.useTabsForPages()&&window.groupdocs.documentComponentViewModel.prototype.ScrollDocViewEnd.call(this,a,b)},getVisiblePagesNumbers:function(){return this.useTabsForPages()?{start:1,end:1}:window.groupdocs.documentComponentViewModel.prototype.getVisiblePagesNumbers.call(this)},loadImageForPage:function(b,c){var a=c.visible();a&&this.markContentControls(b);!a&&this.getDocumentPageHtml(b)},makePageVisible:function(a,b){!b.visible()&&this.getDocumentPageHtml(a)},setZoom:function(a){window.groupdocs.documentComponentViewModel.prototype.setZoom.call(this,a);this.clearContentControls();this.reInitSelectable();this.setPage(this.pageIndex());this.loadImagesForVisiblePages();this.reflowPagesInChrome(true)},loadPagesZoomed:function(){this.useTabsForPages()&&this._calculatePageSizeFromDOM();var a=window.groupdocs.documentComponentViewModel.prototype.loadPagesZoomed.call(this);if(a!==null)!this.useTabsForPages()&&this.calculatePagePositions()},performSearch:function(f,h,e,d){this.searchText=f;this.searchForSeparateWords=e;this.treatPhrasesInDoubleQuotesAsExact=d;var b=this.pages(),c;this.loadAllPagesOnSearch&&this.loadImagesForPages(1,b.length);for(var a=0;a<b.length;a++){c=b[a];if(c.visible()){var g={text:f,isCaseSensitive:h,searchForSeparateWords:e,treatPhrasesInDoubleQuotesAsExact:d,pageNumber:a};c.searchText(g)}}},searchHtmlElement:function(a,s,r,j,z,E,n,p,D){s=s||this.htmlSearchHighlightElement;var o,g,F=0,b=null,e=null,K;if(a.nodeType===3){if(j){o=j.length;var q=a.data.replace(/[\r\n\s]+$/g,""),G="["+this.searchSeparatorsList+"]",x,y,L=/[\-[\]{}()*+?\\^|\s.,:;+"]+$/g,I,l,h,i,m,d,k=-1,J=0,c=0;q=q.replace(L,"");if(q.length==0)return 0;if(E&&!p){for(var f=[],t=0;t<j.length;t++){I=j[t];l=z[t];g=l;i=g.length;e=a.data;if(!n){g=g.toLocaleLowerCase();e=e.toLocaleLowerCase()}c=0;do{h=e.indexOf(g,c);if(h!=-1){f.push({index:h,length:i});c=h+i}}while(h!=-1)}f.sort(function(a,b){return b.index-a.index});var H=[];f=f.filter(function(a,b){return!f.some(function(c,e){var d=e!=b&&(a.index>=c.index&&a.index<c.index+c.length)||a.index+a.length>c.index&&a.index+a.length<c.index+c.length;if(d){if(H.indexOf(a)!=-1)return false;H.push(c)}return d})});for(d=0;d<f.length;d++){m="search_highlight"+this.matchesCount.toString();this.matchesCount++;this.highlightOneNode(a,f[d].index,f[d].length,m,r,D)}return f.length}var B,C,w;do{I=j[this.currentWordCounter];l=z[this.currentWordCounter];B=this.currentWordCounter==0;C=this.currentWordCounter==o-1;if(B&&!p)x="";else x="(?:"+G+"|^)+";if(C&&!p)y="";else y="(?:"+G+"|$)+";g=x+"("+l+y+")";e=a.data;e=e.substr(c,e.length-c);if(this.matchedNodsCount>0&&k==-1||k!=-1)g="^"+g;K=new RegExp(g,n?"":"i");w=false;b=e.match(K);if(b){if(k==-1)this.matchedNodsCount++;F++;this.matchedNods.push(a);h=c+b.index;i=b[0].length;if(B){h=c+e.indexOf(b[1],b.index);i=b[1].length}if(C&&!this.useAccentInsensitiveSearch){var u=j[this.currentWordCounter],A=e;if(!n){u=u.toLowerCase();A=A.toLowerCase()}var N=c+A.indexOf(u,b.index);i=u.length+N-h}this.searchMatches.push({index:h,length:i});k=c+b.index;J=b[0].length;c=k+J;this.currentWordCounter++;if(this.currentWordCounter>=o){m="search_highlight"+this.matchesCount.toString();for(d=o-1;d>=0;d--)this.highlightOneNode(this.matchedNods[d],this.searchMatches[d].index,this.searchMatches[d].length,m,r,D);this.currentWordCounter=0;this.matchedNods=[];this.searchMatches=[];this.matchedNodsCount=0;this.matchesCount++;return F}}else{this.matchedNods=[];this.searchMatches=[];if(this.currentWordCounter>0){k=-1;this.matchedNodsCount=0;w=true}this.currentWordCounter=0}}while(b&&c<q.length||w);if(!b)this.matchedNodsCount=0;return 0}}else if(a.nodeType===1&&a.childNodes&&!/(script|style)/i.test(a.tagName)&&!(a.tagName===s.toUpperCase()&&a.className===r))for(var M=0,v=M;v<a.childNodes.length;v++)v+=this.searchHtmlElement(a.childNodes[v],s,r,j,z,E,n,p,D);return 0},highlightOneNode:function(i,k,j,e,h,l){var n=false,g=a(i),b,c;if(g.is("tspan")||g.parent().is("tspan")){n=true;c=this.htmlSearchHighlightSvgElement;var o="http://www.w3.org/2000/svg";b=document.createElementNS(o,c);b.setAttribute("class",h||this.htmlSearchHighlightClassName)}else{c=this.htmlSearchHighlightElement;b=document.createElement(c);b.className=h||this.htmlSearchHighlightClassName}var f=a(b);e&&f.attr("name",e);f.attr("data-page-num",l.toString());var d=i.splitText(k);d.splitText(j);var m=d.cloneNode(true);b.appendChild(m);d.parentNode.replaceChild(b,d)},removeSearchHighlight:function(d){var b=this.htmlSearchHighlightElement+"."+this.htmlSearchHighlightClassName,c=this.htmlSearchHighlightSvgElement+"."+this.htmlSearchHighlightClassName;a(d).find(b+","+c).each(function(){var a=this.parentNode;a.replaceChild(this.firstChild,this);a.normalize()})},calculatePageSize:function(){if(this.useTabsForPages()){var a=this;window.setTimeout(function(){a._calculatePageSizeFromDOM()},50);return true}return false},_calculatePageSizeFromDOM:function(){var g=this.documentSpace.find(".html_page_contents:first"),d=g.children("div,table,iframe"),f=d.width();this.initialWidth=f;this.pageWidth(f*this.zoom()/100);var e=d[0].getBoundingClientRect(),h=0;this.autoHeight(true);var c=this.pages()[0],b=e.width,a=e.height;if(c&&c.rotation()%180>0){var i=b;b=a;a=i}a+=h;c.prop(a/b);this.autoHeight(false)},reflowPagesInChrome:function(c){if(this.browserIsChrome()&&this.watermarkText&&!this.useVirtualScrolling){var d=this,b=function(){d.pagesContainerElement.children().each(function(){a(this).css("top",0).css("left",0)})};if(c)window.setTimeout(b,10);else b()}},getHtmlElements:function(d,a){var c=new RegExp("<"+a+"[^>]*>(?:.|\\r?\\n)*?<\\/"+a+">","gi"),b=d.match(c);return b},getHtmlElementContents:function(e,b){var d=new RegExp("<"+b+"[^>]*>((?:.|\\r?\\n)*?)<\\/"+b+">","i"),c=e.match(d),a=null;if(c)a=c[1];return a},getHtmlElementAttributes:function(c,d){var b=new RegExp("<"+d+"[^>]*/?>","gi"),a=c.match(b);return a},getPageBodyContents:function(b){return b.match(/<body[^>]*>((?:.|\r?\n)*?)<\/body>/)[1]},getPageBodyContentsWithReplace:function(a){var c="<body",e=a.indexOf(c),b=e+c.length,f=a.indexOf("/body>"),d="<div"+a.substr(b,f-b)+"/div>";return d},fixImageReferencesInHtml:function(b){return this.getPageBodyContents(b)},calculatePointToPixelRatio:function(){var c=100,b=a("<div/>").css("width",c+"pt").css("height","0");b.appendTo(this.documentSpace);var d=b.width();this.pointToPixelRatio=d/c;b.remove()},activateTab:function(b){var d=this.tabs()[b],a=this;function c(){var h=a.pages(),c=h[0];c.htmlContent(d.htmlContent());var g=a.documentSpace.find(".html_page_contents:first"),f=g.children("div,table"),e=f.width();a.initialWidth=e;c.prop(f.height()/e);a.pageWidth(e*a.zoom()/100);a.activeTab(b);a.supportPageRotation&&a.applyPageRotationInBrowser(0,c,c.rotation())}if(d.visible())c();else this.getDocumentPageHtml(b,function(){c()})},adjustInitialZoom:function(){window.groupdocs.documentComponentViewModel.prototype.adjustInitialZoom.call(this);if(this.zoomToFitWidth){var b=this.getFitWidth(),a=this.pageWidth();if(!this.onlyShrinkLargePages||a>b){var c=b/a*100;this.setZoom(c)}}},watermarkTransform:function(q,y){var m=0;if(q.rotation)m=q.rotation();var C=q.prop(),f="Top",z="Bottom",l="Diagonal",t="Left",o="Center",s="Right",b="",g=o;if(this.watermarkPosition.indexOf(f)==0)b=f;else if(this.watermarkPosition.indexOf(z)==0)b=z;else if(this.watermarkPosition.indexOf(l)==0){b=l;g=o}if(b!=l)if(this.watermarkPosition.indexOf(t)!=-1)g=t;else if(this.watermarkPosition.indexOf(o)!=-1)g=o;else if(this.watermarkPosition.indexOf(s)!=-1)g=s;var p="translate(",D=10,n=100,d=n*C,x;if(this.watermarkScreenWidth==null){var B;if(!y)y=q.scopeElement[0];B=y.getBBox();this.watermarkScreenWidth=B.width}x=this.watermarkScreenWidth;var a;if(this.watermarkWidth==null)a=1;else a=this.watermarkWidth/100;var w=n;if(b==l&&d<n)w=d;var v=w*a,A=w/x;if(m%180!=0&&b!=l){v=d*a;A=d/x}a*=A;var e=n/2,c=d/2,h=0;switch(g){case o:h=(n-v)/2;break;case t:h=0;break;case s:h=n-v}p+=h+","+(b==f?0:d-d*a)+")scale("+a+")";if(b==l)p+="translate(0,"+-c/a+") rotate("+(-50+m)+","+(e-h)/a+","+d+") ";if(!q.rotation||b==l)return p;var k=0,j=0,u=0,r,i=0;if(g==o){r=(e-h)/a;if(b==f)i=0;else i=d}else if(g==t){r=e/a;if(m%180!=0)u=(e-c)/a;if(b==f)i=0;else i=d}else if(g==s){r=-(h-e)/a;if(m%180!=0)u=-(e-c)/a;if(b==f)i=0;else i=d}switch(m){case 90:if(b==f){k=c/a;j=-e/a}else{k=-c/a;j=e/a}break;case 180:if(b==f){k=c/a;j=-c/a}else{k=-c/a;j=c/a}break;case 270:if(b==f){k=c/a;j=-e/a}else{k=-c/a;j=e/a}}if(b==f||b==z)p+="translate(0,"+k+") rotate("+m+","+r+","+i+") translate("+u+","+j+")";return p},pagesContainerStyle:function(){var a=window.groupdocs.documentComponentViewModel.prototype.pagesContainerStyle.call(this);if(this.useTabsForPages())a.height="auto";return a},getScaleRatioForPage:function(c,f,e){var a,d;if(c===b)a=1;else a=c/e;d=a;return d},setScaleRatioForPage:function(e,a,b,d){var c=this.getScaleRatioForPage(a,b,d);e.heightRatio(c)},clearContentControls:function(){if(!this.supportListOfContentControls||!this.contentControlsFromHtml)return;for(var a,b=0;b<this.contentControlsFromHtml.length;b++){a=this.contentControlsFromHtml[b];typeof a!="undefined"&&a.visualWrapper&&a.visualWrapper.remove()}this.contentControlsFromHtml.length=0},markContentControls:function(f){if(!this.supportListOfContentControls||!this.contentControls)return;for(var e,b=0;b<this.contentControlsFromHtml.length;b++){e=this.contentControlsFromHtml[b];if(typeof e!="undefined"&&e.pageNumber==f)return}var h="2D5FABC2",j="start",n="end",m="=",g=this.documentSpace;if(typeof f!="undefined")g=this.documentSpace.find("#"+this.pagePrefix+(f+1).toString());g.find(".content_control_visual_wrapper").remove();var l=g.find("a[name^='"+h+"']"),c=[],i=0,d,k=this;l.each(function(){var e=a(this),b=e.attr("name"),r=new RegExp("("+j+")|("+n+")"),i=b.search(r),p=b.substring(h.length+1,i);d=parseInt(p);if(f>=k.contentControls[d].startPage&&f<=k.contentControls[d].endPage)if(b.indexOf(j)==i){var o=b.indexOf(m,i)+1,q=b.substring(o,b.length),l=b[i+j.length]=="1",g=e;if(typeof c[d]=="undefined"){if(l||g.parent().children(":not([name^='"+h+"'])").length==0)g=g.parent();c[d]={title:q,number:d}}c[d].startElement=g;c[d].moveUpInDom=l}else{if(e.parent().children(":not([name^='"+h+"'])").length==0)e=e.parent();if(typeof c[d]=="undefined")c[d]={endElement:e,number:d};c[d].endElement=e}});for(b=0;b<this.contentControls.length;b++)if(f>=this.contentControls[b].startPage&&f<=this.contentControls[b].endPage)if(!c[b])c[b]={number:b,title:this.contentControls[b].title};for(b=0;b<c.length;b++){e=c[b];if(e){if(!e.startElement)e.startElement=g.children(".html_page_contents").children(".pageWordToHtml").children(":first");if(!e.endElement)e.endElement=g.children(".html_page_contents").children(".pageWordToHtml").children(":last");e.title=this.contentControls[b].title;e.pageNumber=f;i++;(function(a){window.setTimeout(function(){i--;k.createContentControlWrappers(g,c,a,h,i)},2e3)})(b)}}},createContentControlWrappers:function(o,e,s,v,x){var b=e[s],p=b.startElement,r=b.endElement,z=p.offset().top;z-=this.pagesContainerElement.offset().top;var c=a("<div/>").appendTo(o);b.visualWrapper=c;c.addClass("content_control_visual_wrapper");var d=p.nextUntil(r,":not([name^='"+v+"'])").add(r);if(b.moveUpInDom)d=d.add(p);var w=d.find("*");d=d.add(w);var h=null,l=null,i=null,k=null,f,n,g,m,q=this.zoom()/100;d.each(function(){var b=a(this);if(b.width()==0||b.height()==0)return;f=b.offset().left;if(h===null||f<h)h=f;n=b.width()*q;if(l===null||f+n>l)l=f+n;g=b.offset().top;if(i===null||g<i)i=g;m=b.height()*q;if(k===null||g+m>k)k=g+m});var t=o.offset().left,u=o.offset().top;c.css("left",h-t+"px");c.css("width",l-h+"px");c.css("top",i-u+"px");c.css("height",k-i+"px");c.attr("data-title",b.title);if(x==0){e.sort(function(a,b){return a.visualWrapper&&b.visualWrapper?b.visualWrapper.width()*b.visualWrapper.height()-a.visualWrapper.width()*a.visualWrapper.height():0});for(var y=1,j=0;j<e.length;j++){b=e[j];if(typeof b!="undefined"&&b.visualWrapper){b.visualWrapper.css("z-index",j+y);if(this.contentControlToBeOpened!==null&&this.contentControlToBeOpened==b.number){this.visuallySelectContentControl(b);this.contentControlToBeOpened=null}}this.contentControlsFromHtml.push(e[j])}}},getContentControlDescriptions:function(){return this.contentControls},navigateToContentControl:function(a){a=parseInt(a);var d=this.contentControls[a].startPage,e=false;if(this.pages()[d].visible())for(var b,c=0;c<this.contentControlsFromHtml.length;c++){b=this.contentControlsFromHtml[c];if(typeof b!="undefined"&&b.number==a){this.visuallySelectContentControl(b);e=true;break}}if(!e){this.contentControlToBeOpened=a;this.setPage(d+1)}},visuallySelectContentControl:function(b){var d=20;this.documentSpace[0].scrollTop=b.visualWrapper.offset().top-this.pagesContainerElement.offset().top-d;var c="hover",a=this.documentSpace.find(".doc-page .content_control_visual_wrapper");a.removeClass(c);a.unbind("mouseleave");b.visualWrapper.addClass(c);a.bind("mouseleave",function(){b.visualWrapper.removeClass(c);a.unbind("mouseleave")});this.triggerEvent("ScrollDocView",[null,{target:this.documentSpace[0]}]);this.triggerEvent("ScrollDocViewEnd",[null,{target:this.documentSpace[0]}])},parseSearchParameters:function(i,d){var a=this;a.removeSearchHighlight(i);if(d){var c=d.text;if(c){var b,k=d.isCaseSensitive,h=false;if(d.treatPhrasesInDoubleQuotesAsExact){var e=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");if(e.length>=2&&e[0]=='"'&&e[e.length-1]=='"'){c=c.substr(1,e.length-2);c=c.replace(/^[\r\n\s]+|[\r\n\s]+$/g,"");a.currentWordCounter=0;a.matchedNods=[];a.searchMatches=[];a.matchedNodsCount=0;h=true}}var j=/[-[\]{}()*+?.,\\^$|#\s]/g;b=a.getWords(c);if(b==null)return;b=jQuery.map(b,function(a){return a.replace(j,"\\$&")});var g=b,f;if(a.useAccentInsensitiveSearch||a.useRtl){g=[];for(wordNum=0;wordNum<b.length;wordNum++){f=b[wordNum];if(a.useAccentInsensitiveSearch)f=window.jGroupdocs.stringExtensions.getAccentInsensitiveRegexFromString(f);g.push(f)}}a.searchHtmlElement(i,null,null,b,g,d.searchForSeparateWords,k,h,d.pageNumber);return}}}})})(jQuery);(function(a){"use strict";a.groupdocsWidget("groupdocsDocumentImageRendering",{_viewModel:null,options:{fileId:0,quality:null,supportTextSelection:true,showHyperlinks:true},_create:function(){a.extend(this.options,{documentSpace:this.element,emptyImageUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII="});this.bindingProvider=new window.groupdocs.bindingProvider;this.options.bindingProvider=this.bindingProvider;this.options.createHtml&&this._createHtml();this._viewModel=this.getViewModel();this.bindingProvider.applyBindings(this._viewModel,this.element)},_init:function(){},getViewModel:function(){if(this._viewModel==null)this._viewModel=this._createViewModel();return this._viewModel},_createViewModel:function(){return new window.groupdocs.documentImageRenderingComponentViewModel(this.options)},_createHtml:function(){var a=this.element;this.bindingProvider.createHtml("viewing",this.element,this.options);a.trigger("onHtmlCreated")}});window.groupdocs.documentImageRenderingComponentModel=function(b){a.extend(this,b);this._init()};a.extend(window.groupdocs.documentImageRenderingComponentModel.prototype,window.groupdocs.documentComponentModel.prototype,{_init:function(){this._portalService=Container.Resolve("ServerExchange")},loadDocument:function(p,r,l,o,g,k,i,f,j,d,e,b,c,h,q,n,a){var m=function(b){if(b.data!=null)n.apply(this,[b.data]);else a.apply(this,[{code:b.data.code,Reason:b.data?b.data.Reason:null}])};this._portalService.viewDocument(p,l,this.quality,this.supportTextSelection,this.preloadPagesCount,o,g,k,i,f,j,d,e,b,c,h,q,m,a)},loadHyperlinks:function(c,b,a){this._portalService.getDocumentHyperlinks(c,function(a){b.apply(this,[a.data])},function(b){a.apply(this,[b])})},retrieveImageUrls:function(m,k,f,j,g,d,h,a,c,b,e,n,l,i){this._portalService.getImageUrlsAsync(m,f,0,k,this.quality==null?"":this.quality,this.supportTextSelection,j,g,d,h,a,c,b,e,n,function(a){l.apply(this,[a.data])},function(a){i.apply(this,[a])})}});window.groupdocs.documentImageRenderingComponentViewModel=function(b){a.extend(this,b);this._create(b)};a.extend(window.groupdocs.documentImageRenderingComponentViewModel.prototype,window.groupdocs.documentComponentViewModel.prototype,{options:{showHyperlinks:true},_create:function(a){this._model=new window.groupdocs.documentImageRenderingComponentModel(a);this._init(a)},_init:function(a){this.initialWidth=this.defaultPageImageWidth;window.groupdocs.documentComponentViewModel.prototype._init.call(this,a)},loadDocument:function(a){window.groupdocs.documentComponentViewModel.prototype.loadDocument.call(this,a);var c=1,b;if(this.shouldMinimumWidthBeUsed(this.pageImageWidth*this.initialZoom/100,false))b=this.minimumImageWidth;else b=Math.round(this.pageImageWidth*this.initialZoom/100);this._model.loadDocument(a||this.fileId,c,b,this.password(),this.fileDisplayName,this.watermarkText,this.watermarkColor,this.watermarkPosition,this.watermarkWidth,this.ignoreDocumentAbsence,this.supportPageRotation,this.supportListOfContentControls,this.supportListOfBookmarks,this.instanceIdToken,this.locale,function(b){if(typeof a!=="undefined")this.fileId=a;this.pageWidth(this.pageImageWidth*(this.initialZoom/100));this.zoom(this.initialZoom);this._onDocumentLoadedBeforePdf2Xml(b)}.bind(this),function(a){this._onDocumentLoadFailed(a)}.bind(this))},retrieveImageUrls:function(d){var a,c,b;if(this.shouldMinimumWidthBeUsed(this.pageWidth(),true))b=this.minimumImageWidth;else b=this.pageWidth();c=Math.floor(b);this._model.retrieveImageUrls(this.fileId,d,c,this.watermarkText,this.watermarkColor,this.watermarkPosition,this.watermarkWidth,this.ignoreDocumentAbsence,this.useHtmlBasedEngine,this.supportPageRotation,this.instanceIdToken,this.locale,function(b){for(a=0;a<d;a++){this.pages()[a].url(b.image_urls[a]);this.loadImagesForVisiblePages()}}.bind(this),function(a){this._onError(a)}.bind(this))},initPagesAfterDocumentLoad:function(g){var d=this._pdf2XmlWrapper.getPageSize();this.scale(this.pageImageWidth*(this.initialZoom/100)/d.width);this.unscaledPageWidth=Number(d.width);this.unscaledPageHeight=Number(d.height);this.heightWidthRatio=parseFloat(d.height/d.width);this.pageHeight(Math.round(this.pageImageWidth*this.heightWidthRatio*(this.initialZoom/100)));this.triggerEvent("_onProcessPages",g);var j=this.pageCount(),i=[],b,e;this.serverPages=e=this._pdf2XmlWrapper.documentDescription.pages;var f,h;h=this._pdf2XmlWrapper.getPageCount();for(var c,a=0;a<j;a++){if(a<g.imageUrls.length)f=g.imageUrls[a];else f="";b={number:a+1,visible:this.bindingProvider.getObservable(false),url:this.bindingProvider.getObservable(f)};if(a<h&&e)b.prop=this.bindingProvider.getObservable(e[a].h/e[a].w);else b.prop=this.bindingProvider.getObservable(this.bindingProvider.getValue(this.pageHeight)/this.bindingProvider.getValue(this.pageWidth));if(this.supportPageRotation){c=this.serverPages[a].rotation;if(typeof c=="undefined")c=0;b.rotation=this.bindingProvider.getObservable(c);this.applyPageRotationInBrowser(a,b,c)}b.left=0;b.top=this.getPageTop(0);i.push(b)}return i},_onDocumentHyperlinksLoaded:function(b){if(!b||!b.links){this.hyperlinks.removeAll();return}var d=[],e=this,c=this.getSelectableInstance();a.each(b.links,function(){var a={url:this.Url,pageNumber:this.PageNumber,targetPage:this.TargetPage,rect:new groupdocs.Rect(this.Bounds.X,this.Bounds.Y,this.Bounds.X+this.Bounds.Width,this.Bounds.Y+this.Bounds.Height)};a.frame=this.bindingProvider.getObservable(c!=null?c.convertPageAndRectToScreenCoordinates(a.pageNumber,a.rect):a.rect);d.push(a)});this.hyperlinks(d)},_loadHyperlinks:function(){this.options.showHyperlinks==true&&this._model.loadHyperlinks(this.fileId,this._onDocumentHyperlinksLoaded.bind(this),function(){})},_refreshHyperlinkFrames:function(){var b=this.getSelectableInstance();a.each(this.hyperlinks(),function(){this.frame(b!=null?b.convertPageAndRectToScreenCoordinates(this.pageNumber,this.rect):this.rect)})},loadImageForPage:function(b,c,a){this.triggerImageLoadedEvent(b);this.supportPageRotation&&a&&this.addSuffixToImageUrl(c)},makePageVisible:function(a,b){this.triggerImageLoadedEvent(a);b.visible(true)},triggerImageLoadedEvent:function(b){if(a.browser.msie)!this.pages()[b].visible()&&a("img#img-"+b+1).load(function(){this.triggerEvent("onPageImageLoaded")})},setZoom:function(b){window.groupdocs.documentComponentViewModel.prototype.setZoom.call(this,b);if(this._pdf2XmlWrapper){var c=this._pdf2XmlWrapper.getPageSize();this.scale(this.pageImageWidth/c.width*b/100)}var a=this.getSelectableInstance();a.changeSelectedRowsStyle(this.scale());this.reInitSelectable();if(this.useVirtualScrolling){a.recalculateSearchPositions(this.scale());this.highlightSearch()}this.setPage(this.pageIndex());this.shouldMinimumWidthBeUsed(this.pageWidth(),true)&&this.loadImagesForVisiblePages();this.options.showHyperlinks&&this._refreshHyperlinkFrames()},loadPagesZoomed:function(){var a=window.groupdocs.documentComponentViewModel.prototype.loadPagesZoomed.call(this);if(a!==null){this.calculatePagePositions();var b=this.pageCount();!this.shouldMinimumWidthBeUsed(a,true)&&this.retrieveImageUrls(b)}},performSearch:function(f,e,d,b,c){var a=this.getSelectableInstance();a!=null&&a.performSearch(f,this.scale(),e,d,b,c)},shouldMinimumWidthBeUsed:function(d,b){var a=null;if(this.supportTextSelection&&b){var c=this._pdf2XmlWrapper.getPageSize();a=c.width}return this.minimumImageWidth!=null&&(d<=this.minimumImageWidth||a!==null&&a<this.minimumImageWidth)},refreshPageContents:function(a){a.visible(false);this.addSuffixToImageUrl(a);a.visible(true)},adjustInitialZoom:function(){window.groupdocs.documentComponentViewModel.prototype.adjustInitialZoom.call(this)},addSuffixToImageUrl:function(d){var a=d.url(),c="?",b=a.indexOf("dummy=");if(b!=-1)a=a.substring(0,b-1);var e=a.indexOf("?");if(e!=-1)c="&";d.url(a+c+"dummy="+(new Date).getTime())}})})(jQuery);